/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-logger",function(d){var b=[],a=null;
var c=d.Base.create("logger",d.Base,[],{initializer:function(e){d.one(window).on("beforeunload",this.flush,this)
},enqueue:function(e){b.push(e);
this.wait()
},flush:function(f){try{clearTimeout(a)
}catch(e){}a=null;
if(b.length>0){d.Data.post({url:"/api/events/Trace",data:{data:JSON.stringify(b)}})
}b=[]
},wait:function(){if(a===null){a=setTimeout(d.bind(this.flush,this),this.get("timerLength"))
}},log:function(e,f){if(d.Lang.isValue(e)){this.enqueue({sessionKey:this.get("sessionKey"),pageUrl:document.location.href,type:e,data:JSON.stringify(d.Lang.isValue(f)?f:{})})
}}},{ATTRS:{timerLength:{value:30*1000},sessionKey:{value:d.Cookie.get("JSESSIONID")}}});
d.namespace("Squarespace").Logger=new c()
},"1.0",{requires:["node","io-base","cookie","event","base"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-base-get-property",function(b){var a=function(){};
a.prototype={getProperty:function(c){var d=this.constructor,e=this.constructor[c];
while(b.Lang.isUndefined(e)){if(d.superclass){d=d.superclass.constructor
}else{break
}if(b.Lang.isUndefined(d)){break
}e=d[c]
}return e
}};
a.NAME="baseGetProperty";
b.namespace("Squarespace").BaseGetProperty=a
},"1.0");/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-anims",function(b){function a(c){a.superclass.constructor.apply(this,arguments)
}b.namespace("Squarespace").Anims=b.extend(a,b.Base,{initializer:function(){this._items=[]
},destructor:function(){var c=[];
this.each(function(d){c.push(d)
});
b.Array.each(c,function(d){if(d.get("running")){d.stop(false)
}d.destroy()
});
b.detach(this.get("id")+"|*")
},add:function(c){if(!c.get("node")){throw this.name+": Animation doesn't specify a node"
}if(!c.get("node").ancestor("body")){console.warn(this.name+": Animation with a YUI node not in the DOM added")
}else{if(!c.get("node")._node){console.warn(this.name+": Animation with a _node = null added")
}}c.on(this.get("id")+"|end",function(d){this.remove(c)
},this);
this._items.push(c)
},remove:function(d){if(b.Lang.isNumber(d)){return this._items.splice(d,1)
}else{var c=this._items.indexOf(d);
if(c!==-1){return this._items.splice(this._items.indexOf(d),1)
}}}},{NAME:"anims"});
b.augment(a,b.ArrayList)
},"1.0",{requires:["base","base-build","arraylist"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-zen",function(e){var d=/(?:\s*([-+ ,<>]))?\s*(\.|!|#)?([-\w$]+)?(?:\[([^\]=]+)=?['"]?([^\]'"]*)['"]?\])?/g,b=/[\-+,> ]/,c=e.config.doc;
function a(g,h){g.appendChild(c.createTextNode(h))
}function f(k){var l;
var h;
if(typeof("ieCreateElement")=="undefined"){try{l=1;
f("i",{name:"a"})
}catch(s){l=0
}}var t,g,q,o,n,r,u=arguments;
if(k._node){k=k._node
}function j(){if(r&&n&&r!==n){var i=n;
if(n===k){t=t||(b.test(h)&&c.createDocumentFragment());
if(t){i=t
}}i.insertBefore(r,o||null)
}}for(var p=0;
p<u.length;
p++){h=u[p];
if(typeof h=="object"){if(h._node){r=h._node
}if(h.nodeType){r=h;
j();
n=h._node||h;
o=0
}else{for(var v in h){r[v]=h[v]
}}}else{if(q===p-1){a(r,h)
}else{if(p<1){k=null
}q=p;
var m=h.replace(d,function(D,i,y,B,A,x){if(i){j();
if(i=="-"||i=="+"){n=(o=(r||n)).parentNode;
if(n==null){n=t=t||c.createDocumentFragment();
t.appendChild(r);
o=r
}r=null;
if(i=="+"){o=o.nextSibling
}}else{if(i=="<"){n=(r||n).parentNode;
if(n==null){n=t=t||c.createDocumentFragment();
t.appendChild(r);
r=t
}else{r=n
}}else{if(i==","){n=k
}else{if(r){n=r
}}r=null
}o=0
}if(r){n=r
}}var E=!y&&B;
if(E||(!r&&(y||A))){if(E=="$"){a(n,u[++p])
}else{E=E||f.defaultTag;
var C=l&&u[p+1]&&u[p+1].name;
if(C){E="<"+E+' name="'+C+'">'
}r=c.createElement(E)
}}if(y){if(B=="$"){B=u[++p]
}if(y=="#"){r.id=B
}else{var w=r.className;
var z=w&&(" "+w+" ").replace(" "+B+" "," ");
if(y=="."){r.className=w?(z+B).substring(1):B
}else{if(h=="!"){e.one(r).destroy(true).remove()
}else{z=z.substring(1,z.length-1);
if(z!=w){r.className=z
}}}}}if(A){if(x=="$"){x=u[++p]
}if(A=="style"){r.style.cssText=x
}else{r[A.charAt(0)=="!"?(A=A.substring(1))&&"removeAttribute":"setAttribute"](A,x===""?A:x)
}}return""
});
if(m){throw new SyntaxError("Unexpected char "+m+" in "+h)
}j();
n=g=r||n
}}}if(k&&t){k.appendChild(t)
}return e.one(g)
}f.defaultTag="div";
f.setDocument=function(g,h){c=g;
b=h||b
};
e.zen=f;
if(e.Node){e.Node.addMethod("zen",function(){return f.apply(null,arguments)
});
e.NodeList.importMethod(e.Node.prototype,"zen")
}},"1.0",{requires:["node"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-template-helpers",function(H){var y={get:function(b,a){if(typeof(b.get)==="function"){return b.get(a)
}else{return b[a]
}}};
var J={html:H.Squarespace.Escaping.escapeForHtml,htmltag:H.Squarespace.Escaping.escapeForHtmlTag,htmlattr:H.Squarespace.Escaping.escapeForHtmlTag,str:function(b){if(b===null||typeof(b)==="undefined"){return""
}try{return b.toString()
}catch(a){return"[JSONT: Can't format variable as string (typeof: "+typeof(b)+").]"
}},raw:function(a){return a
},safe:function(a){if(!a){return""
}return a.replace(/<.*?>/g,"")
},json:function(a){return H.JSON.stringify(a).replace(/<\/script>/g,'</scr"+"ipt>')
},"json-pretty":function(a){return H.JSON.stringify(a,null,2).replace(/<\/script>/g,'</scr"+"ipt>')
},smartypants:function(a){a=a.replace(/(^|[-\u2014\s(\["])'/g,"$1\u2018");
a=a.replace(/'/g,"\u2019");
a=a.replace(/(^|[-\u2014/\[(\u2018\s])"/g,"$1\u201c");
a=a.replace(/"/g,"\u201d");
a=a.replace(/--/g,"\u2014");
return a
},slugify:function(a){return(!a?"":a.replace(/[^\-a-zA-Z0-9\s]+/ig,"").replace(/\s/g,"-").toLowerCase())
},"url-encode":function(a){return encodeURIComponent(a)
},"activate-twitter-links":function(a){var d=/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;
var c=/(^| )@([a-zA-Z0-9_]+)/ig;
var b=/(^| )#([a-zA-Z0-9_]+)/ig;
return a.replace(d,'<a target="new" href="$1">$1</a>').replace(c,'$1<a target="new" href="http://www.twitter.com/$2/">@$2</a>').replace(b,function(e){return'<a target="new" href="http://www.twitter.com/search/'+encodeURIComponent(e)+'">'+e+"</a>"
})
},count:function C(b){var a=b.length;
if(a==null&&typeof b==="object"){a=0;
for(z in b){if(Object.prototype.hasOwnProperty.call(b,z)){a++
}}}return a||0
},"audio-player":function(a){return'<script>Y.use(\'squarespace-audio-player-frontend\');<\/script><div class="squarespace-audio-player" data-audio-asset-url="'+a.audioAssetUrl+'" data-item-id="'+a.id+'" id="audio-player-'+a.id+'"></div>'
},"social-button":function(a,c){var b=c._LookUpStack("website");
if(b&&b.shareButtonOptions&&Object.keys(b.shareButtonOptions).length!==0){return'<script>Y.use(\'squarespace-social-buttons\');<\/script><div class="squarespace-social-buttons button-style" data-system-data-id="'+(a.systemDataId?a.systemDataId:"")+'" data-asset-url="'+a.assetUrl+'" data-record-type="'+a.recordType+'" data-full-url="'+a.fullUrl+'" data-title="'+H.Squarespace.Escaping.escapeForHtmlTag(a.title)+'"></div>'
}},"social-button-inline":function(a,c){var b=c._LookUpStack("website");
if(b&&b.shareButtonOptions&&Object.keys(b.shareButtonOptions).length!==0){return'<script>Y.use(\'squarespace-social-buttons\');<\/script><span class="squarespace-social-buttons inline-style" data-system-data-id="'+(a.systemDataId?a.systemDataId:"")+'" data-asset-url="'+a.assetUrl+'" data-record-type="'+a.recordType+'" data-full-url="'+a.fullUrl+'" data-title="'+H.Squarespace.Escaping.escapeForHtmlTag(a.title)+'"></span>'
}},"twitter-follow-button":function(b){var a=b.userName||b.profileUrl.split("/").pop();
return"<script>Y.use('squarespace-follow-buttons', function(Y) { Y.on('domready', function() { Y.Squarespace.FollowButtonUtils.renderAll(); }); });<\/script><div class=\"squarespace-follow-button\" data-username=\""+a+'"></div>'
},comments:function(a){return'<div class="squarespace-comments" id="comments-'+a.id+'"></div>'
},"comment-link":function(a,c){var b=c._LookUpStack("websiteSettings");
if(b&&b.disqusShortname){return'<script>Y.use("squarespace-comment-links");<\/script><a href="'+a.fullUrl+'" class="sqs-comment-link" data-id="'+a.id+'"></a>'
}return'<a href="'+a.fullUrl+"#comments-"+a.id+'" class="sqs-comment-link" data-id="'+a.id+'">'+(a.publicCommentCount===0?"No":a.publicCommentCount)+" Comment"+(a.publicCommentCount===1?"":"s")+"</a>"
},"like-button":function(a,c){var b=c._LookUpStack("websiteSettings");
if(b&&b.simpleLikingEnabled){return'<span class="sqs-simple-like" data-item-id="'+a.id+'" data-like-count="'+a.likeCount+'"><span class="like-icon"></span><span class="like-count"></span></span>'
}},"comment-count":function(a){return(a.publicCommentCount===0?"No":a.publicCommentCount)+" Comment"+(a.publicCommentCount===1?"":"s")
},"image-meta":function(b){var a="0.5,0.5";
if(b.mediaFocalPoint){a=b.mediaFocalPoint.x+","+b.mediaFocalPoint.y
}return'data-image="'+b.assetUrl+'" data-image-dimensions="'+(b.originalSize||"")+'" data-image-focal-point="'+a+'" '
},video:function(e){var d=e.oembed;
var f=e.overlay;
var g=e.assetUrl;
var a="0.5,0.5";
if(e.mediaFocalPoint){a=e.mediaFocalPoint.x+","+e.mediaFocalPoint.y
}var c='<div class="sqs-video-wrapper" data-html="'+H.Squarespace.Escaping.escapeForHtmlTag(d.html)+'" data-provider-name="'+d.providerName+'">';
if(f){var b='<div class="sqs-video-overlay';
if(!!e.mainImageId||!!e.systemDataId){b+='" style="opacity: 0;">';
b+='<img data-load="false" data-image="'+g+'" data-image-dimensions="'+(e.originalSize||"")+'" data-image-focal-point="'+a+'" />'
}else{b+=' no-thumb" style="opacity: 0;">'
}b+='<div class="sqs-video-opaque"> </div><div class="sqs-video-icon"></div>';
b+="</div>";
c+=b
}c+="</div>";
return c
},height:function(d){var b=d.split("x");
if(b.length!=2){return"Invalid source parameter.  Pass in 'originalSize'."
}var a=parseInt(b[0],10);
var c=parseInt(b[1],10);
return c
},width:function(d){var b=d.split("x");
if(b.length!=2){return"Invalid source parameter.  Pass in 'originalSize'."
}var a=parseInt(b[0],10);
var c=parseInt(b[1],10);
return a
},moneyFormat:function(a){return(a/100).toFixed(2)
},"months-options":function(){var c=["","January","February","March","April","May","June","July","August","September","October","November","December"];
var a="";
for(var b=1;
b<c.length;
b++){a+="<option value='"+b+"'>"+J["zero-pad"](b,2)+" - "+c[b]+"</option>"
}return a
},"months-options-short":function(){var a="";
for(var b=1;
b<=12;
b++){a+="<option value='"+b+"'>"+J["zero-pad"](b,2)+"</option>"
}return a
},"zero-pad":function(b,a){a-=b.toString().length;
if(a>0){return new Array(a+(/\./.test(b)?2:1)).join("0")+b
}return b
},"years-options":function(){var c="";
var a=new Date().getFullYear();
for(var b=a;
b<=a+10;
b++){c+="<option value='"+b+"'>"+b+"</option>"
}return c
},"google-calendar-url":function(e){var b="%Y%m%dT%H%M%SZ";
var d=new Date(e.startDate);
d.setHours(d.getHours()+d.getTimezoneOffset()/60);
var f=H.DataType.Date.format(d,{format:b});
var a=new Date(e.endDate);
a.setHours(a.getHours()+a.getTimezoneOffset()/60);
var c=H.DataType.Date.format(a,{format:b});
return"http://www.google.com/calendar/event?action=TEMPLATE&text="+e.title+"&dates="+f+"/"+c+""
},"from-price":function(a){if(a.productType==H.Squarespace.ProductTypes.DIGITAL){return a.priceCents
}var b=a.variants[0].price;
for(var c=0;
c<a.variants.length;
c++){if(a.variants[c].price<b){b=a.variants[c].price
}}return b
},"normal-price":function(a){if(a.productType==H.Squarespace.ProductTypes.DIGITAL){return a.priceCents
}if(a.variants==undefined||a.variants.length<1){return"No variants."
}var c=0;
for(var b=0;
b<a.variants.length;
b++){if(a.variants[b].price>c){c=a.variants[b].price
}}return c
},"sale-price":function(a){if(a.productType==H.Squarespace.ProductTypes.DIGITAL){return a.salePriceCents
}if(a.variants===undefined||a.variants.length<1){return"No variants."
}var d=null;
for(var b=0;
b<a.variants.length;
b++){var c=a.variants[b];
if(c.onSale&&d===null){d=c.salePrice
}if(c.onSale&&c.salePrice<d){d=c.salePrice
}}return d
},"variant-descriptor":function(a){return H.Squarespace.Utils.variantFormat(a)
},"variants-attributes":function(a){if(a.variants===undefined||a.variants.length<=1){return""
}return H.Squarespace.Utils.variantFormatAttributes(a.variants[0])
},"variants-select":function(a){if(a.variants===undefined||a.variants.length<=1){return""
}var f="";
for(var b=0;
b<a.variants.length;
b++){var c=a.variants[b];
var d=H.Squarespace.Utils.variantFormat(c);
if(!c.unlimited&&c.qtyInStock===0){f+='<option value="'+H.Squarespace.Escaping.escapeForHtmlTag(JSON.stringify(c))+'">'+d+" (SOLD OUT)</option>"
}else{var e="";
if(H.Squarespace.TEMPLATE_PREDICATES["varied-prices?"](a)){if(c.onSale){e=" (now $"+H.Squarespace.Utils.moneyFormat(c.salePrice)+")"
}else{e=" ($"+H.Squarespace.Utils.moneyFormat(c.price)+")"
}f+='<option value="'+H.Squarespace.Escaping.escapeForHtmlTag(JSON.stringify(c))+'">'+d+e+"</option>"
}else{if(c.onSale){e=" (now $"+H.Squarespace.Utils.moneyFormat(c.salePrice)+")"
}f+='<option value="'+H.Squarespace.Escaping.escapeForHtmlTag(JSON.stringify(c))+'">'+d+e+"</option>"
}}}return"<select data-item-id='"+a.id+"' class='sqs-variants-select'>"+f+"</select>"
},"add-to-cart-btn":function(a){return'<div data-item-id="'+a.id+'"" class="sqs-add-to-cart-button">Add to Cart</div>'
},AbsUrl:function(b,a){return y.get("base-url")+"/"+b
},"item-classes":function(b,j){if(j.hash){j=this
}var h=["hentry"];
var c=y.get(j,"promotedBlockType");
if(!!c){h.push("promoted");
h.push(J.slugify("promoted-block-"+c))
}var d=y.get(j,"categories");
if(!!d){for(var e=0;
e<d.length;
e++){h.push(J.slugify("category-"+d[e]))
}}var a=y.get(j,"tags");
if(!!a){for(var f=0;
f<a.length;
f++){h.push(J.slugify("tag-"+a[f]))
}}var g=y.get(j,"author");
if(!!g&&!!g.displayName){h.push(J.slugify("author-"+g.displayName))
}h.push("post-type-"+y.get(j,"recordTypeLabel"));
h.push("article-index-"+y.get(j,"@index"));
if(y.get(j,"starred")){h.push("featured")
}return h.join(" ")
},round:function(a,c,b){return Math.round(parseFloat(a))
},iter:function(a){return y.get(a,"@index")
}};
var E={"main-image?":function(a){return !!a.mainImageId||!!a.systemDataId
},"location?":function(a){return(a.location&&a.location.mapLat&&a.location.mapLng&&a.location.mapZoom)
},"excerpt?":function(b){var a=/(?:^$)|(?:^\s*<p[^>]*>(?:\s*<br\s*\/?>\s*)(?:[\u200b\s]*)<\/p\s*>\s*)/;
return(!!b.excerpt&&!(a.test(b.excerpt.html||b.excerpt)))
},"comments?":function(d,c){var b=c._LookUpStack("websiteSettings");
var a=d.commentState===1;
if(!a&&d.publicCommentCount>0){a=true
}if(b&&!b.commentsEnabled){a=false
}return a
},"collection?":function(a){return a.collection
},"collection-page?":function(a){return(a.collection&&a.collection.type==H.Squarespace.CollectionTypes.PAGE)
},"passthrough?":function(a){return a.passthrough&&a.sourceUrl&&a.sourceUrl!==""
},"event?":function(a){return a.recordType==H.Squarespace.ContentConstants.EVENT
},"same-day?":function(c){var b=new Date(c.startDate);
var a=new Date(c.endDate);
return(b.getYear()==a.getYear())&&(b.getMonth()==a.getMonth())&&(b.getDate()==a.getDate())
},"external-link?":function(a){return !!a.externalLink
},"folder?":function(a){return a.collection&&a.collection.folder
},"has-variants?":function(a){if(a.productType==H.Squarespace.ProductTypes.DIGITAL){return false
}else{return(a.variants.length>1)
}},"varied-prices?":function(a){if(a.productType==H.Squarespace.ProductTypes.DIGITAL){return false
}if(a.variants===undefined||a.variants.length<1){return false
}var b=a.variants[0].price;
for(var c=0;
c<a.variants.length;
c++){if(a.variants[c].price!=b){return true
}}return false
},"on-sale?":function(b){if(!b||!b.variants){return false
}if(b.productType==H.Squarespace.ProductTypes.DIGITAL){return b.payWhatYouWant?false:b.onSale
}var a=false;
for(var c=0;
c<b.variants.length;
c++){var d=b.variants[c];
a=a||((d.unlimited||d.qtyInStock>0)&&d.onSale)
}return a
},"sold-out?":function(b){if(b.productType==H.Squarespace.ProductTypes.DIGITAL){return false
}var a=true;
if(b.variants==undefined){return false
}for(var c=0;
c<b.variants.length;
c++){if(b.variants[c].unlimited||b.variants[c].qtyInStock>0){a=false
}}return a
},"singular?":function(a){return a===1
},"plural?":function(a){return a!==1
},"disqus?":function(c,b){var a=b._LookUpStack("websiteSettings");
return a&&a.disqusShortname
},"serviceNameEmail?":function(b,a){return b.serviceName==="email"
},"debug?":function(c,b){try{return b.get("debug")
}catch(a){if(a.name=="UndefinedVariable"){return false
}else{throw a
}}}};
function t(b,a){if(!!a){return function(c){return(c.recordType==b)||(c.promotedBlockType==a)
}
}else{return function(c){return(c.recordType==b)
}
}}for(var G in H.Squarespace.ContentStringConstants){E[G+"?"]=t(H.Squarespace.ContentStringConstants[G])
}E["external-video?"]=t(H.Squarespace.ContentConstants.VIDEO,"video");
E["video?"]=t(H.Squarespace.ContentConstants.VIDEO,"video");
E["image?"]=t(H.Squarespace.ContentConstants.IMAGE,"image");
E["quote?"]=t(H.Squarespace.ContentConstants.QUOTE,"quote");
E["link?"]=t(H.Squarespace.ContentConstants.LINK,"link");
E["quote?"]=t(H.Squarespace.ContentConstants.QUOTE,"quote");
E["gallery?"]=t(H.Squarespace.ContentConstants.GALLERY,"gallery");
function D(a){return function(b){return(b.promotedBlockType==a)
}
}var x=["map","embed","image","code","quote","twitter","link","video","foursquare","instagram","form"];
for(var z=0;
z<x.length;
z++){var w=x[z];
var u=w.charAt(0).toUpperCase()+w.slice(1);
E["promoted"+u+"?"]=D(w)
}E["index?"]=function(a){return a.folderBehavior==H.Squarespace.FolderBehavior.INDEX
};
E["redirect?"]=function(a){return a.folderBehavior==H.Squarespace.FolderBehavior.REDIRECT
};
E["clickable?"]=function(d,a,c){var b=a._LookUpStack("folderBehavior");
if(typeof(b)==="undefined"){return true
}return b==H.Squarespace.FolderBehavior.INDEX||b==H.Squarespace.FolderBehavior.REDIRECT
};
function F(b,a){return function(e,c,d){return c._LookUpStack("options")[b]==a
}
}for(var I in H.Squarespace.GalleryOptions){var v=H.Squarespace.GalleryOptions[I];
switch(v.type){case"select":for(var i in v.options){var B=v.options[i];
E["gallery-"+I+"-"+i+"?"]=F(I,i)
}break;
case"boolean":E["gallery-"+I+"?"]=F(I,true);
break;
case"slider":break;
default:console.log("Unknown type: "+G+", (opt: "+I+")");
break
}}E["gallery-meta?"]=function(c,a,b){return a._LookUpStack("options")["controls"]||a._LookUpStack("options")["indicators"]
};
var A={debug:function(){return function(b){var a="DEBUG:\n========================\n";
a+=JSON.stringify(this||b,null,2);
a+="END DEBUG:\n========================\n";
return a
}
},moneyFormat:function(a){return(a/100).toFixed(2)
}};
H.namespace("Squarespace").HANDLEBARS_HELPERS=A;
H.namespace("Squarespace").TEMPLATE_FORMATTERS=J;
H.namespace("Squarespace").TEMPLATE_PREDICATES=E
},"1.0",{requires:["squarespace-common","squarespace-util","substitute","json"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-ui-templates",function(e){var d=e.Base.create("UITemplates",e.Base,[],{render:function(f,g){var h=this.getCompiledTemplate(f);
if(!h){throw Error(this.name+": Could not find UITemplate by the name of: "+f+". Recompile templates?")
}return h(g||{})
},renderAsNodeOrDocFrag:function(f,g){return e.Node.create(this.render(f,g))
},getCompiledTemplate:function(f){var g=this.get("compiledTemplates")[f];
if(!g){throw this.name+": A template by the name "+f+" does not exist."
}return g
}},{ATTRS:{compiledTemplates:{readOnly:true,getter:function(){var f=e.Handlebars.templates;
if(!e.Lang.isObject(f)){throw this.name+": No templates are available. Have you loaded your template module?"
}return f
}}}});
e.namespace("Squarespace").UITemplates=new d();
e.Squarespace.TEMPLATE_FORMATTERS.date=function(f,g,h){if(!e.Lang.isNumber(g)){return"Invalid date."
}return e.DataType.Date.format(new Date(g),{format:h})
};
for(var b in e.Squarespace.TEMPLATE_FORMATTERS){(function(f){e.Handlebars.registerHelper(f,function(g){return e.Squarespace.TEMPLATE_FORMATTERS[f].apply(this,[this].concat(Array.prototype.slice.call(arguments)))
})
})(b)
}for(var a in e.Squarespace.TEMPLATE_PREDICATES){(function(f){e.Handlebars.registerHelper("if-"+f.replace("?",""),function(g){return e.Handlebars.helpers["if"].call(this,function(){return e.Squarespace.TEMPLATE_PREDICATES[f](this)
},g)
})
})(a)
}for(var c in e.Squarespace.HANDLEBARS_HELPERS){(function(f){e.Handlebars.registerHelper(f,e.Squarespace.HANDLEBARS_HELPERS[f])
})(c)
}},"1.0",{requires:["base-build","handlebars-base","squarespace-template-helpers"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-ss-widget",function(c){c.namespace("Squarespace.Widgets");
c.Squarespace.Widgets.SSWidget=c.Squarespace.SSWidget=c.Base.create("ssWidget",c.Widget,[c.Squarespace.BaseGetProperty],{initializer:function(d){this._anims=new c.Squarespace.Anims();
this.on(this.get("id")+"|classNameChange",function(g){var f=this.get("boundingBox");
if(f){f.removeClass(g.prevVal).addClass(g.newVal)
}},this)
},destructor:function(){this._anims.destroy();
c.detach(this.get("id")+"|*");
this.detach(this.get("id")+"|*")
},renderUI:function(){var d=this.get("className"),e=this.get("boundingBox");
if(d){e.addClass(d)
}this.get("contentBox").prepend(this.getTemplateAsNode())
},bindUI:function(){this.after(this.get("id")+"|stringsChange",function(d){if(!d.noSyncUI){this.syncUI()
}},this)
},syncUI:function(){},getTemplateAsNode:function(){var g,j,f;
var e=this.constructor;
var h=null;
var d=function(){g=!!e.PUT_TEMPLATE;
j=!!e.HANDLEBARS_TEMPLATE;
if(j){f=e.HANDLEBARS_TEMPLATE
}else{if(g){f=e.PUT_TEMPLATE
}else{f=e.TEMPLATE
}}};
d();
while(c.Lang.isUndefined(f)){e=e.superclass.constructor;
if(c.Lang.isUndefined(e)){break
}d()
}if(j){var i=this._getHBTemplateContext();
h=c.Squarespace.UITemplates.renderAsNodeOrDocFrag(f,i)
}else{if(g){h=c.zen(f)
}else{h=c.Node.create(f)
}}return h
},_getHBTemplateContext:function(){return this.getAttrs()
}},{CSS_PREFIX:"sqs-widget",HANDLEBARS_TEMPLATE:"",PUT_TEMPLATE:"",TEMPLATE:"",ATTRS:{className:{value:null}}});
var a="data-state-";
var b=c.Squarespace.Widgets.DataWidget=c.Base.create("dataWidget",c.Squarespace.SSWidget,[],{initializer:function(d){if(!d.dataState){if(this.getProperty("ASYNC_DATA")){this.set("dataState",this.getProperty("DATA_STATES").INITIALIZED)
}else{this.set("dataState",this.getProperty("DATA_STATES").LOADED)
}}},renderUI:function(){b.superclass.renderUI.call(this);
this._updateDataStateClassName()
},bindUI:function(){b.superclass.bindUI.call(this);
var d=this.get("id");
this.after(d+"|dataChange",function(f){if(!f.noSyncUI){this.syncUI()
}},this);
this.after(d+"|dataStateChange",this._updateDataStateClassName,this)
},_updateDataStateClassName:function(){var d=this.get("boundingBox"),e=this.get("dataState");
c.Object.each(this.getProperty("DATA_STATES"),function(f){d.removeClass(a+f)
},this);
d.addClass(a+e)
},setLoadingState:function(){return this.set("dataState",this.getProperty("DATA_STATES").LOADING)
},setLoadedState:function(){return this.set("dataState",this.getProperty("DATA_STATES").LOADED)
},setLoadFailedState:function(){return this.set("dataState",this.getProperty("DATA_STATES").LOAD_FAILED)
},loadedSuccessfully:function(){return this.get("dataState")===this.getProperty("DATA_STATES").LOADED
},loading:function(){return this.get("dataState")===this.getProperty("DATA_STATES").LOADING
},loadFailed:function(){return this.get("dataState")===this.getProperty("DATA_STATES").LOAD_FAILED
}},{CSS_PREFIX:"sqs-data-widget",ASYNC_DATA:false,DATA_STATES:{INITIALIZED:"initialized",LOADING:"loading",LOADED:"loaded",LOAD_FAILED:"load-failed"},ATTRS:{data:{value:null,validator:function(d){if(c.Lang.isUndefined(d)){console.warn(this.name+": Will not set data to undefined.");
return false
}else{return true
}}},dataState:{valueFn:function(){return this.getProperty("DATA_STATES").INITIALIZED
}}}})
},"1.0",{requires:["base","base-build","widget","squarespace-base-get-property","squarespace-anims","squarespace-zen","squarespace-ui-templates"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-SearchContainerFullScreen-template",function(c){var b=c.Handlebars;
(function(){var e=b.template,d=b.templates=b.templates||{};
d["SearchContainerFullScreen.html"]=e(function(h,t,r,m,z){r=r||h.helpers;
var s="",j,g="function",f=this.escapeExpression,q=this;
function p(E,D){var B="",C;
B+='\n	<div class="sqs-search-ui-list">\n    <div class="search-results">\n      ';
C=E.items;
C=r.each.call(E,C,{hash:{},inverse:q.noop,fn:q.program(2,o,D)});
if(C||C===0){B+=C
}B+="\n    </div>\n    ";
C=E.facets;
C=r["if"].call(E,C,{hash:{},inverse:q.noop,fn:q.program(14,x,D)});
if(C||C===0){B+=C
}B+="\n  </div>\n  ";
return B
}function o(F,E){var C="",D,B;
C+='\n      <div class="search-result" itemid="';
B=r.id;
if(B){D=B.call(F,{hash:{}})
}else{D=F.id;
D=typeof D===g?D():D
}C+=f(D)+'">\n        <div class="sqs-search-ui-item sqs-post ';
D=F.recordTypeName;
D=r["if"].call(F,D,{hash:{},inverse:q.noop,fn:q.program(3,n,E)});
if(D||D===0){C+=D
}C+=" ";
B=r.documentType;
if(B){D=B.call(F,{hash:{}})
}else{D=F.documentType;
D=typeof D===g?D():D
}C+=f(D)+'">\n          ';
D=F.imageUrl;
D=r["if"].call(F,D,{hash:{},inverse:q.noop,fn:q.program(5,l,E)});
if(D||D===0){C+=D
}C+='\n          <div class="sqs-title">';
B=r.title;
if(B){D=B.call(F,{hash:{}})
}else{D=F.title;
D=typeof D===g?D():D
}if(D||D===0){C+=D
}C+=" \n            ";
D=F.recordTypeName;
D=r["if"].call(F,D,{hash:{},inverse:q.noop,fn:q.program(8,i,E)});
if(D||D===0){C+=D
}C+="\n            ";
D=F.editable;
D=r["if"].call(F,D,{hash:{},inverse:q.noop,fn:q.program(10,A,E)});
if(D||D===0){C+=D
}C+='\n          </div>\n          <div class="sqs-content">\n            ';
D=F.highlight;
D=r.each.call(F,D,{hash:{},inverse:q.noop,fn:q.program(12,y,E)});
if(D||D===0){C+=D
}C+="\n          </div>\n        </div>\n      </div>  \n      ";
return C
}function n(F,E){var C="",D,B;
C+="sqs-post-type-";
B=r.recordTypeName;
if(B){D=B.call(F,{hash:{}})
}else{D=F.recordTypeName;
D=typeof D===g?D():D
}C+=f(D);
return C
}function l(E,D){var B="",C;
B+='\n          <div class="sqs-main-image">\n            ';
C=E.imageUrl;
C=r.each.call(E,C,{hash:{},inverse:q.noop,fn:q.program(6,k,D)});
if(C||C===0){B+=C
}B+="\n          </div>\n          ";
return B
}function k(D,C){var B="";
B+='\n            <img src="';
D=typeof D===g?D():D;
B+=f(D)+'?format=150w"> \n            ';
return B
}function i(F,E){var C="",D,B;
C+='\n            <span class="record-type">';
B=r.recordTypeName;
if(B){D=B.call(F,{hash:{}})
}else{D=F.recordTypeName;
D=typeof D===g?D():D
}C+=f(D)+"</span>\n            ";
return C
}function A(C,B){return'\n            <span class="edit">Edit</span>\n            '
}function y(D,C){var B="";
B+="\n            <span>&hellip;</span>\n            <span>";
D=typeof D===g?D():D;
if(D||D===0){B+=D
}B+="</span>\n            ";
return B
}function x(E,D){var B="",C;
B+='\n    <div class="sqs-search-ui-filters">\n      <ul>\n        ';
C=E.facets;
C=r.each.call(E,C,{hash:{},inverse:q.noop,fn:q.program(15,w,D)});
if(C||C===0){B+=C
}B+="\n      </ul>\n    </div>\n    ";
return B
}function w(F,E){var C="",D,B;
C+='\n        <li class="sqs-search-ui-filters-group" name="';
B=r.name;
if(B){D=B.call(F,{hash:{}})
}else{D=F.name;
D=typeof D===g?D():D
}C+=f(D)+'">\n          <strong>';
B=r.displayName;
if(B){D=B.call(F,{hash:{}})
}else{D=F.displayName;
D=typeof D===g?D():D
}C+=f(D)+"</strong>\n          <ul>\n            ";
D=F.values;
D=r.each.call(F,D,{hash:{},inverse:q.noop,fn:q.program(16,v,E)});
if(D||D===0){C+=D
}C+="\n          </ul>\n        </li>\n        ";
return C
}function v(F,E){var C="",D,B;
C+='\n            <li displayname="';
B=r.displayName;
if(B){D=B.call(F,{hash:{}})
}else{D=F.displayName;
D=typeof D===g?D():D
}C+=f(D)+'" class="';
D=F.active;
D=r["if"].call(F,D,{hash:{},inverse:q.noop,fn:q.program(17,u,E)});
if(D||D===0){C+=D
}C+='" filter="';
B=r.value;
if(B){D=B.call(F,{hash:{}})
}else{D=F.value;
D=typeof D===g?D():D
}C+=f(D)+'">\n              <a>';
B=r.displayName;
if(B){D=B.call(F,{hash:{}})
}else{D=F.displayName;
D=typeof D===g?D():D
}C+=f(D)+' <span class="count">';
B=r.hits;
if(B){D=B.call(F,{hash:{}})
}else{D=F.hits;
D=typeof D===g?D():D
}C+=f(D)+"</span></a>\n            </li>\n            ";
return C
}function u(C,B){return"active"
}s+='<div class="sqs-search-ui-close"></div>\n<div id="searchInputBox"></div>\n<div class="sqs-search-ui-result">\n	';
j=t.items;
j=r["if"].call(t,j,{hash:{},inverse:q.noop,fn:q.program(1,p,z)});
if(j||j===0){s+=j
}s+="\n</div>\n";
return s
})
})();
var a="SearchContainerFullScreen.html";
c.Handlebars.registerPartial(a.replace("/","."),b.templates[a])
},"1.0",{requires:["handlebars-base",]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-search",function(d){d.namespace("Squarespace");
var b=d.Base.create("searchContainer",d.Squarespace.SSWidget,[],{initializer:function(e){},renderUI:function(){b.superclass.renderUI.call(this)
},bindUI:function(){var e=this.get("searchInputBox");
e.after(this.get("id")+"|queryStringChange",this._onSearchInputBoxChange,this);
this.after(this.get("id")+"|searchFilterChange",this._onSearchFilterChange,this);
this.after(this.get("id")+"|searchQueryChange",this._onSearchQueryChange,this);
this.after(this.get("id")+"|searchResultChange",this._onSearchResultChange,this);
this.get("contentBox").on(this.get("id")+"|keyup",this._onKeyup,this);
this.scrollTimer=d.later(250,this,this._infiniteScroll,{},true)
},removeFilter:function(e){var f=this.get("searchFilter");
f=d.Array.filter(f,function(g){if(g.name===e){return false
}return true
});
this.set("searchFilter",f)
},addFilter:function(f){var e=this.get("searchFilter");
e.push(f);
this.set("searchFilter",e)
},destructor:function(){if(this.scrollTimer){this.scrollTimer.cancel()
}},_onSearchQueryChange:function(f){this._clearResult();
this._search()
},_onSearchFilterChange:function(f){this._clearResult();
this._search()
},_onSearchResultChange:function(f){this.syncUI()
},_clearResult:function(){this.set("searchResult",null);
this.set("page",0)
},_onSearchInputBoxChange:function(g){var f=g.newVal;
this.set("searchQuery",g.newVal)
},_onKeyup:function(f){if(f.keyCode===38&&!this.get("searchInputBox").isAutocompleteEnabled()){this._moveSelectedResultItem(-1)
}else{if(f.keyCode===40&&!this.get("searchInputBox").isAutocompleteEnabled()){this._moveSelectedResultItem(1)
}else{if(f.keyCode===13){this._onEnter()
}}}},_moveSelectedResultItem:function(j){var h=this.get("contentBox").one(".active");
if(h){h.removeClass("active");
var f=this.get("contentBox").all(".sqs-search-ui-item");
var g=f.indexOf(h);
var e=f.item(g+j);
if(e){e.addClass("active");
e.scrollIntoView()
}}else{if(j>0){var i=this.get("contentBox").one(".sqs-search-ui-item");
if(i){i.addClass("active");
i.scrollIntoView()
}}}},_onEnter:function(){var e=this.get("contentBox").one(".active");
if(e&&!this.get("searchInputBox").isAutocompleteEnabled()){e.simulate("click")
}},_search:function(){var g=this.get("searchQuery");
var f=this.get("page");
if(g.length===0){return
}var e={q:g,p:f};
d.Array.each(this.get("searchFilter"),function(h){e["f_"+h.name]=h.value
});
d.Data.get({url:"/api/search/GeneralSearch",data:e,success:this._searchResultCallback,error:this._searchResultCallbackError},this)
},_searchResultCallback:function(f){var g=this.get("searchResult"),e=this.get("page");
if(e>0&&g){g.items=g.items.concat(f.items);
this.set("searchResult",g)
}else{this.set("searchResult",f)
}},_searchResultCallbackError:function(){console.log("error data",data)
},_getSearchResultObject:function(f){var e=this.get("searchResult");
return d.Array.find(e.items,function(g){if(g.id===f){return true
}return false
})
},_nextPage:function(){var e=this.get("page")+1;
this.set("page",e);
this._search()
},_infiniteScroll:function(){var g=this.get("contentBox").one(".sqs-search-ui-list");
if(g){var f=g.get("scrollHeight"),j=g.get("scrollTop"),i=g.get("offsetHeight"),h=f-i-j,e=this.get("searchResult");
if(!e||!e.items){return
}if(h<100&&e.totalCount>e.items.length){this._nextPage()
}}}},{ATTRS:{searchInputBox:{value:null},searchFilter:{value:[]},page:{value:0},searchQuery:{value:null},searchResult:{value:null}}});
var c=d.Base.create("searchContainerFullScreen",b,[],{initializer:function(e){},renderUI:function(){c.superclass.renderUI.call(this);
this._open=true;
var e=this.get("contentBox");
e.addClass("sqs-search-ui");
var h=this.get("searchQuery");
e.plug(d.Squarespace.Animations.Fadeable,{duration:0.2,opacity:0.99});
var f=d.Squarespace.UITemplates.render(c.TEMPLATE_NAME,{});
e.prepend(f);
var g=new a({queryString:h,srcNode:this.get("contentBox").one("#searchInputBox"),inputType:"text",withSearchSuggest:true});
this.set("searchInputBox",g);
g.render();
g.focus();
d.one("body").addClass("no-scroll");
d.one("body").addClass("sqs-search-ui-fullscreen");
e.hide(true);
e.show();
d.Squarespace.EscManager.addTarget(this)
},bindUI:function(){var e=this.get("contentBox");
c.superclass.bindUI.call(this);
e.one(".sqs-search-ui-close").on(this.get("id")+"|click",this._closeClick,this);
e.delegate(this.get("id")+"|click",this._toggleFilter,".sqs-search-ui-filters-group li",this);
e.delegate(this.get("id")+"|click",this._clickResult,".sqs-search-ui-list .search-result",this);
this.get("boundingBox").on(this.get("id")+"|click",this._onClick,this)
},syncUI:function(){var e=this.get("searchResult"),f=this.get("contentBox"),j=this.get("page");
if(!e){f.one(".sqs-search-ui-result").setContent(d.DB.DIV("search-result-notice",{html:"Begin typing your search above and press return to search.  Press Esc to cancel."}));
return
}if(e.serviceError){f.one(".sqs-search-ui-result").setContent(d.DB.DIV("search-result-notice error",{html:e.serviceError}));
return
}else{if(e.items.length===0){f.one(".sqs-search-ui-result").setContent(d.DB.DIV("search-result-notice",{html:"Your search did not match any documents."}));
return
}else{var i=f.one(".search-result-notice");
if(i){return
}}}var g=d.Node.create(d.Squarespace.UITemplates.render(c.TEMPLATE_NAME,e));
if(j===0){f.one(".sqs-search-ui-result").prepend(g.one(".sqs-search-ui-result").get("children"))
}else{var h=f.one(".sqs-search-ui-list");
currentListLength=h.get("children").size();
newList=g.one(".sqs-search-ui-list").get("children");
newList=newList.splice(currentListLength);
h.append(newList)
}},_closeClick:function(f){f.stopPropagation();
this._close()
},isOpen:function(){return this._open
},close:function(){this._close()
},_close:function(f){this._open=false;
d.one("body").removeClass("no-scroll");
d.one("body").removeClass("sqs-search-ui-fullscreen");
if(f){this.destroy()
}else{var e=this.get("contentBox");
e.once("hidden",function(){this.destroy()
},this);
e.hide()
}},destructor:function(){this.get("boundingBox").remove();
this.get("searchInputBox").destroy();
d.Squarespace.EscManager.removeTarget(this)
},_clearResult:function(){c.superclass._clearResult.call(this);
this.get("contentBox").one(".sqs-search-ui-result").empty()
},_toggleFilter:function(k){k.preventDefault();
var j=k.target.ancestor("li",true);
if(!j){return
}var h=j.getAttribute("filter");
var f=j.getAttribute("displayname");
var g=j.ancestor(".sqs-search-ui-filters-group").getAttribute("name");
var i=j.hasClass("active");
if(i){this.removeFilter(g)
}else{this.addFilter({displayName:f,value:h,name:g})
}},_onClick:function(f){f.stopPropagation();
this.get("searchInputBox").focus()
},_clickResult:function(h){h.halt();
var g=h.target.ancestor(".search-result",true);
if(!g){return
}var i=g.getAttribute("itemid");
if(!i){return
}var f=this._getSearchResultObject(i);
this._close(true);
if(h.target.ancestor(".edit",true)){if(f.recordType){d.Data.get({url:"/api/commondata/GetItem",data:{itemId:f.id},success:function(e){var j=new d.Squarespace.PostTypes[e.item.recordType](d.Squarespace.Library.getCollection(f.collectionId),e.item);
j.edit()
}})
}else{if(d.Squarespace.ACTIVE_MANAGER){d.Squarespace.ACTIVE_MANAGER.getHistory().replace({module:"content",collectionId:f.collectionId})
}else{if(d.Squarespace.Management){d.Squarespace.Management.manageSite({module:"content",collectionId:f.collectionId})
}}}}else{document.location.href=f.itemUrl
}}},{TEMPLATE_NAME:"SearchContainerFullScreen.html",ATTRS:{}});
var a=d.Base.create("searchInputBox",d.Widget,[],{initializer:function(e){},renderUI:function(){var e=this._createSearchNode();
this.get("contentBox").append(e)
},bindUI:function(){this._enableAutoComplete();
this.get("boundingBox").one("form").on(this.get("id")+"|submit",this._onSubmit,this);
this.get("boundingBox").one("form").on(this.get("id")+"|keydown",this._onKeyDown,this);
this.after(this.get("id")+"|queryStringChange",this._resetAutoComplete,this)
},_onKeyDown:function(f){if(f.keyCode!==27){f.stopPropagation()
}},_autocompleteSelected:function(f){d.later(1,this,function(g){this.set("queryString",g.result.text)
},f)
},_onSubmit:function(g){g.preventDefault();
var f=this.get("contentBox").one("input").get("value");
this.set("queryString",f)
},_enableAutoComplete:function(){var f=this.get("contentBox").one("input");
if(this.get("withSearchSuggest")&&!f.ac){f.plug(d.Plugin.AutoComplete,{source:"/api/search/SearchSuggest?q={query}",resultTextLocator:"suggestion"});
var e=this.get("boundingBox").one("input").ac;
e.on("select",this._autocompleteSelected,this)
}},isAutocompleteEnabled:function(){var e=this.get("contentBox").all(".yui3-aclist-item");
if(e.size()>0){return true
}return false
},_resetAutoComplete:function(){var e=this.get("boundingBox").one("input");
if(e.ac){e.unplug("ac")
}this._enableAutoComplete()
},focus:function(){var e=this.get("contentBox").one("input");
e.focus();
e.set("value",this.get("queryString"));
if(this.get("queryString")!==""){e.select()
}},blur:function(){var e=this.get("contentBox").one("input");
e.blur()
},_createSearchNode:function(){var e=d.Node.create("<form/>");
e.append(d.DB.INPUT("field-input",{placeholder:"Type to search...",type:this.get("inputType"),spellcheck:false,value:this.get("queryString")}));
if(this.get("queryString")){this._lastQuery=this.get("queryString")
}return e
}},{ATTRS:{queryString:{value:""},inputType:{value:"search"},withSearchSuggest:{value:false}}});
d.Squarespace.Search=new (d.Base.create("searchSingleton",d.Base,[],{initializer:function(){this.attached=false
},onButtonClick:function(f){f.halt();
d.use("widget","autocomplete","squarespace-search-ui-css","squarespace-ui-templates","squarespace-animations",d.bind(function(e){this.show()
},this))
},show:function(){if(this.containerWidget&&this.containerWidget.isOpen()){return
}var f=this.get("lastState"),e;
if(f){e=f
}else{e={searchQuery:""}
}this.containerWidget=new c(e);
this.containerWidget.on(this.get("id")+"|destroy",function(g){this.set("lastState",{searchFilter:g.target.get("searchFilter"),searchQuery:g.target.get("searchQuery"),searchResult:g.target.get("searchResult")})
},this);
this.containerWidget.render()
},attach:function(){if(this.attached){return
}d.delegate("click",this.onButtonClick,"body",".sqs-search-ui-button",this);
d.one(document.body).on("keydown",function(f){if(f.ctrlKey&&f.keyCode==83){d.use("widget","autocomplete","squarespace-search-ui-css","squarespace-ui-templates","squarespace-animations",function(e){e.Squarespace.Search.show()
})
}},this);
this.attached=true
}},{ATTRS:{lastState:{value:null}}}))()
},"1.0",{requires:["base","squarespace-ss-widget","squarespace-SearchContainerFullScreen-template"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-image-loader",function(a){if(!window.ImageLoader){console.warn("Image Loader is not available. Automatically including ImageLoader.js.");
a.use("get",function(){a.Get.js("/universal/scripts-v6/ImageLoader.js")
})
}a.namespace("Squarespace").Loader=a.Base.create("Loader",a.Base,[],{initializer:function(){if(this.get("frames")){this._processFrames()
}if(this.get("img")){this._processImages()
}},_processFrames:function(){this._getNodeList("frames").each(function(b){if(b.getAttribute("data-embed")){b.resizeToParent({scale:"contain",sizeOnly:true})
}})
},_processImages:function(){this._getNodeList("img").each(function(b){var c=false;
if(b.loader){c=true
}b.plug(a.Squarespace.Loader2,this.get("loaderOptions")||{});
if(c){b.fire("refresh")
}},this)
},_getNodeList:function(b){var c=this.get(b);
if(a.Lang.isString(c)){return a.all(c)
}else{if(!c.size){return new a.NodeList(c)
}else{return c
}}}},{ATTRS:{frames:{},img:{},loaderOptions:{}}});
a.namespace("Squarespace").Loader2=a.Base.create("Loader2",a.Plugin.Base,[],{initializer:function(){var d=this.get("host");
var b=100;
var c=0;
function e(){if(!d.inDoc()&&(++c<b)){a.later(10,this,e)
}else{this.load()
}}e.call(this);
this.on("refresh",this.load,this);
d.on("refresh",this.load,this)
},load:function(){var b=this.get("host");
if(!!b.getAttribute("src")&&b.get("complete")){b.fire("loaded")
}b.on("load",function(){if(b.getDOMNode()===null||!b.inDoc()){return
}b.removeClass("loading").addClass("loaded");
b.fire("loaded")
},this);
ImageLoader.load(b.getDOMNode(),a.merge(this.getAttrs(),{load:this.get("load")}))
},getDimensionForValue:function(c,b){return ImageLoader.getDimensionForValue(c,b,ImageLoader._getDataFromNode(this.get("host").getDOMNode()))
},getBareElement:function(){var b=this.get("host");
var c=a.Node.create("<img />");
c.setAttribute("data-image",b.getAttribute("data-image"));
c.setAttribute("data-image-dimensions",b.getAttribute("data-image-dimensions"));
c.setAttribute("data-image-focal-point",b.getAttribute("data-image-focal-point"));
return c
},destructor:function(){}},{NS:"loader",ATTRS:{stretch:{value:true},load:{value:true},source:{},fitAlignment:{},fit:{value:false,setter:function(b){if(b){this.set("mode","fit")
}}},fill:{value:false,setter:function(b){if(b){this.set("mode","fill")
}}},focalPoint:{setter:function(b){ImageLoader.load(this.get("host").getDOMNode(),{focalPoint:b.x+","+b.y});
return b
}},mode:{validator:function(b){return["fit","fill","none",null].indexOf(b)!==-1
}},refreshOnResize:{value:false}}});
a.namespace("Squarespace").ImageLoadManager=new (a.Base.create("ImageLoadManager",a.Base,[],{refreshAll:function(){a.all("img[data-image]").each(function(b){b.fire("refresh")
})
}}))();
a.augment(a.Node,Class.create({refresh:function(){this.fire("refresh")
}}))
},"1.0",{requires:["base","plugin","node"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-video-loader",function(a){a.namespace("Squarespace");
a.Squarespace.VideoLoader=a.Base.create("VideoLoader",a.Plugin.Base,[],{initializer:function(){var b=this.get("host");
b.plug(a.Squarespace.NodeDestroyNotifier,{onDestroy:function(){this.destroy()
},context:this});
this._setVariables();
this._resizeEmitter=new a.Squarespace.ResizeEmitter({timeout:100});
this.render()
},render:function(){if(this._rendered){return
}if(this.get("type")=="invalid"&&this.get("overlay")){this.get("overlay").remove();
this._set("overlay",null)
}var n=this.get("host");
var e=this.get("mode");
if(this._modeClass){n.removeClass(this._modeClass)
}this._modeClass="video-"+e;
n.addClass(this._modeClass);
var m;
var c;
if(this._intrinsic){var j=this.getWidth();
var g=this.getHeight();
var b;
if(j&&g){b=(g/j)*100
}else{b=56.3
}m=a.Node.create('<div class="intrinsic"></div>');
c=a.Node.create('<div class="intrinsic-inner" style="padding-bottom: '+b+'%;"></div>');
var k=n.get("parentNode");
var i=k.getComputedStyle("position");
if(e=="fit"){var l=k.get("offsetWidth");
var f=k.get("offsetHeight");
var d=Math.round((l*b)/100);
n.setStyle("top",(f-d)/2+"px");
if(i=="static"){k.setStyle("position","relative")
}}else{if(e=="fill"){if(i=="static"){k.setStyle("position","relative")
}}}if(this.get("overlay")){this.get("overlay").wrap(c);
c.wrap(m)
}else{m.appendChild(c);
n.appendChild(m)
}}if(this.get("overlay")){this.get("overlay").setStyle("opacity",1);
var h=this.get("overlay").one("img");
if(h){h.fire("refresh");
this.get("overlay").one("img").plug(a.Squarespace.Loader2,{load:true,mode:"fill"});
this.get("overlay").one("img").fire("refresh")
}}else{if(m){c.appendChild(this.get("video"))
}else{n.appendChild(this.get("video"))
}this._set("loaded",true)
}this._rendered=true;
this.bindUI()
},bindUI:function(){if(!Static.IN_BACKEND){if(this.get("overlay")){this.get("overlay").on("click",function(b){if(!this.get("inactive")){this.load()
}},this)
}}this.after("modeChange",this.refresh,this);
this._resizeEmitter.on("resize",function(){if(this.get("mode")=="fit"){this._resetFitTop()
}if(this.get("overlay")){this.get("overlay").one("img").fire("refresh")
}},this);
a.Global.on("tweak:aftershow",function(){if(this.get("mode")=="fit"){this._resetFitTop()
}},this);
a.Global.after("tweak:afterclose",function(){if(this.get("mode")=="fit"){setTimeout(a.bind(function(){this._resetFitTop()
},this),1000)
}},this)
},refresh:function(){var b=this.get("host");
b.setStyles({top:null});
this.unload();
if(this.get("overlay")){this.get("overlay").remove()
}this.get("video").remove();
if(this._intrinsic){b.one(".intrinsic").remove(true)
}if(this.get("overlay")){this.get("overlay").setStyle("opacity",0);
b.appendChild(this.get("overlay"))
}this._setIntrinsic();
this._rendered=false;
this.render()
},load:function(){if(this.get("loaded")||!this.get("overlay")){return
}this._set("loaded",true);
this._unloadOthers();
var b=this.get("video");
b.setStyle("opacity",0);
if(this._intrinsic){this.get("host").one(".intrinsic-inner").appendChild(b)
}else{this.get("host").appendChild(b)
}this._transitionFromOverlay()
},unload:function(){if(!this.get("loaded")||!this.get("overlay")){return
}this._set("loaded",false);
this.get("overlay").setStyle("opacity",0);
this.get("overlay").setStyle("visibility",null);
this._transitionToOverlay()
},reload:function(){if(!this.get("loaded")){return
}var c=this.get("video");
if(this.get("type")=="object"){c.remove();
var b=this.get("host");
if(this._intrinsic){b.one(".intrinsic-inner").appendChild(c)
}else{b.appendChild(c)
}}else{if(this.get("type")=="iframe"){c.setAttribute("src",c.getAttribute("src"))
}}},play:function(){if(!this.get("apiFriendly")){return
}var b=this.get("video").getDOMNode().contentWindow;
switch(this._providerName){case"Vimeo":b.postMessage('{"method": "play", "value": "true"}',"*");
break;
case"YouTube":b.postMessage('{"event":"command","func":"playVideo","args":""}',"*");
break
}},pause:function(){if(!this.get("apiFriendly")){return
}var b=this.get("video").getDOMNode().contentWindow;
switch(this._providerName){case"Vimeo":b.postMessage('{"method": "pause", "value": "true"}',"*");
break;
case"YouTube":b.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");
break
}},getWidth:function(){return this.get("video").getAttribute("width")
},getHeight:function(){return this.get("video").getAttribute("height")
},_setVariables:function(){var f=this.get("host");
this._setIntrinsic();
this._set("overlay",f.one(".sqs-video-overlay"));
var e=a.Node.create(f.getAttribute("data-html"));
var b=a.Node.create('<div class="sqs-video-invalid-wrapper"><div class="state-message">Invalid video embed.</div></div>');
var d;
if(!e){d=b;
this._set("type","invalid")
}else{if(e.test("iframe")){d=e;
this._set("type","iframe")
}else{if(e.test("object")){d=e;
this._set("type","object")
}else{if(e.one("iframe")){d=e.one("iframe");
this._set("type","iframe")
}else{if(e.one("object")){d=e.one("object");
this._set("type","object")
}else{d=b;
this._set("type","invalid")
}}}}}this._set("video",d);
var c=f.getAttribute("data-provider-name");
if((!c||c==="")&&this.get("type")!="invalid"){var g=this.get("video").getAttribute("src");
if(g.match("player.vimeo.com")){c="Vimeo"
}else{if(g.match("www.youtube.com")){c="YouTube"
}}}this._providerName=c;
if(this.get("type")!="invalid"){this._augmentVideoSrc()
}},_setIntrinsic:function(){this._intrinsic=(this.get("mode")=="none"||this.get("mode")=="fit")
},_resetFitTop:function(){var d=this.get("host");
var c=d.get("parentNode").get("offsetHeight");
var e=d.one(".intrinsic");
e.setStyle("top",null);
var b=e.get("offsetHeight");
d.setStyle("top",(c-b)/2+"px")
},_augmentVideoSrc:function(){var b=(this.get("type")=="iframe")?this.get("video"):this.get("video").one("embed");
var f=b.getAttribute("src");
var c=f.split("?");
var e=c[0];
var g=c[1]||"";
var d=a.QueryString.parse(g);
if(this.get("overlay")){if(this._providerName=="Wistia, Inc."){d.autoPlay="true"
}else{d.autoplay=1
}}if(this.get("type")=="object"||this._providerName=="Vimeo"){if(window.location.protocol.startsWith("https")){e=e.replace("http://","https://")
}}if(this.get("type")=="iframe"){switch(this._providerName){case"Vimeo":d.api=1;
this._set("apiFriendly",true);
break;
case"YouTube":d.enablejsapi=1;
this._set("apiFriendly",true);
break
}}f=e+"?"+a.QueryString.stringify(d);
b.setAttribute("src",f)
},_transitionFromOverlay:function(){var b=this.get("overlay");
b.one(".sqs-video-opaque").anim({opacity:1},{duration:1,start:function(){b.one(".sqs-video-icon").setStyle("visibility","hidden")
},end:function(){this.get("video").setStyle("opacity",1);
if(this.get("loaded")){b.setStyle("visibility","hidden")
}if(b.hasClass("no-thumb")){b.one(".sqs-video-opaque").setStyle("opacity",1)
}else{b.one(".sqs-video-opaque").setStyle("opacity",0)
}b.one(".sqs-video-icon").setStyle("visibility",null)
},context:this}).run()
},_transitionToOverlay:function(){var b=this.get("video");
b.anim({opacity:0},{duration:0.3,start:function(){this.get("overlay").anim({opacity:1},{duration:0.3}).run()
},end:function(){b.remove()
},context:this}).run()
},_unloadOthers:function(){a.all(".sqs-video-wrapper").each(function(b){if(b==this.get("host")){return
}b.videoloader.unload()
},this)
}},{NS:"videoloader",ATTRS:{apiFriendly:{value:false,readOnly:true},inactive:{value:false},loaded:{value:false,readOnly:true},mode:{value:"none",validator:function(b){return["none","fit","fill",null].indexOf(b)!=-1
}},overlay:{value:null,readOnly:true},type:{value:null,readOnly:true},video:{value:null,readOnly:true}}})
},"1.0",{requires:["base","plugin","node","querystring","squarespace-image-loader","squarespace-video-css"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-dombuilder",function(a){a.DB={unpackData:function(c,b){if(c._node){c=c._node
}if(b){while(c){if(c.data&&c.className.indexOf(b)!=-1){return c.data
}c=c.parentNode
}}else{while(c){if(c.data){return c.data
}c=c.parentNode
}}return(null)
},DIV:function(){return(a.DB._gen("DIV",Array.prototype.slice.call(arguments)))
},PARAGRAPH:function(){return(a.DB._gen("P",Array.prototype.slice.call(arguments)))
},LI:function(){return(a.DB._gen("LI",Array.prototype.slice.call(arguments)))
},SPAN:function(){return(a.DB._gen("SPAN",Array.prototype.slice.call(arguments)))
},A:function(){return(a.DB._gen("A",Array.prototype.slice.call(arguments)))
},UL:function(){return(a.DB._gen("UL",Array.prototype.slice.call(arguments)))
},LABEL:function(){return(a.DB._gen("LABEL",Array.prototype.slice.call(arguments)))
},INPUT:function(){return(a.DB._gen("INPUT",Array.prototype.slice.call(arguments)))
},TEXTAREA:function(){return(a.DB._gen("TEXTAREA",Array.prototype.slice.call(arguments)))
},SELECT:function(){return(a.DB._gen("SELECT",Array.prototype.slice.call(arguments)))
},OPTION:function(){return(a.DB._gen("OPTION",Array.prototype.slice.call(arguments)))
},IMG:function(){return(a.DB._gen("IMG",Array.prototype.slice.call(arguments)))
},TABLE:function(){return(a.DB._gen("TABLE",Array.prototype.slice.call(arguments)))
},TBODY:function(){return(a.DB._gen("TBODY",Array.prototype.slice.call(arguments)))
},THEAD:function(){return(a.DB._gen("THEAD",Array.prototype.slice.call(arguments)))
},TH:function(){return(a.DB._gen("TH",Array.prototype.slice.call(arguments)))
},TR:function(){return(a.DB._gen("TR",Array.prototype.slice.call(arguments)))
},TD:function(){return(a.DB._gen("TD",Array.prototype.slice.call(arguments)))
},VIDEO:function(){return(a.DB._gen("VIDEO",Array.prototype.slice.call(arguments)))
},PARAM:function(){return(a.DB._gen("PARAM",Array.prototype.slice.call(arguments)))
},OBJECT:function(){return(a.DB._gen("OBJECT",Array.prototype.slice.call(arguments)))
},SOURCE:function(){return(a.DB._gen("SOURCE",Array.prototype.slice.call(arguments)))
},SUP:function(){return(a.DB._gen("SUP",Array.prototype.slice.call(arguments)))
},BUTTON:function(){return(a.DB._gen("BUTTON",Array.prototype.slice.call(arguments)))
},_gen:function(o,l){var d=document.createElement(o);
var c=0;
if(l.length>c&&typeof(l[c])=="string"){d.className=l[c];
++c
}if(l.length>c&&l[c]!=null&&typeof(l[c])=="object"&&!(l[c] instanceof Array)&&(l[c].getAttribute==null)&&(l[c]._node==null)){var m=l[c];
++c;
for(var e in m){if(e=="html"){d.innerHTML=m[e]
}else{if(e=="data"){d.data=m[e]
}else{if(e=="style"&&typeof(m[e])=="object"){for(var g in m[e]){d.style[g]=m[e][g]
}}else{d.setAttribute(e,m[e])
}}}}if(o=="A"){if(!m.href){d.href="javascript:noop();"
}}}d=a.one(d);
if(d.data&&d.data()){d._data=d.data()
}for(var h=c;
h<l.length;
++h){if(l[h] instanceof Array){for(var f=0;
f<l[h].length;
++f){var b=l[h][f];
d.append(b)
}}else{var b=l[h];
d.append(b)
}}return d
}}
},"1.0",{requires:["node"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-audio-player",function(c){var b=function(){};
var a=c.namespace("Squarespace.Widgets").AudioPlayer=c.Base.create("audioPlayer",c.Squarespace.Widgets.SSWidget,[],{initializer:function(d){var e=this.get("render");
if(c.Lang.isBoolean(e)){e=null
}else{if(c.Lang.isString(e)){e=c.one(e)
}}if(e){if(e._audioPlayer){e._audioPlayer.destroy()
}e._audioPlayer=this;
c.Object.each(e.getData(),function(g,f){if(g){this.set(f,g)
}},this)
}c.use("thirdparty-sound-manager-2",b)
},destructor:function(){if(this._sound){this.stop();
this._sound.destruct()
}},render:function(){var d=arguments;
c.use("thirdparty-sound-manager-2",c.bind(function(e){this._soundManager=soundManager;
a.superclass.render.apply(this,d)
},this))
},renderUI:function(){a.superclass.renderUI.apply(this,arguments);
var f=this.get("boundingBox");
var l=f.one(".placeholder");
var k=this.get("title"),h=this.get("author");
if(k&&h){l.setContent(c.Node.create('<div class="audio-author">'+h+'</div><div class="audio-title">'+k+"</div>"))
}else{if(k){l.setContent(c.Node.create('<div class="audio-title">'+k+"</div>"))
}else{l.setContent(this.get("strings.placeholder"))
}}f.one(".progress-inner").setStyle("width","0px");
this._volumeNode=f.one(".volume");
if(!this._volumeNode){throw this.name+": No div.volume in template."
}var e=this.get("volumeLevels"),j=this.get("volume"),d=Math.round(j/100*e);
for(var g=e;
g>0;
g--){this._volumeNode.prepend(c.zen("div.bar.level-"+g+'[data-volume-level="'+g+'"]'))
}f.one(".duration").setContent(this.get("strings.durationPlaceHolder"))
},bindUI:function(){var d=this.get("id");
this.get("boundingBox").on(d+"|click",this._onClick,this);
this.after(d+"|volumeChange",function(f){this._setVolume(f.newVal)
},this);
this.after(d+"|playStateChange",this._uiUpdateWrapperClass,this);
this.after(d+"|readyStateChange",this._afterReadyStateChange,this);
this.after(d+"|disabledChange",function(g){var f=g.newVal;
if(f){this.stop()
}},this);
c.on(d+"|audioPlayer:stopAll",function(g){var f=g?g.container:null;
if(f&&c.Lang.isString(f)){f=c.one(f)
}if(!g||!g.hasOwnProperty("container")||((f instanceof c.Node)&&f.contains(this.get("boundingBox")))){this.stop()
}},this)
},syncUI:function(){this._uiUpdateWrapperClass();
this._uiUpdateVolumeLevel()
},play:function(){if(!this._sound){this._initSoundManagerSound()
}if(this._sound){if(this._sound.paused){this._sound.resume()
}else{this._sound.play()
}}},pause:function(){if(this._sound){this._sound.pause()
}},stop:function(){var e=this.get("playState"),d=this.getProperty("PLAY_STATES");
if(e===d.PLAYING&&this._sound){this._sound.stop()
}},seek:function(d){if(d>100||d<0){console.warn(this.name+": seek() - Percentage between 0-100 required.");
return
}if(!this._sound){this._initSoundManagerSound()
}this.pause();
this._sound.setPosition(this._sound.duration*(d/100));
this.play()
},setVolume:function(d){this.set("volume",d)
},_checkSoundManagerStatus:function(){var d=this._soundManager,e=this.getProperty("READY_STATES");
if(d.enabled){this._set("readyState",e.INITIALIZED);
return true
}else{if(d.didFlashBlock){this._set("readyState",e.FLASH_BLOCKED)
}else{this._set("readyState",e.SECURITY_ERROR)
}return false
}},_setVolume:function(d){if(this._sound){this._sound.setVolume(d)
}this._set("volume",d);
this._uiUpdateVolumeLevel()
},_setVolumeLevel:function(d){this._setVolume(Math.round(d/this.get("volumeLevels")*100))
},_initSoundManagerSound:function(){if(this._checkSoundManagerStatus()===false){return false
}if(!this._sound){var e=this.get("boundingBox"),d=this.get("url");
e.addClass("loading");
if(!d){this._showError("No URL provided.");
return
}if(d.indexOf("//")===0){d=window.location.protocol+d
}this._sound=this._soundManager.createSound({id:"squarespaceTrack-"+this.get("id"),url:d,volume:this.get("volume"),autoPlay:false,onplay:c.bind(this._onPlay,this),onpause:c.bind(this._onPause,this),onresume:c.bind(this._onPlay,this),onstop:c.bind(this._onStop,this),onfinish:c.bind(this._onStop,this),whileplaying:c.bind(this._onWhilePlaying,this),onload:c.bind(this._onLoad,this),ondataerror:c.bind(this._onDataError,this)});
return !!this._sound
}return false
},_uiUpdateVolumeLevel:function(){var f=this._volumeNode.get("children"),d=this.get("volumeLevels"),e=this.get("volume"),g=Math.round(e/100*d);
f.each(function(h){var i=parseInt(h.getAttribute("data-volume-level"),10);
if(i<=g){h.addClass("active")
}else{h.removeClass("active")
}},this)
},_uiUpdateWrapperClass:function(){var i=this.getProperty("READY_STATES"),g=this.getProperty("PLAY_STATES"),f=this.get("boundingBox"),e=f.getAttribute("class").split(" ");
var d=function(k){var j=c.Array.indexOf(e,k);
if(j!==-1){e.splice(j)
}};
var h;
for(h in g){e.remove("play-state-"+g[h])
}for(h in i){e.remove("ready-state-"+i[h])
}f.addClass("ready-state-"+this.get("readyState"));
f.setAttribute("class",e.join(" ")).addClass("play-state-"+this.get("playState")).addClass("ready-state-"+this.get("readyState"))
},_onClick:function(h){h.halt();
h.stopImmediatePropagation();
if(this.get("disabled")){return
}if(h.target.hasClass("duration")){return
}if(h.target.ancestor(".volume")){this._setVolumeLevel(parseInt(h.target.getAttribute("data-volume-level"),10));
return
}if(h.target.ancestor(".placeholder",true)){this.play();
return
}if(h.target.ancestor(".controls",true)){var g=this.get("playState"),f=this.getProperty("PLAY_STATES");
switch(g){case f.PLAYING:this.pause();
return;
case f.PAUSED:case f.STOPPED:this.play();
return;
default:console.warn(this.name+": Wait, what? How did you get here? Case was ",g);
return
}}var d=this.get("boundingBox").one(".progress").get("region");
if(h.pageX>=d.left&&h.pageY<=d.right){this.seek((h.pageX-d.left)/d.width*100)
}},_afterReadyStateChange:function(i){var h=this.getProperty("READY_STATES"),g=this.get("readyState"),d=this.get("strings"),f=false;
switch(g){case h.INITIALIZED:this.enable();
break;
case h.FLASH_BLOCKED:f=d.soundManagerFlashFail;
break;
case h.SECURITY_ERROR:f=d.soundManagerSecurityFail;
break;
case h.SOUND_LOAD_FAILED:f=d.soundManagerURLFail;
break;
case h.SOUND_LOADED:break;
default:console.warn(this.name+": Invalid ready state ("+g+").");
break
}if(f){console.warn("AUDIO ERROR: "+f);
this._showError(f);
this.disable()
}this._uiUpdateWrapperClass()
},_getPlaytimeString:function(){if(!this._sound||!(this._sound.loaded&&this._sound.duration&&this._sound.position)){return this.get("strinsg.durationPlaceHolder")
}var g=Math.round(this._sound.duration/1000),d=Math.round(this._sound.position/1000),j=Math.floor(g/60),f=g-j*60,e=(f<10?"0":"")+f,h=Math.floor(d/60),k=d-h*60,i=(k<10?"0":"")+k;
return h+":"+i+" / "+j+":"+e
},_showError:function(d){this.get("boundingBox").addClass("error");
this.get("boundingBox").one(".placeholder").setContent("Error: "+d)
},_onWhilePlaying:function(){if(this.get("destroyed")){return
}if(!(this._sound.loaded&&this._sound.duration)){return
}var f=this.getProperty("READY_STATES");
if(this.get("readyState")!==f.SOUND_LOADED){this._set("readyState",f.SOUND_LOADED)
}var d=this.get("boundingBox"),e=d.one(".progress-inner"),g=this._sound.position/this._sound.duration*100;
d.removeClass("loading");
if(e){e.setStyle("width",g+"%")
}d.one(".duration").setContent(this._getPlaytimeString())
},_onPlay:function(){if(this._loadFailTimer){this._loadFailTimer.cancel()
}var d=c.Squarespace.Widgets.AudioPlayer.PLAY_STATES;
this._set("playState",d.PLAYING)
},_onStop:function(){this._set("playState",this.getProperty("PLAY_STATES").STOPPED)
},_onPause:function(){this._set("playState",this.getProperty("PLAY_STATES").PAUSED)
},_onDataError:function(){this.stop();
this._set("playState",this.getProperty("PLAY_STATES").STOPPED)
},_onLoad:function(d){if(!d){this._loadFailTimer=c.later(1000,this,function(){this.stop();
this._set("readyState",this.getProperty("READY_STATES").SOUND_LOAD_FAILED)
})
}}},{CSS_PREFIX:"sqs-audio-player",PLAY_STATES:{PLAYING:"playing",PAUSED:"paused",STOPPED:"stopped"},READY_STATES:{INITIALIZED:"initialized",FLASH_BLOCKED:"flash-blocked",SECURITY_ERROR:"security-error",SOUND_LOAD_FAILED:"sound-load-failed",SOUND_LOADED:"sound-loaded"},PUT_TEMPLATE:"div.controls+div.placeholder+div.progress>div.progress-inner>div.scrubber<<<div.duration+div.volume<",ATTRS:{strings:{value:{placeholder:"Click to play...",durationPlaceHolder:"0:00 / 0:00",loadFail:"Unable to load sound at the URL",soundManagerFlashFail:"Sorry, could not load because flash is blocked.",soundManagerSecurityFail:"Sorry, there was a JavaScript security error.",soundManagerURLFail:"Unable to access audio stream."}},playState:{lazyAdd:false,valueFn:function(){return this.getProperty("PLAY_STATES").STOPPED
},readOnly:true},readyState:{lazyAdd:false,valueFn:function(){return this.getProperty("READY_STATES").INITIALIZED
},readOnly:true},url:{value:null},volume:{validator:function(d){if(d<0||d>100){console.warn(this.name+": Volume must be between 0 and 100, volume remains unchanged.")
}return true
},value:66},volumeLevels:{value:6,writeOnce:"initOnly"},stopOthersOnPlay:{value:true},render:{value:true}}})
},"1.0",{requires:["node","event","squarespace-dombuilder","squarespace-ss-widget","squarespace-audio-player-css"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-gismo",function(a){a.Squarespace.GismoBase=function(){this._events={};
this._timers={};
this._anims=this._anims||new a.Squarespace.Anims()
};
a.Squarespace.GismoBase.prototype={destructor:function(){for(var b in this._events){while(this._events[b].length!==0){this._events[b].shift().detach()
}}for(var c in this.timers){while(this._timer[c].length!==0){this._timer[c].shift().cancel()
}}this._anims.destroy()
},_anim:function(b,e,c){var d=b.anim(e,c||{});
d.on("end",function(){this._anims.remove(d)
},this);
this._anims.add(d);
return d
},_event:function(c,b){b=b||"generic";
this._events[b]=this._events[b]||[];
this._events[b].push(c)
},_getEvents:function(b){return this._events[b||"generic"]
},_flushEvents:function(b){b=b||"generic";
if(!!this._events[b]){while(this._events[b].length!==0){this._events[b].shift().detach()
}}},_timer:function(c,b){b=b||"generic";
this._timers[b]=this._timers[b]||[];
this._timers[b].push(c)
}}
},"1.0",{requires:["squarespace-anims","squarespace-util"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-animations",function(e){e.namespace("Squarespace.Animations");
var d="display-status-",c="-plugged",b="shown",a="hidden";
e.Squarespace.Animations.Expandable=e.Base.create("expandable",e.Plugin.Base,[],{initializer:function(f){this.doBefore("show",this.open);
this.doBefore("hide",this.close);
this._running=false
},close:function(k){var f=this.get("host"),j=this.get("easing"),h=this.get("duration"),g,i;
k=(f.inDoc()?k:true);
f.fire("close");
if(k){this._hardClose()
}else{if(!this._running){this._running=true;
f.wrap('<div class="expandable-plugin-wrapper"></div>');
i=f.ancestor(".expandable-plugin-wrapper");
i.setStyles({overflow:"hidden",height:f.get("offsetHeight")});
this._closeWrapper=i;
g=new e.Anim({node:i,to:{height:0},easing:j,duration:h});
g.on("end",function(){if(f.inDoc()){f.setStyles({height:0,overflow:"hidden",display:"none"});
f.unwrap();
f.addClass("expandable-hidden")
}this._running=false;
f.fire("closed")
},this);
this._closeAnim=g;
g.run()
}}return new e.Do.Prevent("Expandable prevented default hide.")
},_hardClose:function(){var f=this.get("host");
f.setStyles({height:0,overflow:"hidden",display:"none"});
f.addClass("expandable-hidden");
f.fire("closed")
},_hardOpen:function(){var f=this.get("host");
f.setStyles({height:null,display:null});
f.removeClass("expandable-hidden");
f.fire("opened")
},open:function(m){var h=this.get("host"),l=this.get("easing"),j=this.get("duration"),i,g,f,k;
m=(h.inDoc()?m:true);
h.fire("open");
if(m){this._hardOpen()
}else{if(!this._running){this._running=true;
if(h.getComputedStyle("display")==="none"){h.setStyle("display",null)
}f=h.cloneNode(true);
f.setStyles({height:"auto",visibility:"hidden",display:null,position:"absolute",width:h.get("offsetWidth")});
h.insert(f,"before");
g=f.get("offsetHeight")+parseInt(f.getComputedStyle("marginTop"),10)+parseInt(f.getComputedStyle("marginBottom"),10);
f.remove(true);
h.wrap('<div class="expandable-plugin-wrapper"></div>');
k=h.ancestor(".expandable-plugin-wrapper");
k.setStyles({overflow:"hidden",height:0});
h.setStyles({height:null,overflow:null});
this._openWrapper=k;
i=new e.Anim({node:k,to:{height:g},easing:l,duration:j});
i.on("end",function(){var n=this.get("host");
if(n){this._running=false;
n.unwrap();
n.removeClass("expandable-hidden");
n.fire("opened")
}},this);
this._openAnim=i;
i.run()
}}return new e.Do.Prevent("Expandable prevented default show.")
},destructor:function(){if(this._closeWrapper){this._closeWrapper.remove(true)
}if(this._openWrapper){this._openWrapper.remove(true)
}if(this._openAnim){this._openAnim.stop().destroy()
}if(this._closeAnim){this._closeAnim.stop().destroy()
}}},{NS:"expandablePlugin",ATTRS:{duration:{value:0.3,validator:e.Lang.isNumber},easing:{value:e.Easing.easeOutStrong}}});
e.Squarespace.Animations.Fadeable=e.Base.create("fadeable",e.Plugin.Base,[],{initializer:function(f){this.beforeHostMethod("show",this.show);
this.beforeHostMethod("hide",this.hide);
this.get("host").addClass(this.name+c);
this._onlyUseOpacity=(f.onlyUseOpacity===undefined)?false:f.onlyUseOpacity;
this._running=false
},destructor:function(){if(this._anim){this._anim.stop().destroy()
}this.get("host").removeClass(this.name+c)
},show:function(f){return this._changeVisibility(true,f)
},hide:function(f){return this._changeVisibility(false,f)
},_changeVisibility:function(g,h){var f=this.get("host");
h=(f.inDoc()?h:true);
if(g){f.removeClass(d+"hidden")
}if(h){this._hardChangeVisibility(g)
}else{if(this._anim){this._anim.stop().destroy();
this._anim=null
}if(g&&f.getComputedStyle("display")==="none"){f.setStyle("display",null)
}this._anim=new e.Anim({node:f,to:{opacity:(g?this.get("opacity"):0)},easing:this.get("easing"),duration:this.get("duration")});
this._anim.onceAfter("end",function(){this._hardChangeVisibility(g);
this._running=false;
if(!g&&!this._onlyUseOpacity&&f.getDOMNode()){f.setStyle("display","none")
}f.fire(g?"shown":"hidden");
delete this._anim
},this);
this._anim.run()
}return new e.Do.Prevent("Fadeable prevented default "+(g?"show":"hide")+" and used its own.")
},_hardChangeVisibility:function(g){var f=this.get("host");
if(!g){f.addClass(d+"hidden")
}f.setStyles({opacity:(g?1:0)});
this._anim=null;
f.fire(g?b:a)
}},{NS:"fadeablePlugin",ATTRS:{duration:{value:0.3,validator:e.Lang.isNumber},easing:{value:e.Easing.easeOutStrong},opacity:{value:1}}});
e.Squarespace.Animations.Scalable=e.Base.create("scalable",e.Plugin.Base,[],{initializer:function(f){this.doBefore("show",this.show);
this.doBefore("hide",this.hide);
this._running=false
},destructor:function(){},show:function(f){return this._changeVisibility(true,f)
},hide:function(f){return this._changeVisibility(false,f)
},_changeVisibility:function(h,k){var l=this.get("host"),j=this.get("easing"),f=this.get("duration"),m=!!(this.get("host").getDOMNode().style.transitionDuration||e.DOM.CUSTOM_STYLES.transitionDuration);
l.fire(h?"show":"hide");
k=(l.inDoc()?k:true);
if(k){this._hardChangeVisibility(h)
}else{if(!this._running){this._running=true;
if(h){l.setStyles({visibility:"visible"})
}var n=this;
var g=false;
var i=function(){if(g){return
}g=true;
if(!l.getDOMNode()){return
}if(!h){l.setStyles({visibility:"hidden"})
}n._running=false;
n.fire(h?b:a);
l.fire(h?b:a)
};
if(m){l.transition({opacity:(h?1:0),transform:"scale("+(h?"1":"0.94")+")"},i)
}else{l.transition({opacity:(h?1:0)},i)
}if(e.UA.webkit||e.UA.gecko){setTimeout(i,300)
}}}return new e.Do.Prevent("Scalable prevented default "+(h?"show":"hide")+" and used its own.")
},_hardChangeVisibility:function(h){var g=this.get("host");
var f=!!(this.get("host").getDOMNode().style.transitionDuration||e.DOM.CUSTOM_STYLES.transitionDuration);
if(f){g.setStyles({visibility:(h?"visible":"hidden"),opacity:(h?1:0),transform:"scale("+(h?"1":"0.94")+")"})
}else{g.setStyles({visibility:(h?"visible":"hidden"),opacity:(h?1:0)})
}g.fire(h?b:a)
}},{NS:"scalablePlugin",ATTRS:{duration:{value:0.3,validator:e.Lang.isNumber},easing:{value:e.Easing.easeOutStrong},opacity:{value:1}}});
e.Squarespace.Animations.Slideable=e.Base.create("slideable",e.Plugin.Base,[],{initializer:function(f){this.doBefore("show",this.show);
this.doBefore("hide",this.hide);
this._running=false
},show:function(f){return this._changeVisibility(true,f)
},hide:function(f){return this._changeVisibility(false,f)
},_changeVisibility:function(i,m){var n=this.get("host"),j=this.get("easing"),f=this.get("duration"),l=this.get("direction");
n.fire(i?"show":"hide");
m=(n.inDoc()?m:true);
if(m){this._hardChangeVisibility(i)
}else{var g;
if(i){n.setStyles({display:"block",visibility:"hidden"});
var k=(l=="left"?1:-1)*n.get("offsetWidth");
n.setStyles({visibility:null});
console.log("showing node (fromLeft: "+k+", toLeft: 0)");
n.anim({left:0},{from:{left:k},duration:f,easing:j}).run()
}else{if(n.activeAnim){n.activeAnim.stop(true)
}n.setStyles({display:"block",left:0});
var h=(l=="left"?-1:1)*n.get("offsetWidth");
console.log("hiding node (fromLeft: 0, toLeft: "+h+")");
n.anim({left:h},{from:{left:0},duration:f,easing:j,end:function(){n.setStyles({display:"none",left:0})
}}).run()
}}return new e.Do.Prevent("Slideable prevented default "+(i?"show":"hide")+" and used its own.")
},_hardChangeVisibility:function(g){var f=this.get("host");
f.setStyles({display:g?"block":"none"});
f.fire(g?b:a)
}},{NS:"slideablePlugin",ATTRS:{duration:{value:0.2,validator:e.Lang.isNumber},easing:{value:e.Easing.easeOutStrong},opacity:{value:1}}})
},"1.0",{requires:["base","plugin","anim","anim-easing","animations-css","transition"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-debugger",function(a){a.namespace("Squarespace");
a.Squarespace.Debugger=Class.create({defaultOpts:{output:true,ignore:[],name:"GenericComponent"},initialize:function(c){this.params=a.merge(this.defaultOpts,c);
if(a.Cookie.get("SQUARESPACE_DEBUG_"+this.params.name.toUpperCase())){this.params.output=true
}if(this.params.uid){this.params.name+=" #"+this.getUID()
}if(this.params.logEvents){var b=this;
this.params.logEvents.fire=function(d){b.log("Firing",d);
a.EventTarget.prototype.fire.apply(b.params.logEvents,arguments)
}
}this.logEnabled=this.params.output
},log:function(){if(!this.params.output){return
}if(this.params.ignore.indexOf(arguments[0])>=0){return
}var b=Array.prototype.slice.call(arguments);
b.unshift("["+this.params.name+"]");
if(console.log){if(a.UA.ios){console.log(b.join(" "))
}else{if(console.log.apply){console.log.apply(console,b)
}else{console.log(b)
}}}},error:function(){var b=Array.prototype.slice.call(arguments);
b.unshift(this.params.name);
if(a.UA.ios){b=[b.join(" ")]
}if(console.error){if(a.UA.ios){console.error(b.join(" "))
}else{if(console.error.apply){console.error.apply(console,b)
}else{console.error(b)
}}}if(console.trace){console.trace()
}},warn:function(){var b=Array.prototype.slice.call(arguments);
b.unshift("["+this.params.name+"]");
if(console.warn){if(a.UA.ios){console.warn(b.join(" "))
}else{if(console.warn.apply){console.warn.apply(console,b)
}else{console.warn(b)
}}}},getUID:function(){if(a.Squarespace.Debugger.lastUID[this.params.name]===undefined){a.Squarespace.Debugger.lastUID[this.params.name]=0
}return a.Squarespace.Debugger.lastUID[this.params.name]++
},time:function(b){if(!this.params.output){return
}if(console.time){console.time("["+this.params.name+"] "+b)
}},timeEnd:function(b){if(!this.params.output){return
}if(console.timeEnd){console.timeEnd("["+this.params.name+"] "+b)
}}});
a.Squarespace.Debugger.lastUID={}
},"1.0",{requires:["squarespace-common"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-touch-event-listener",function(a){a.Squarespace.TouchEventListener=Class.create({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,initialize:function(b,c){this.el=b;
this.captureSettings={swipe:false,move:false,preventDefaultTouchEvents:true};
this.captureSettings=a.merge(this.captureSettings,c);
this.swipeThreshold=50;
this.swipeTimeThreshold=250;
this.touchStartPoint={x:0,y:0};
this.touchEndPoint={x:0,y:0};
this.addEventHandlers()
},addEventHandlers:function(){this.touchStartHandler=a.bind(this.onTouchStart,this);
this.touchMoveHandler=a.bind(this.onTouchMove,this);
this.touchEndHandler=a.bind(this.onTouchEnd,this);
this.el.on("touchstart",this.touchStartHandler);
if(this.captureSettings.move){this.el.on("touchmove",this.touchMoveHandler)
}this.el.on("touchend",this.touchEndHandler)
},removeEventHandlers:function(){this.el.detachAll()
},getTouchPoint:function(b){return{x:b[0].pageX,y:b[0].pageY}
},fireTouchEvent:function(i){var h,c=0,b=0,j=0,f,d,g;
c=this.touchEndPoint.x-this.touchStartPoint.x;
b=this.touchEndPoint.y-this.touchStartPoint.y;
j=Math.sqrt((c*c)+(b*b));
if(this.captureSettings.swipe){d=new Date();
g=d-this.touchStartTime;
if(g<=this.swipeTimeThreshold){if(window.Math.abs(c)>=this.swipeThreshold){a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,point:this.touchEndPoint,action:(c<0)?a.Squarespace.TouchEventListener.ActionTypes.swipeLeft:a.Squarespace.TouchEventListener.ActionTypes.swipeRight,targetEl:i.target,currentTargetEl:i.currentTarget,touchEvent:i});
return
}if(window.Math.abs(b)>=this.swipeThreshold){a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,point:this.touchEndPoint,action:(b<0)?a.Squarespace.TouchEventListener.ActionTypes.swipeUp:a.Squarespace.TouchEventListener.ActionTypes.swipeDown,targetEl:i.target,currentTargetEl:i.currentTarget,touchEvent:i});
return
}}}if(j>1){a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,action:a.Squarespace.TouchEventListener.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:i.target,currentTargetEl:i.currentTarget,touchEvent:i});
return
}else{a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,action:a.Squarespace.TouchEventListener.ActionTypes.tapped,point:this.touchEndPoint,targetEl:i.target,currentTargetEl:i.currentTarget,touchEvent:i});
return
}},onTouchStart:function(d){if(this.captureSettings.preventDefaultTouchEvents){d.preventDefault()
}var b=d,c=b.touches;
this.touchStartTime=new Date();
this.touchStartPoint=this.getTouchPoint(c);
a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,action:a.Squarespace.TouchEventListener.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:d.target,currentTargetEl:d.currentTarget,touchEvent:d})
},onTouchMove:function(d){if(this.captureSettings.preventDefaultTouchEvents){d.preventDefault()
}var b=d,c=b.touches;
a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,action:a.Squarespace.TouchEventListener.ActionTypes.touchMove,point:this.getTouchPoint(c),targetEl:d.target,currentTargetEl:d.currentTarget,touchEvent:d})
},onTouchEnd:function(d){if(this.isGesture&&this.captureSettings.gesture){return
}if(this.captureSettings.preventDefaultTouchEvents){d.preventDefault()
}var b=d,c=(b.changedTouches)?b.changedTouches:b.touches;
this.touchEndPoint=this.getTouchPoint(c);
a.fire("squarespace:ontouch",{type:a.Squarespace.TouchEventListener.Types.onTouch,target:this,action:a.Squarespace.TouchEventListener.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:d.target,currentTargetEl:d.currentTarget,touchEvent:d});
this.fireTouchEvent(d)
}});
a.Squarespace.TouchEventListener.Types={onTouch:"onTouch"};
a.Squarespace.TouchEventListener.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",tapped:"tapped"}
});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-gallery-ng",function(){Y.Squarespace.Widgets.Gismo=Y.Base.create("Gismo",Y.Squarespace.Widgets.SSWidget,[Y.Squarespace.GismoBase]);
Y.Squarespace.Gallery2=Y.Base.create("Gallery",Y.Squarespace.Widgets.Gismo,[],{initializer:function(){this._debugger=new Y.Squarespace.Debugger({name:"Gallery2",output:false,uid:true});
Y.Squarespace.GalleryManager.registerGallery(this);
this.get("slides").each(function(c){if(!c.getAttribute("data-type")){c.setAttribute("data-type",c.one(".sqs-video-wrapper")?"video":"image")
}});
this._loadByItemId();
this.plug(this.get("design"),this.get("designOptions"));
this.bindUI();
this.get("container").plug(Y.Squarespace.NodeDestroyNotifier,{onDestroy:function(){this.destroy()
},context:this});
this.get("container").setData("gallery",this)
},destructor:function(){if(this._autoplayHandle){this._autoplayHandle.cancel()
}if(this._wrapperEl){this.get("slides").each(function(c){this.get("container").append(c)
},this);
this._wrapperEl.remove()
}this.get("container").clearData("gallery")
},bindUI:function(){this._flushEvents("refreshOnResize");
if(this.get("refreshOnResize")){if(!this.get("resizeEmitter")){this.set("resizeEmitter",new Y.Squarespace.ResizeEmitter({timeout:100}))
}this._event(this.get("resizeEmitter").on("resize:end",function(){this.refresh()
},this),"refreshOnResize")
}if(this.get("keyboard")){var c=Y.bind(function(){if(this.get("inMotion")){return false
}var e=Y.Squarespace.GalleryManager.getGalleries();
var j=this.get("container").inRegion(Y.one(Y.config.win).get("region"));
var h=true;
var f=false;
for(var g=0;
g<e.length;
g++){var d=e[g];
if(d==this){f=h
}else{if(d.get("container").inRegion(Y.one(Y.config.win).get("region"))){h=false
}}}if(!j){return false
}else{if(h){return true
}else{return f
}}},this);
if(this.get("keys.previous")){this._event(Y.on("key",function(d){if(!c.call(this)){return
}d.preventDefault();
this.previousSlide()
},window,this.get("keys.previous"),this),"keyboard")
}if(this.get("keys.next")){this._event(Y.on("key",function(d){if(!c.call(this)){return
}d.preventDefault();
this.nextSlide()
},window,this.get("keys.next"),this),"keyboard")
}}this._bindUIAutoplay();
this.after("autoplayChange",this._bindUIAutoplay,this);
this.after("autoplayOptionsChange",this._bindUIAutoplay,this);
this._bindUIElements();
this.after("elementsChange",this._bindUIElements,this);
this.fire("bindUI")
},syncUI:function(){var c=this.get("slides").filter("."+this.getProperty("ACTIVE_CLASS"));
c.removeClass(this.getProperty("ACTIVE_CLASS"));
c.each(function(e){this.setVideoState(e)
},this);
var d=this._currentSlide();
if(d){d.addClass(this.getProperty("ACTIVE_CLASS"))
}if(!this.get("loop")){if(this.get("elements.next")){if(this.get("currentIndex")>=(this.get("numberOfSlides")-1)){this.get("elements.next").addClass(this.getProperty("DISABLED_PAGINATION_CLASS"))
}else{this.get("elements.next").removeClass(this.getProperty("DISABLED_PAGINATION_CLASS"))
}}if(this.get("elements.previous")){if(this.get("currentIndex")<=0){this.get("elements.previous").addClass(this.getProperty("DISABLED_PAGINATION_CLASS"))
}else{this.get("elements.previous").removeClass(this.getProperty("DISABLED_PAGINATION_CLASS"))
}}}if(this.get("elements.currentIndex")){this.get("elements.currentIndex").setContent(this.get("currentIndex")+1)
}if(this.get("elements.totalSlides")){this.get("elements.totalSlides").setContent(this.get("numberOfSlides"))
}this.fire("syncUI")
},refresh:function(){this.syncUI();
if(this.get("lazyLoad")){this.get("container").all("img[data-image]").each(function(c){if(c.getAttribute("src")&&c.loader){c.loader.set("load",true);
c.fire("refresh")
}},this)
}else{this.get("container").all("img[data-image]").each(function(c){c.fire("refresh")
},this)
}this._slidesByType("video").each(function(c){c.one(".sqs-video-wrapper").videoloader.refresh()
});
this.fire("refresh")
},refreshContentMode:function(d){var c=this.get("container");
c.all("img[data-image]").filter(function(e){return !Y.one(e).ancestor(".sqs-video-wrapper")
}).each(function(e){e.loader.set("mode",d)
});
c.all(".sqs-video-wrapper").each(function(e){e.videoloader.set("mode",d)
})
},loadItems:function(){var c=this.get("loaderOptions");
this._slidesByType("video").each(function(e){e.one(".sqs-video-wrapper").plug(Y.Squarespace.VideoLoader,{mode:this.get("loaderOptions.mode")})
},this);
var d=this.get("container").all("img[data-image]").filter(function(e){return !Y.one(e).ancestor(".sqs-video-wrapper")
});
if(this.get("lazyLoad")){d.plug(Y.Squarespace.Loader2,Y.merge(c,{load:"viewport"}))
}else{d.plug(Y.Squarespace.Loader2,c);
this._loadImages(d);
this._slidesByType("video-thumbnail").each(function(e){var f=e.all("img");
f.plug(Y.Squarespace.Loader2,c);
this._loadImages(f)
},this)
}this.fire("loadItems")
},previousSlide:function(d){if(d){d.preventDefault()
}var f=this._currentSlide();
this.setVideoState(f);
var c=this.get("currentIndex")-1;
if(c<0&&!this.get("loop")){return
}this.set("currentIndex",c%this.get("numberOfSlides"),{direction:-1})
},nextSlide:function(d){if(d){d.preventDefault()
}var f=this._currentSlide();
this.setVideoState(f);
var c=this.get("currentIndex")+1;
if(c>=this.get("numberOfSlides")&&!this.get("loop")){return
}this.set("currentIndex",c%this.get("numberOfSlides"),{direction:1})
},renderWrapper:function(){if(this._wrapperEl){return
}var c=Y.Node.create('<div class="sqs-wrapper"></div>');
this.get("slides").each(function(d){c.append(d)
},this);
this._wrapperEl=c;
this.get("container").append(this._wrapperEl)
},addChild:function(c){var d=this.get("linkedGalleries");
var e=Y.bind(function(g){if(g.calledFromSync){return
}for(var f=0;
f<d.length;
f++){if(g.calledFromChild!=d[f]){d[f].set("currentIndex",this.get("currentIndex"),{calledFromSync:true})
}}},this);
if(!this._linkedGalleryBinding){this._linkedGalleryBinding=this.after("currentIndexChange",function(f){e(f)
},this)
}if(this.get("keyboard")){c.set("keyboard",false)
}c.after("currentIndexChange",function(f){if(!f.calledFromSync){this.set("currentIndex",f.newVal,{calledFromChild:c})
}},this);
d.push(c);
c.get("linkedGalleries").push(this);
c.syncUI()
},setVideoState:function(c){if(this._slideType(c)!="video"){return
}var d=c.one(".sqs-video-wrapper").videoloader;
if(d.get("overlay")){d.unload()
}else{if(d.get("apiFriendly")){d.pause()
}else{if(["object","iframe"].indexOf(d.get("type"))!=-1){d.reload()
}}}},_bindUIAutoplay:function(){var h=this.get("autoplay");
if(this._autoplayHandle){this._autoplayHandle.cancel();
this._flushEvents("autoplay")
}if(h){var d=false;
this._autoplayHandle=Y.later(this.get("autoplayOptions.timeout"),this,function(){if(!!d){return
}if(this.get("autoplayOptions.interval")){var i=Math.ceil(Math.random()*this.get("numberOfSlides"));
while(i==this.get("currentIndex")){this.set("currentIndex",i)
}}else{this.nextSlide()
}},null,true);
var g=[this.get("container"),this.get("elements.previous"),this.get("elements.next")];
if(this.get("autoplayOptions.pauseOnMouseover")){var c=this.get("autoplayOptions.pauseOnMouseover");
for(var e=0;
e<c.length;
e++){g.push(Y.one(c[e]))
}}for(var e=0;
e<g.length;
e++){var f=g[e];
if(Y.Lang.isString(f)){f=this.get(f)
}if(f){this._event(f.on(["mouseenter","mousemove"],function(){d=true
}),"autoplay");
this._event(f.on("mouseout",function(){d=false
}),"autoplay")
}}}},_bindUIElements:function(){var c=Y.bind(function(e){for(var d=0;
d<e.length;
d++){element=e[d];
this._flushEvents("controls-"+element);
if(this.get("elements."+element)){this._event(this.get("elements."+element).on("click",this[element+"Slide"],this),"controls-"+element)
}}},this);
c(["previous","next"]);
this._flushEvents("controls-controls");
if(this.get("elements.controls")){this.get("elements.controls").each(function(e){var d=e.get("children");
d.each(function(f,g){this._event(f.on("click",function(){this.set("currentIndex",g)
},this),"controls-controls")
},this);
this.after("currentIndexChange",function(f){d.filter("."+this.getProperty("ACTIVE_CLASS")).removeClass(this.getProperty("ACTIVE_CLASS"));
d.item(f.newVal).addClass(this.getProperty("ACTIVE_CLASS"))
});
d.item(this.get("currentIndex")).addClass(this.getProperty("ACTIVE_CLASS"))
},this)
}},_loadByItemId:function(){this._history=new Y.HistoryHash();
if(this.get("historyHash")){this.on("currentIndexChange",function(f){this._history.replaceValue(this.get("historyHash"),f.newVal)
},this)
}if(this.get("historyHash")||this._history.get("itemId")){var d=this._history.get("itemId")||this._history.get(this.get("historyHash"));
var c;
if(d){this.get("slides").each(function(e,f){if(e.getAttribute("data-slide-id")==d){c=f
}})
}if(!Y.Lang.isNumber(c)){c=parseInt(this._history.get(this.get("historyHash")),10)
}if(!!this._history.get("itemId")){this._history.replaceValue("itemId",null)
}if(Y.Lang.isNumber(c)){this.set("currentIndex",c)
}}},_currentSlide:function(){return this.get("slides").item(this.get("currentIndex"))
},_slidesByType:function(c){return this.get("slides").filter('[data-type="'+c+'"]')
},_slideType:function(c){if(c.getAttribute("data-type")=="image"){return"image"
}else{if(c.getAttribute("data-type")=="video"){return"video"
}else{return"image"
}}},_getContainer:function(c){if(Y.Lang.isString(c)){c=Y.one(c)
}return c
},_cleanCurrentIndex:function(c){if(c<0){c=this.get("numberOfSlides")+c
}return c%this.get("numberOfSlides")
},_getDesign:function(d){var c=a[d];
if(!c){throw Error("These aren't the gallery designs you're looking for. (We couldn't find a design by the name '"+d+"')")
}return c
},_getElements:function(d){for(var c in d){if(!(d[c] instanceof Y.NodeList)){d[c]=Y.all(d[c])
}}return d
},_setElements:function(c,d){this._bindUIElements()
},_setLoaderOptions:function(c){if(c.hasOwnProperty("fit")&&c.fit){c.mode="fit"
}else{if(c.hasOwnProperty("fill")&&c.fill){c.mode="fill"
}}return c
},_getNumberOfSlides:function(){return this.get("slides").size()
},_getSlides:function(d){var c=this._wrapperEl||this.get("container");
if(!d){d=c.get("children")
}if(Y.Lang.isString(d)){d=c.all(d)
}return d
},_getWrapper:function(c){if(Y.Lang.isString(c)){c=Y.one(c)
}return c
},_validateCurrentIndex:function(c){if(this.get("inMotion")){return false
}else{for(var d=0;
d<this.get("linkedGalleries").length;
d++){var e=this.get("linkedGalleries")[d];
if(e.get("inMotion")&&c!=e.get("currentIndex")){return false
}}return true
}},_loadImages:function(c){this._event(c.on("load",function(){this.fire("image-loaded")
},this));
c.each(function(d){if(d.loader){d.loader.set("load",true);
d.fire("refresh")
}})
}},{NS:"gallery",ACTIVE_CLASS:"sqs-active-slide",DISABLED_PAGINATION_CLASS:"sqs-disabled",ATTRS:{autoplay:{value:false},autoplayOptions:{value:{randomize:true,timeout:5000,pauseOnMouseover:[]}},container:{getter:"_getContainer"},currentIndex:{value:0,getter:"_cleanCurrentIndex",setter:"_cleanCurrentIndex",validator:"_validateCurrentIndex"},design:{value:"base",getter:"_getDesign"},designOptions:{value:{}},elements:{value:{next:null,previous:null,currentIndex:null,totalSlides:null,controls:null},getter:"_getElements",setter:"_setElements",lazyAdd:false},historyHash:{},inMotion:{value:false},keyboard:{value:true},keys:{value:{previous:"down:37",next:"down:39"}},lazyLoad:{value:false,},linkedGalleries:{value:[]},loaderOptions:{value:{},setter:"_setLoaderOptions"},loop:{value:false},numberOfSlides:{getter:"_getNumberOfSlides"},refreshOnResize:{value:false},resizeEmitter:{value:null},slides:{getter:"_getSlides"}}});
var a={};
a.base=Y.Base.create("GalleryDesignBase",Y.Plugin.Base,[Y.Squarespace.GismoBase],{initializer:function(){this.get("host").after("currentIndexChange",function(){this.get("host").syncUI()
},this);
this.get("host").after("loadItems",this.loadItems,this);
this.get("host").loadItems();
this.get("host").syncUI();
if(this.get("host").get("lazyLoad")){this.loadHandler=Y.one(Y.config.win).on("scroll",function(){this.loadItems()
},this)
}},destructor:function(){if(this.loadHandler){this.loadHandler.detach()
}},loadItems:function(){var d=this.get("host");
if(d.get("lazyLoad")){var c=d.get("container").all("img[data-image]");
var e=c.filter(function(f){return(Y.one(f).inRegion(Y.one(Y.config.win).get("region")))
});
d._loadImages(e)
}},_getProperty:function(c){return this.constructor[c]
}},{NS:"gallery-design",ATTRS:{}});
a.stacked=Y.Base.create("GalleryDesignStacked",Y.Plugin.Base,[Y.Squarespace.GismoBase],{initializer:function(){var c=this.get("host");
this.enableSimpleCaption=(Modernizr&&Modernizr.touch&&c.get("container").get("offsetWidth")<500);
c.get("container").addClass(this._getProperty("CONTAINER_CLASS"));
c.get("slides").addClass(this._getProperty("SLIDE_CLASS"));
this.plug(this.get("transition"),this.get("transitionOptions"));
c.after("currentIndexChange",this.syncUI,this);
c.after("refresh",this.syncUI,this);
c.after("loadItems",this.loadItems,this);
c.loadItems();
if(this.get("autoHeight")){c.after("syncUI",function(){this._evaluateHeight(true)
},this);
this._evaluateHeight(true)
}c._slidesByType("video").each(function(d){d.one(".sqs-video-wrapper").videoloader.set("mode","fill")
});
if(this.enableSimpleCaption){c.refreshContentMode("fit")
}this.bindUI();
this.syncUI()
},destructor:function(){if(this.get("autoHeight")){this.get("host").get("container").setStyles({height:null})
}this.get("host").get("slides").each(function(c){c.setStyles({opacity:null});
c.removeClass(this._getProperty("SLIDE_CLASS"))
},this)
},bindUI:function(){if(this.get("clickBehavior")){this._event(this.get("host").get("container").on("click",function(g){if(g.target.ancestor("a",true)){return
}var c=g.target.ancestor(".slide");
if(c&&!!c.getAttribute("data-click-through-url")){window.location.href=c.getAttribute("data-click-through-url");
g.preventDefault();
return
}if(this.get("host")._slideType(this.get("host")._currentSlide())!="video"){switch(this.get("clickBehavior")){case"next":this.get("host").nextSlide();
break;
case"previous":this.get("host").previousSlide();
break;
default:var f=this.get("host").get("container").get("region");
var d=(f.width/2)+f.left;
if(g.pageX>d){this.get("host").nextSlide()
}else{this.get("host").previousSlide()
}break
}}g.preventDefault()
},this))
}},loadItems:function(){var d=this.get("host");
if(d.get("lazyLoad")){var g=d.get("currentIndex")-this.get("preloadCount"),f=(d.get("currentIndex")+this.get("preloadCount")+1)%d.get("slides").size(),c=d.get("container").all("img[data-image]"),e=new Y.NodeList();
if(g<0){e=e.concat(c.slice(g));
e=e.concat(c.slice(d.get("currentIndex"),f))
}else{e=c.slice(g,f)
}d._loadImages(e)
}},syncUI:function(c){this.get("host").syncUI();
this.fire("transition",c||{newVal:this.get("host").get("currentIndex")});
this._positionMetaOverlay();
this.loadItems()
},_positionMetaOverlay:function(){var c=this.get("host").get("slides").item(this.get("host").get("currentIndex"));
var f=c.one(".meta");
var h=c.one("img");
var d=this.get("host").get("container");
if(!h){h=c
}var g=h.ancestor(".sqs-video-wrapper",true);
if(g){h=c;
g.videoloader.on("loadedChange",function(i){c[i.newVal?"addClass":"removeClass"]("video-playing")
})
}if(f&&h){var e=d.getAncestorData("galleryOptions");
if(e){switch(e["meta-position"]||"bottom"){case"top":case"bottom":f.setStyles({left:h.get("offsetLeft"),width:h.get("offsetWidth")});
break;
case"top-left":case"bottom-left":f.setStyles({left:h.get("offsetLeft"),maxWidth:h.get("offsetWidth")/2});
break;
case"top-right":case"bottom-right":f.setStyles({right:c.get("offsetWidth")-(h.get("offsetLeft")+h.get("offsetWidth")),maxWidth:h.get("offsetWidth")/2});
break;
case"center":f.setStyles({maxWidth:h.get("offsetWidth")/2});
f.setStyles({marginLeft:f.get("offsetWidth")/-2,marginTop:f.get("offsetHeight")/-2});
break
}}}if(this.enableSimpleCaption){this._fixMetaOverlayPosition()
}else{if(f&&(f.get("offsetHeight")/d.get("offsetHeight")>0.9)){f.setStyles({height:d.get("offsetHeight")/2}).addClass("overflow")
}}},_evaluateHeight:function(g){function f(j){var l=0;
for(var k=0;
k<j.length;
k++){l+=j[k]
}return l/j.length
}if(!this._heightEvaluated||g){var h=[];
this.get("host").get("slides").each(function(i){switch(this.get("host")._slideType(i)){case"image":var m=i.test("img")?i:i.one("img");
if(m){var j=Y.Squarespace.Rendering.getDimensionsFromNode(m);
var l=Y.Squarespace.Rendering.getHeightForWidth(j.width,j.height,i.get("offsetWidth"));
if(!isNaN(l)){h.push(l)
}}else{this.get("host")._debugger.log("_evaluateHeight","Couldnt evaluate height for slide.")
}break;
case"video":var k=Y.Squarespace.Rendering.getHeightForWidth(i.one(".sqs-video-wrapper").videoloader.getWidth(),i.one(".sqs-video-wrapper").videoloader.getHeight(),i.get("offsetWidth"));
if(!isNaN(k)){h.push(k)
}break
}},this);
if(h.length!==0){var e=Math.min.apply(Math.min,h);
var d=Math.max.apply(Math.max,h);
var c=f(h);
this.get("host").get("container").setStyles({height:e});
this.get("host")._debugger.log("_evaluateHeight",e);
this.get("host").get("container").all("img[data-image]").each(function(i){i.fire("refresh")
});
this._heightEvaluated=true
}}},_fixMetaOverlayPosition:function(){var c=this.get("host").get("slides").item(this.get("host").get("currentIndex")),e=c.one(".meta"),d=this.get("host").get("container");
if(e){d.addClass("mobile-view").setStyles({height:d.get("clientHeight")+e.get("offsetHeight")})
}},_getProperty:function(c){return this.constructor[c]
},_getTransition:function(c){c=b[c];
if(!c){throw Error("These aren't the gallery stacked transitions you're looking for. (We couldn't find a transition by the name "+c+" )")
}return c
}},{NS:"gallery-design",CONTAINER_CLASS:"sqs-gallery-design-stacked",SLIDE_CLASS:"sqs-gallery-design-stacked-slide",ATTRS:{autoHeight:{value:true},clickBehavior:{value:"next"},easing:{value:Y.Easing.easeOutStrong},speed:{value:0.3},preloadCount:{value:7},transition:{value:"fade",getter:"_getTransition"},transitionOptions:{value:{}}}});
a.strip=Y.Base.create("GalleryDesignBase",Y.Plugin.Base,[Y.Squarespace.GismoBase],{initializer:function(){var d=this.get("host");
d.get("container").addClass(this._getProperty("CONTAINER_CLASS"));
d.get("slides").addClass(this._getProperty("SLIDE_CLASS"));
this._event(d.on("image-loaded",this.syncUI,this));
d.loadItems();
var c=d.get("container").get("offsetHeight");
d._slidesByType("video").each(function(e){var f=e.one(".sqs-video-wrapper").videoloader.getWidth()/e.one(".sqs-video-wrapper").videoloader.getHeight();
e.one(".sqs-video-wrapper").setStyle("paddingRight",f*c);
if(e.one("img")){e.one("img").refresh()
}});
d.renderWrapper();
d.after("currentIndexChange",this.syncUI,this);
d.after("loadItems",this.loadItems,this);
this.syncUI();
this.bindUI()
},destructor:function(){this.get("host").get("container").removeClass(this._getProperty("CONTAINER_CLASS"));
this.get("host").get("slides").removeClass(this._getProperty("SLIDE_CLASS"))
},bindUI:function(){var d=this.get("host")._currentSlide();
this.get("host").get("slides").each(function(e,g){var f=this.get("host")._slideType(e);
if(f=="video"&&e!=d){e.one(".sqs-video-wrapper").videoloader.set("inactive",true)
}this._event(e.on("click",function(l){if(f=="video"&&!e.one(".sqs-video-wrapper").videoloader.get("inactive")){return
}var j=l.target.getAttribute("data-click-through-url");
if(!!j){window.location.href=j
}var m=this.get("host")._currentSlide();
var k=this.get("host")._slideType(m);
if(g==this.get("host").get("currentIndex")){switch(this.get("activeSlideClickBehavior")){case"next":this.get("host").nextSlide();
break;
case"previous":this.get("host").previousSlide();
break;
default:this.get("host").set("currentIndex",g);
break
}}else{this.get("host").set("currentIndex",g)
}var i=this.get("host")._currentSlide();
var h=this.get("host")._slideType(i);
if(m!=i){if(h=="video"){i.one(".sqs-video-wrapper").videoloader.set("inactive",false);
if(i==e){i.one(".sqs-video-wrapper").videoloader.load()
}}if(k=="video"){m.one(".sqs-video-wrapper").videoloader.set("inactive",true)
}}},this))
},this);
this.get("host").on("currentIndexChange",function(i){var g=this.get("host").get("slides");
if(i.newVal<0){i.newVal=g.size()-1
}var f=g.item(i.prevVal);
var h=g.item(i.newVal);
if(this.get("host")._slideType(f)=="video"){f.one(".sqs-video-wrapper").videoloader.set("inactive",true)
}if(this.get("host")._slideType(h)=="video"){h.one(".sqs-video-wrapper").videoloader.set("inactive",false)
}},this);
var c=this.get("host").get("slides").item(this.get("currentIndex")||0);
if(c){c.addClass(this._getProperty("SLIDE_CLASS"))
}},loadItems:function(){var d=this.get("host");
if(d.get("lazyLoad")){var g=d.get("currentIndex")-this.get("preloadCount"),f=(d.get("currentIndex")+this.get("preloadCount")+1)%d.get("slides").size(),c=d.get("container").all("img[data-image]"),e=new Y.NodeList();
if(g<0){e=e.concat(c.slice(g));
e=e.concat(c.slice(d.get("currentIndex"),f))
}else{e=c.slice(g,f)
}d._loadImages(e)
}},syncUI:function(h){if(!h||!h.calledFromParent){this.get("host").syncUI()
}if(this.get("host").get("container").hasClass("sqs.gallery-thumbnails")){var f=this.get("host").get("container");
var l=f.get("offsetHeight");
f.all(".sqs-video-thumbnail").each(function(e){if(e.hasClass("no-image")){e.one(".sqs-video-thumbnail-inner").setStyles({width:Math.floor(l*(16/9))+"px"})
}var m=e.one("img");
if(m){e.removeClass("loading");
e.setAttribute("style","width: "+m.get("offsetWidth")+"px !important")
}})
}var j=this.get("host")._wrapperEl;
j.setStyles({width:null});
var d=0;
var c=0;
this.get("host").get("slides").each(function(e,m){if(this.get("host").get("currentIndex")>m){c+=e.get("offsetWidth")
}d+=e.get("offsetWidth")
},this);
var i=this.get("host").get("container").get("offsetWidth");
var g=this.get("host")._currentSlide();
switch(this.get("alignment")){case"start":break;
case"middle":c-=(i-g.get("offsetWidth"))/2;
if(c<0){c=0
}break;
case"end":c-=(i-g.get("offsetWidth"));
if(c<0){c=0
}break
}if(d<i){c=(i-d)/-2
}else{if(c>(d-i)){c=(d-i)
}}j.setStyles({width:d*2});
var k=this;
this._anim(j,{left:-1*c},{duration:this.get("speed"),easing:this.get("easing"),start:function(){k.get("host").set("inMotion",true)
},end:function(){k.get("host").set("inMotion",false)
}}).run();
this.loadItems()
},_getProperty:function(c){return this.constructor[c]
}},{NS:"gallery-design",CONTAINER_CLASS:"sqs-gallery-design-strip",SLIDE_CLASS:"sqs-gallery-design-strip-slide",ATTRS:{speed:{value:0.3},easing:{value:Y.Easing.easeOutStrong},activeSlideClickBehavior:{value:"next"},preloadCount:{value:7},alignment:{value:"middle",validator:function(c){return["start","middle","end"].indexOf(c)!=-1
}}}});
a.grid=Y.Base.create("GalleryDesignGrid",Y.Plugin.Base,[Y.Squarespace.GismoBase],{initializer:function(){var c=this.get("host");
c.get("container").addClass(this._getProperty("CONTAINER_CLASS"));
c.get("slides").addClass(this._getProperty("SLIDE_CLASS"));
c.after("loadItems",this.loadItems,this);
c.get("slides").each(function(d){var e=c._slideType(d);
if(e=="image"){d.all("img[data-image]").each(function(f){f.setStyles({opacity:0});
this._event(f.once("load",function(){this._timer(Y.later(Math.random()*500,this,function(){var h=this._anim(f,{opacity:1},{duration:1});
if(!this.get("destroyed")&&h.get("node").inDoc()){var g=Y.DOM.viewportRegion();
if(h.get("node").inRegion(g)){h.run()
}else{f.setStyles({opacity:null})
}}}))
},this))
},this)
}else{if(e=="video"){d.all(".sqs-video-wrapper").each(function(f){f.setStyles({opacity:0});
var g=this._anim(f,{opacity:1},{duration:1});
this._timer(Y.later(Math.random()*500,this,function(){g.run()
}))
},this)
}}},this);
c.loadItems();
c._slidesByType("video").each(function(f){var d=f.one(".sqs-video-wrapper");
var e=d.videoloader;
if(this.get("lightbox")){e.set("inactive",true)
}if(f.one(".content-fit")){e.set("mode","fit")
}else{e.set("mode","fill")
}},this);
this.bindUI();
if(this.get("host").get("lazyLoad")){this.loadHandler=Y.one(Y.config.win).on("scroll",function(){this.loadItems()
},this)
}},destructor:function(){this.get("host").get("container").removeClass(this._getProperty("CONTAINER_CLASS"));
this.get("host").get("slides").removeClass(this._getProperty("SLIDE_CLASS"));
if(this.loadHandler){this.loadHandler.detach()
}},bindUI:function(){if(!this.get("lightbox")){return
}this.get("host")._slidesByType("video").each(function(e){var d=e.one(".sqs-video-wrapper").videoloader.get("overlay");
if(d){d.detach("click")
}});
var c=[];
this.get("host").get("slides").each(function(d,h){if(this.get("host")._slideType(d)=="video"){c.push({content:d.one(".sqs-video-wrapper")})
}else{if(!d.hasAttribute("data-title")&&!d.hasAttribute("data-description")){var e=d.one("[data-title],[data-description]");
if(e){d=e
}}var g=d.getAttribute("data-title");
var f=d.getAttribute("data-description");
c.push({content:d.one("img"),meta:(g?"<h1>"+g+"</h1>":"")+(f?f:"")})
}},this);
this.get("host").get("slides").on("click",function(d){d.halt();
var f=d.target.ancestor("."+this._getProperty("SLIDE_CLASS"));
if(!f){return
}if(this.lightbox){this.lightbox.destroy();
delete this.lightbox
}this.lightbox=new Y.Squarespace.Lightbox2({controls:{previous:true,next:true},set:c,currentSetIndex:this.get("host").get("slides").indexOf(d.target.ancestor("."+this._getProperty("SLIDE_CLASS",true)))});
this.lightbox.render()
},this)
},loadItems:function(){var d=this.get("host");
if(d.get("lazyLoad")){var c=d.get("container").all("img[data-image]");
var e=c.filter(function(f){return(Y.one(f).inRegion(Y.one(Y.config.win).get("region")))
});
d._loadImages(e)
}},_getProperty:function(c){return this.constructor[c]
}},{NS:"gallery-design",CONTAINER_CLASS:"sqs-gallery-design-grid",SLIDE_CLASS:"sqs-gallery-design-grid-slide",ATTRS:{lightbox:{value:true},perRow:{value:4}}});
var b={};
b.base=Y.Base.create("GalleryDesignStackedTransition",Y.Plugin.Base,[Y.Squarespace.GismoBase],{baseZIndex:888,initializer:function(){this.get("host").get("host").get("slides").setStyles({opacity:0,zIndex:this.baseZIndex});
if(Y.UA.ie){this.get("host").get("host").get("slides").setStyles({visibility:"hidden"})
}this.get("host").on("transition",this.transition,this)
},_getProperty:function(c){return this.constructor[c]
}},{NS:"gallery-stacked-transition"});
b.fade=Y.Base.create("GalleryDesignStackedTransition",b.base,[],{transition:function(h){this.get("host").get("host").set("inMotion",true);
var j;
var d=h.newVal||this.get("host").get("host").get("currentIndex");
var g=[];
this.get("host").get("host").get("slides").each(function(e,i){if(i==d){j=e
}else{g.push(e)
}},this);
if(!!j){j.setStyles({visibility:null,zIndex:this.baseZIndex+1});
this._anim(j,{opacity:1},{duration:this.get("host").get("speed"),easing:this.get("host").get("easing"),end:Y.bind(function(){this.get("host").get("host").set("inMotion",false)
},this)}).run()
}var c=this;
for(var f=0;
f<g.length;
f++){this._anim(g[f],{opacity:0},{duration:this.get("host").get("speed"),end:function(){if(!this.get("node").hasClass(c.get("host").get("host").getProperty("ACTIVE_CLASS"))){this.get("node").setStyles({visibility:"hidden",zIndex:null})
}}}).run()
}}},{NS:"gallery-stacked-transition"});
b.scroll=Y.Base.create("GalleryDesignStackedTransition",b.base,[],{initializer:function(){this.galleryHost=this.get("host").get("host");
this.container=this.galleryHost.get("container");
this.slides=this.galleryHost.get("slides");
this.container.addClass(this._getProperty("CONTAINER_CLASS"));
this.slides.setStyle("opacity",0);
this._adjustPosition(this.slides,this._getContainerDim());
this._event((new Y.Squarespace.ResizeEmitter({timeout:100})).on("resize",function(){var c=this.galleryHost.get("slides");
c.splice(this.galleryHost.get("currentIndex"),1);
this._adjustPosition(c,this._getContainerDim())
},this));
if(Modernizr&&Modernizr.touch){this.touchListener=null,this.touchStartPoint=null,this.touchState={from:null,to:null},this.skipTransition=false,this.haltSliding=false;
this.touchListener=new Y.Squarespace.TouchEventListener(this.container,{move:true,swipe:true,preventDefaultTouchEvents:this.get("preventDefaultTouchEvents")});
Y.on("squarespace:ontouch",function(c){this._onTouch(c)
},this)
}},destructor:function(){this.container.removeClass(this._getProperty("CONTAINER_CLASS"));
if(this.touchListener){this.touchListener.removeEventHandlers()
}this._flushEvents()
},transition:function(g){if(this.skipTransition){return
}var h;
var d;
var c=[];
this.slides.each(function(e,i){if(i==g.newVal){h=e
}else{if(Y.Lang.isNumber(g.prevVal)&&i==g.prevVal){d=e
}else{c.push(e)
}}},this);
var f=(g&&g.direction)?g.direction:this._getDirection(g.prevVal,g.newVal);
if(!Y.Lang.isNumber(g.prevVal)){h.setStyle("opacity",1);
this._adjustPosition(h,0)
}else{h.setStyle("opacity",1);
this._adjustPosition(h,0,f*this._getContainerDim(),true)
}if(Y.UA.ie>0){h.setStyle("visibility",null)
}if(d){d.setStyle("opacity",1);
this._adjustPosition(d,-1*f*this._getContainerDim(),null,true)
}},_getOffsetAttribute:function(){return this.get("direction")=="horizontal"?"offsetWidth":"offsetWidth"
},_getContainerDim:function(){return this.get("host").get("host").get("container").get(this._getOffsetAttribute())
},_getDirection:function(d,c){if(d<c){return 1
}else{return -1
}},_onTouch:function(d){var c=this.get("host").get("host").get("container");
if(d.touchEvent.touches.length>1||this.touchZoom){this._handlePanning(d)
}else{if(c.contains(d.targetEl)){switch(d.action){case Y.Squarespace.TouchEventListener.ActionTypes.swipeUp:Y.fire("transition:scroll:swipeup",{container:c});
break;
case Y.Squarespace.TouchEventListener.ActionTypes.swipeDown:Y.fire("transition:scroll:swipedown",{container:c});
break;
case Y.Squarespace.TouchEventListener.ActionTypes.tapped:Y.fire("transition:scroll:tapped",d);
break;
case Y.Squarespace.TouchEventListener.ActionTypes.touchStart:this.touchStartPoint=d.point;
break;
case Y.Squarespace.TouchEventListener.ActionTypes.touchMove:this._scrollByDistance(d.point);
break;
case Y.Squarespace.TouchEventListener.ActionTypes.touchEnd:this._finishScroll(d.point);
break
}}}},_handlePanning:function(g){if(!g.targetEl.get("tagName").match(/img/i)){return
}if(g.touchEvent.touches.length>1){this.prevScale=this.prevScale||1;
this.touchScale=this.prevScale*g.touchEvent.scale;
if(this.touchScale>=1){this.touchZoom=true;
g.targetEl.setStyles({webkitTransform:"scale3d("+this.touchScale+","+this.touchScale+",1)"});
var f=g.targetEl.getAttribute("src").split("?format=");
if(f.length>1){g.targetEl.setAttribute("src",f[0])
}}else{this.touchZoom=false;
this.touchStartPoint=null;
g.targetEl.setStyles({webkitTransform:"scale3d(1,1,1)",left:null,top:null});
ImageLoader.load(g.targetEl,{load:true})
}}else{if(g.action==Y.Squarespace.TouchEventListener.ActionTypes.tapped){Y.fire("transition:scroll:tapped",g)
}else{if(this.touchZoom&&g.action==Y.Squarespace.TouchEventListener.ActionTypes.touchStart){this.touchStartPoint=g.point;
g.targetEl.setAttribute("original-left",g.targetEl.getStyle("left"));
g.targetEl.setAttribute("original-top",g.targetEl.getStyle("top"))
}else{if(g.action==Y.Squarespace.TouchEventListener.ActionTypes.touchMove){var h=g.targetEl,d=this.touchStartPoint.x-g.point.x,c=this.touchStartPoint.y-g.point.y,i=parseInt(h.getAttribute("original-left")),e=parseInt(h.getAttribute("original-top"));
h.setStyles({left:i-d+"px",top:e-c+"px"})
}else{if(g.action==Y.Squarespace.TouchEventListener.ActionTypes.touchEnd){this.prevScale=this.touchScale||1
}}}}}},_scrollByDistance:function(e){if(this.haltSliding||!this.touchStartPoint||this.slides.size()<2){return
}var d=this.get("host").get("host"),f=d.get("slides"),c=d.get("currentIndex"),h=0,g={},i={opacity:1};
if(this.get("direction")=="vertical"){h=this.touchStartPoint.y-e.y
}else{h=this.touchStartPoint.x-e.x
}d.set("inMotion",true);
this.touchState.from=f.item(c);
this._adjustPosition(this.touchState.from,-h);
if(h>0){if(c<f.size()-1){this.touchState.to=f.item(c+1)
}else{if(d.get("loop")){this.touchState.to=f.item(0)
}else{this.touchState.to=null;
this.haltSliding=true;
d.set("inMotion",false);
Y.fire("transition:scroll:reached-end");
return
}}this._adjustPosition(this.touchState.to,this._getContainerDim()-h)
}else{if(c>0){this.touchState.to=f.item(c-1)
}else{if(d.get("loop")&&c==0){this.touchState.to=f.item(f.size()-1)
}else{this.touchState.to=null;
this.haltSliding=true;
d.set("inMotion",false);
Y.fire("transition:scroll:reached-beginning");
return
}}this._adjustPosition(this.touchState.to,-this._getContainerDim()-h)
}this.touchState.from.setStyles(g);
this.touchState.to.setStyles(i)
},_finishScroll:function(d){this.haltSliding=false;
if(!this.touchState.to||!this.touchStartPoint||this.slides.size()<2){return
}var c=this.get("host").get("host"),f=0,g={},e={};
if(this.get("direction")=="vertical"){f=this.touchStartPoint.y-d.y
}else{f=this.touchStartPoint.x-d.x
}this._adjustPosition(this.touchState.to,0,null,true);
this._adjustPosition(this.touchState.from,this._getContainerDim()*(f>0?-1:1),null,true);
c.set("inMotion",false);
this.skipTransition=true;
c.set("currentIndex",c.get("slides").indexOf(this.touchState.to),{direction:(f>0?1:-1)});
this.skipTransition=false;
this.touchState.to=null
},_adjustPosition:function(e,d,i,h){var c={},f=this.get("direction"),g=Y.UA.webkit?true:false;
if(g){c.transform=f=="vertical"?"translate3d(0,"+d+"px,0)":"translate3d("+d+"px,0,0)"
}else{c[f=="vertical"?"top":"left"]=d
}if(i){if(g){e.setStyle("transform",f=="vertical"?"translate3d(0,"+i+"px,0)":"translate3d("+i+"px,0,0)")
}else{e.setStyle(f=="vertical"?"top":"left",i)
}}if(h){if(g){e.transition({duration:0.3,transform:c.transform})
}else{this._anim(e,c,{duration:0.6,easing:this.get("host").get("easing")}).run()
}}else{e.setStyles(c)
}}},{NS:"gallery-stacked-transition",CONTAINER_CLASS:"sqs-gallery-design-stacked-scrollHorz",ATTRS:{direction:{value:"horizontal"},preventDefaultTouchEvents:{value:true}}});
Y.Squarespace.Lightbox2Overlay=Y.Base.create("LightboxOverlay",Y.Squarespace.Widgets.Gismo,[],{renderUI:function(){this._overlayEl=Y.Node.create('<div class="sqs-lightbox-overlay sqs-lightbox-overlay-'+this.get("overlayStyle")+'"></div>');
this.get("contentBox").appendChild(this._overlayEl);
this.get("contentBox").plug(Y.Squarespace.ScrollLock);
this.show()
},show:function(){this._overlayEl.setStyles({zIndex:"10000000"});
var c=this._anim(this._overlayEl,{opacity:this.get("opacity")},{duration:this.get("speed")});
c.on("end",function(){this.fire("shown")
},this);
c.run()
},overlayHideAndDestroy:function(){this.once("hidden",this.destroy,this);
this._hide()
},_hide:function(){this.fire("hide");
var c=this._anim(this._overlayEl,{opacity:0},{duration:this.get("speed")});
c.on("end",function(){this.fire("hidden")
},this);
if(this.get("destroyed")){this.fire("hidden")
}else{c.run()
}},_getContainer:function(){return this._overlayEl
}},{NS:"overlay",ATTRS:{opacity:{value:0.95},overlayStyle:{value:"default"},container:{getter:"_getContainer"},speed:{value:0.3}}});
Y.Squarespace.Lightbox2=Y.Base.create("Lightbox2",Y.Squarespace.Widgets.Gismo,[],{initializer:function(){window.ACTIVE_LIGHTBOX=this;
this._overlay=new Y.Squarespace.Lightbox2Overlay();
this._overlay.on("hide",this.hideAndDestroy,this);
this.resizeEmitter=new Y.Squarespace.ResizeEmitter({timeout:100})
},destructor:function(){this._flushEvents();
this._slideshow&&this._slideshow.destroy();
this._overlay.destroy()
},renderUI:function(){Y.Squarespace.Lightbox2.superclass.renderUI.call(this);
var c=this.get("contentBox");
this._overlay.render(c);
if(this.get("set").length>0){if(!Modernizr.touch&&this.get("controls.previous")){this._previousEl=Y.Node.create('<a class="sqs-lightbox-previous"></a>');
c.appendChild(this._previousEl)
}if(!Modernizr.touch&&this.get("controls.next")){this._nextEl=Y.Node.create('<a class="sqs-lightbox-next"></a>');
c.appendChild(this._nextEl)
}}else{this.set("set",[{content:this.get("content"),meta:this.get("meta")}])
}this._slideshow=this.createSlideshow(c);
this._lightboxContentEl=this._slideshow.get("container");
if(Modernizr.touch){this.hideAddressBar();
this._metaTriggerEl=Y.Node.create('<a class="sqs-lightbox-meta-trigger">&bull;</a>').appendTo(c).hide()
}this._closeEl=Y.Node.create('<a class="sqs-lightbox-close">&times;</a>').appendTo(c).hide();
this._lightboxContentEl.plug(Y.Squarespace.Animations.Scalable);
this._lightboxContentEl.hide(true);
this._lightboxContentEl.once("shown",function(){this._lightboxContentEl.setStyles({transform:null})
},this);
this._overlay.once("shown",function(){this._lightboxContentEl.show();
this._closeEl&&this._closeEl.show();
this._metaTriggerEl&&this._metaTriggerEl.show();
var d=this._slideshow.get("slides").item(this._slideshow.get("currentIndex")).one(".sqs-video-wrapper");
if(d){d.videoloader.load()
}},this);
c.plug(Y.Squarespace.ScrollLock);
Y.Squarespace.EscManager.addTarget(this)
},bindUI:function(){Y.Squarespace.Lightbox2.superclass.bindUI.call(this);
this._slideshow.after("currentIndexChange",Y.bind(function(c){this.set("currentSetIndex",c.newVal);
this.syncUI()
},this));
this._event(this.resizeEmitter.on("resize",function(){this.syncUI()
},this),"resizeEmitter");
if(this._closeEl){this._event(this._closeEl.on("click",function(c){c.halt();
this.hideAndDestroy(true)
},this))
}if(this._metaTriggerEl){this._event(this._metaTriggerEl.on("click",function(){this.toggleMeta()
},this),"meta-trigger")
}if(this._previousEl){this._event(this._previousEl.on("click",function(c){c.halt();
this.previous()
},this),"previous-click");
this._event(Y.on("key",Y.throttle(Y.bind(function(c){c.halt();
this.previous()
},this),200),window,"down:37",this),"keyboard")
}if(this._nextEl){this._event(this._nextEl.on("click",function(c){c.halt();
this.next()
},this),"next-click");
this._event(Y.on("key",Y.throttle(Y.bind(function(c){c.halt();
this.next()
},this),200),window,"down:39",this),"keyboard");
if(!Modernizr.touch){this.setupNavigationFade()
}}this._event(this.get("contentBox").on("click",this.onContentBoxClick,this));
this._event(Y.on("transition:scroll:tapped",function(c){this.onContentBoxClick(c.touchEvent)
},this))
},onContentBoxClick:function(c){if(!c.target.ancestor("a",true)){c.halt();
if(c.target.ancestor(".sqs-video-wrapper")){c.target.ancestor(".sqs-video-wrapper").videoloader.load()
}else{if(c.target.get("tagName").match(/img/i)&&!Modernizr.touch&&this._nextEl){this.next()
}else{this.hideAndDestroy(true)
}}}else{c.stopImmediatePropagation()
}},syncUI:function(j){if(!j){j=this.get("contentBox").one(".sqs-active-slide")
}var h=j.one("img");
var f=j.one(".sqs-video-wrapper");
if(h){ImageLoader.load(h,{load:true});
if(this._slideshow){var g=this._slideshow.get("slides"),i=(j.next()||g.item(0)).one("img"),e=(j.previous()||g.item(g.size()-1)).one("img");
i&&ImageLoader.load(i,{load:true});
e&&ImageLoader.load(e,{load:true})
}}var d=j.one(".sqs-lightbox-meta")||this.createMetaEl(j);
if(d){this._metaTriggerEl&&this._metaTriggerEl.show();
if(!Modernizr.touch){var c=j.one(".sqs-lightbox-padder").get("children").item(0);
d.setStyles({bottom:c.getStyle("top"),left:c.getStyle("left"),right:c.getStyle("left")})
}else{d.appendTo(j);
d.setStyles({bottom:this.bMetaEnabled?0:"-"+(d.height()+40)+"px",left:0,right:0});
d.addClass("overlay-description-visible")
}}else{this._metaTriggerEl&&this._metaTriggerEl.hide()
}},previous:function(){this._slideshow.previousSlide()
},next:function(){this._slideshow.nextSlide()
},close:function(){this.hideAndDestroy()
},toggleMeta:function(){this.get("contentBox").all(".sqs-lightbox-meta").each(Y.bind(function(c){this.bMetaEnabled=parseInt(c.getStyle("bottom"))===0?true:false;
this._anim(c,{bottom:this.bMetaEnabled?"-"+(c.height()+40)+"px":"0"},{duration:this.get("speed")}).run();
this.bMetaEnabled=!this.bMetaEnabled
},this))
},hideAndDestroy:function(c){if(Y.Lang.isBoolean(c)&&c){this._overlay.overlayHideAndDestroy()
}else{this.once("hidden",this.destroy);
this.hide()
}},hide:function(){var c=this._anim(this.get("contentBox"),{opacity:0},{duration:this.get("speed")});
c.once("end",function(){Y.Squarespace.EscManager.removeTarget(this);
this.fire("hidden")
},this);
if(this.get("destroyed")){c.fire("end")
}else{c.run()
}},setupNavigationFade:function(){var e,c=function(){if(e){e.cancel()
}},d=function(f){c();
if(f&&f.inViewportRegion()){f.addClass("mouseover").siblings().removeClass("mouseover");
e=Y.later(500,this,function(){if(f&&f.inViewportRegion()){f.removeClass("mouseover")
}})
}};
this._event(this._nextEl.on("mouseenter",function(){c()
}),"nav-next-onmouse");
this._event(this._previousEl.on("mouseenter",function(){c()
}),"nav-prev-onmouse");
this._event(this._lightboxContentEl.on("mousemove",Y.bind(function(f){if(f.clientX<this._lightboxContentEl.width()/2){d(this._previousEl)
}else{d(this._nextEl)
}},this)),"container-hovering")
},createSlideshow:function(e){var f=Y.Node.create('<div class="sqs-lightbox-slideshow"></div>').appendTo(e);
var d=this.get("set");
for(var h=0;
h<d.length;
h++){var c=Y.Node.create('<div class="sqs-lightbox-slide"></div>').appendTo(f),k=Y.Node.create('<div class="sqs-lightbox-padder content-fit"></div>').appendTo(c),j=Y.one(d[h].content.cloneNode(true)).appendTo(k).setAttribute("data-image-stretch","false")
}var g=new Y.Squarespace.Gallery2({container:f,currentIndex:this.get("currentSetIndex"),loop:true,autoplay:false,refreshOnResize:true,design:"stacked",designOptions:{clickBehavior:false,easing:Y.Easing.easeInOutExpo,speed:0.3,autoHeight:false,transition:"scroll",transitionOptions:{direction:"horizontal"}},loaderOptions:{load:false}});
return g
},createMetaEl:function(e){e=e.one(".sqs-lightbox-padder");
var d=this.getCurrentElMeta();
if(d){var c=Y.Node.create('<div class="sqs-lightbox-meta"></div>');
c.appendChild(d);
e.appendChild(c);
this._event(e.one(":first-child").on("mouseenter",function(){c.addClass("overlay-description-visible")
},this),"meta-hovering");
this._event(e.one(":first-child").on("mouseleave",function(){c.removeClass("overlay-description-visible")
},this),"meta-hovering");
this._event(c.on("mouseenter",function(){c.addClass("overlay-description-visible")
},this),"meta-hovering");
this._event(c.on("mouseleave",function(){c.removeClass("overlay-description-visible")
},this),"meta-hovering");
return c
}},getCurrentElContent:function(){if(this.get("set").length>0){return this.get("set")[this.get("currentSetIndex")].content
}else{return this.get("content")
}},getCurrentElMeta:function(){if(this.get("set").length>0){return this.get("set")[this.get("currentSetIndex")].meta
}else{return this.get("meta")
}},hideAddressBar:function(){Y.one("body").set("scrollTop",1);
if(Y.one("body").get("scrollTop")===1){Y.one("body").set("scrollTop",0)
}this._overlay.get("container").setStyle("height",Y.one("body").get("docHeight"))
}},{NS:"lightbox2",ATTRS:{content:{},controls:{value:{previous:false,next:false}},currentSetIndex:{value:0},meta:{},padding:{value:100},set:{value:[]},speed:{value:0.3}}});
Y.Squarespace.Lightbox2Plug=Y.Base.create("Lightbox2Plug",Y.Plugin.Base,[Y.Squarespace.GismoBase],{initializer:function(){this._event(this.get("host").on("click",function(d){d.preventDefault();
var c=this;
Y.use("squarespace-ui-base",function(){var e=new Y.Squarespace.Lightbox2(Y.merge({content:Y.Node.create(c.get("host").getAttribute("data-lightbox"))},c.get("lightboxOptions")));
e.render()
})
},this))
}},{NS:"lightbox2plugin",ATTRS:{lightboxOptions:{}}});
Y.Squarespace.GalleryManager=Singleton.create({ready:function(){this._galleries=[];
this._debugger=new Y.Squarespace.Debugger({name:"Gallery Manager",output:false})
},registerGallery:function(c){this._galleries.push(c)
},getGalleries:function(){return this._galleries
},initializeBlock:function(g){var k=g.getAttribute("data-block-json");
var n;
if(k){try{n=JSON.parse(k)
}catch(o){this._debugger.error("Error decoding gallery block data.");
return
}}else{n=g.getAncestorData("block").value
}if(!n){throw"Error evaluating gallery block data."
}var f;
switch(n.design){case"stacked":f="base";
break;
case"slider":f="strip";
break;
case"slideshow":f="stacked";
break;
case"grid":f="grid";
break;
default:f="base";
break
}var d=g.one(".sqs-gallery-container");
if(!d){this._debugger.warn("Returning, no wrapper found.");
return
}if(["grid","stacked"].indexOf(f)!==-1){d.ancestor(".sqs-block").removeClass("vsize-"+n.vSize)
}var r;
if(!d.one(".sqs-gallery").getData("gallery")){var h={};
if(["grid","stacked"].indexOf(f)!==-1){h.autoHeight=true
}if(f=="strip"){var p;
switch(n["active-alignment"]){case"left":p="start";
break;
case"center":p="middle";
break;
case"right":p="end";
break;
default:p="middle";
break
}h.alignment=p
}if(f=="grid"){h.lightbox=Static.IN_BACKEND?false:n.lightbox;
h.perRow=parseInt(n["thumbnails-per-row"],10)
}var l=(f==="grid")?false:true;
var c=(Y.Cookie.get("SQS_GALLERY_BLOCK_LAZYLOADING")==="true");
this._debugger.log("Initialize Block",n);
d.setData("galleryOptions",n);
r=new Y.Squarespace.Gallery2({containerWrapper:d,container:d.one(".sqs-gallery"),elements:{previous:d.one(".sqs-gallery-controls .previous"),next:d.one(".sqs-gallery-controls .next")},design:f,designOptions:h,loaderOptions:{canvas:false},keyboard:l,lazyLoad:c,autoplay:n.autoplay,loop:true,refreshOnResize:true});
if(n["autoplay-duration"]){var j=parseInt(n["autoplay-duration"]*1000,10);
if(r.get("autoplayOptions.timeout")!=j){r.set("autoplayOptions.timeout",j)
}}}else{this._debugger.log("Refreshing gallery.");
r=d.one(".sqs-gallery").getData("gallery");
r.refresh()
}var m=d.one(".sqs-gallery-thumbnails");
if(m){if(f==="stacked"&&!!n.thumbnails){var q=n["thumbnail-strip-height"];
m.all(".sqs-video-thumbnail").each(function(e){if(e.hasClass("no-image")){e.one(".sqs-video-thumbnail-inner").setStyles({width:Math.floor(q*(16/9))+"px"})
}var s=e.one("img");
if(s){s.once("load",function(){e.removeClass("loading");
e.setAttribute("style","width: "+s.get("offsetWidth")+"px !important")
})
}});
m.setStyles({height:q,marginTop:n["thumbnail-strip-margin"]});
var i;
if(!m.getData("gallery")){i=new Y.Squarespace.Gallery2({container:m,elements:{},loop:true,design:"strip",designOptions:{activeSlideClickBehavior:false},lazyLoad:false,loaderOptions:{canvas:false},refreshOnResize:true});
r.addChild(i)
}else{this._debugger.log("Refresh thumbnails.");
i=m.getData("gallery");
i.refresh()
}}}},refreshAll:function(){Y.Array.each(this._galleries,function(c){c.refresh()
})
}})
},"1.0",{requires:["base","plugin","squarespace-ss-widget","squarespace-gismo","squarespace-animations","node","event-key","squarespace-image-loader","squarespace-common","history","yui-throttle","squarespace-gallery-ng-css","squarespace-debugger","event-mouseenter","squarespace-touch-event-listener","squarespace-video-loader"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-census",function(a){a.namespace("Squarespace.Constants");
a.Squarespace.Census={hit:function(){if(!Static.SQUARESPACE_CONTEXT.authenticatedAccount){if(Static.SQUARESPACE_CONTEXT.item){a.Squarespace.Census.view("item",Static.SQUARESPACE_CONTEXT.item)
}else{if(Static.SQUARESPACE_CONTEXT.collection){a.Squarespace.Census.view("collection",Static.SQUARESPACE_CONTEXT.collection)
}}}},view:function(b,c){a.Squarespace.Census.track(a.Squarespace.Events.VIEW,{type:b,title:c.title,url:c.fullUrl,tags:c.tags,categories:c.categories})
},track:function(b,c){if(!c){c={}
}if(Static.SQUARESPACE_CONTEXT.website){c.websiteId=Static.SQUARESPACE_CONTEXT.website.id
}if(Static.SQUARESPACE_CONTEXT.templateId){c.templateId=Static.SQUARESPACE_CONTEXT.templateId
}a.Data.post({url:"/api/census/RecordHit",data:{event:b,data:a.JSON.stringify(c)}})
}}
},"1.0");/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-comment-data",function(a){a.namespace("Squarespace");
a.Squarespace.CommentData=Class.create({initialize:function(b){if(b===undefined){throw new Error("You must provide a configuration object.")
}else{if(b.target===undefined){throw new Error("You must provide a target id.")
}else{if(b.targetType===undefined){throw new Error("You must provide a target type.")
}}}this.settings=(b.settings||{approvalRequired:false,allowAnon:true,threaded:true});
this.formatter=(b.formatter||function(c){return c
});
this.page=1;
this.data={comments:[]};
this.topLevelComments=0;
this.visibleComments=0;
this.totalComments=(Static.SQUARESPACE_CONTEXT.item?Static.SQUARESPACE_CONTEXT.item.publicCommentCount:(Static.SQUARESPACE_CONTEXT.collection?Static.SQUARESPACE_CONTEXT.collection.publicCommentCount:0));
this.commentsPerPage=50;
this.target=b.target;
this.targetType=b.targetType;
this.idToIndex={};
this.comments=[];
this.likeMap={};
this.flagMap={};
this.formatted={};
this.currentThreadRoot="";
this.formattedThread={};
this.pageIntervals=[]
},useSecure:function(){return(window.SQUARESPACE_LOGIN&&window.SQUARESPACE_LOGIN.isLoggedIn())
},getCommentById:function(b){return this.comments[this.idToIndex[b]]
},removeCommentById:function(c){var b=this.idToIndex[c];
if(!a.Lang.isUndefined(b)){this.comments.splice(b,1);
this.calculatePagination()
}},removeCommentsByIds:function(b){b.forEach(function(d){var c=this.idToIndex[d];
if(!a.Lang.isUndefined(c)){this.comments.splice(c,1);
this.visibleComments-=1;
this.totalComments-=1
}},this);
this.calculatePagination()
},getFormattedPage:function(c){var b=this.pageIntervals[c-1];
if(b){return Array.prototype.slice.apply(this.comments,b)
}else{return null
}},fullBookkeeping:function(d){var c=0,e={},b={};
this.comments=[];
this.pageIntervals=[];
this.idToIndex={};
for(c=0;
c<d.comments.length;
c++){e=d.comments[c];
this.idToIndex[e.id]=c;
this.comments[c]=e
}this.pageIntervals.push([0,undefined]);
this.flagMap=d.flagMap;
this.likeMap=d.likeMap;
this.commentSettings=d.commentSettings;
this.visibleComments=d.visibleComments;
this.topLevelComments=(this.formatted.topLevelComments||this.topLevelComments);
this.totalComments=(d.totalComments?d.totalComments:this.totalComments);
this.reformat();
this.topLevelComments=d.topLevelComments;
this.numLikes=d.numLikes;
this.numPages=Math.ceil(this.topLevelComments/this.commentsPerPage)
},addCommentData:function(b){this.comments.splice((this.idToIndex[b.parentId]||-1)+1,0,b);
this.calculatePagination()
},calculatePagination:function(){var b=50,e=0,d,f,c;
this.idToIndex={};
this.pageIntervals=[[0,undefined]];
for(c=0;
c<this.comments.length;
c++){f=this.comments[c];
this.idToIndex[f.id]=c;
if(!f.parentId){e+=1;
if(e>b){d=this.pageIntervals[this.pageIntervals.length-1];
d[1]=e-1;
this.pageIntervals.push([d[1],undefined]);
e=0
}}}},appendBookkeeping:function(d){var c=0,b={},e={};
this.pageIntervals[this.pageIntervals.length-1][1]=this.comments.length;
for(c=0;
c<d.comments.length;
c++){e=d.comments[c];
this.idToIndex[e.id]=(this.comments.length+1);
this.comments.push(e)
}this.pageIntervals.push([this.pageIntervals[this.pageIntervals.length-1][1],undefined]);
this.likeMap=a.merge(this.likeMap,d.likeMap);
this.flagMap=a.merge(this.flagMap,d.flagMap);
this.visibleComments+=d.visibleComments;
this.reformat()
},reformat:function(){this.formatted=this.formatter(this.comments,this.likeMap,this.flagMap)
},like:function(c,d){var e=function(f){var g=this.getCommentById(c.id);
if(g){g.likeCount+=1;
this.reformat()
}(c.success||noop).call((d||this),f)
},b=function(f){(c.failure||noop).call((d||this),f)
};
a.Data.post({url:"/api/comment/LikeComment",secure:true,data:{commentId:c.id},success:e,failure:b},this)
},unlike:function(b,c){var d=function(e){var f=this.getCommentById(b.id);
if(f){f.likeCount=Math.max(f.likeCount-1,0);
this.reformat()
}(b.success||noop).call((c||this),e)
};
a.Data.post({url:"/api/comment/UnlikeComment",secure:true,data:{commentId:b.id},success:d,failure:b.failure},this)
},flag:function(c,d){var e=function(f){var g=this.getCommentById(c.id);
if(g){g.flagCount+=1;
this.reformat()
}(c.success||noop).call((d||this),f)
},b=function(f){(c.failure||noop).call((d||this),f)
};
a.Data.post({url:"/api/comment/FlagComment",secure:true,data:{commentId:c.id},success:e,failure:b},this)
},_delete:function(b,c){var d=function(e){b.comments.forEach(function(f){this.removeCommentById(f.id)
},this);
this.visibleComments-=b.comments.length;
this.totalComments-=b.comments.length;
(b.success||noop).call((c||this),e)
};
a.Data.post({url:"/api/comment/admin/DeleteComment",secure:true,data:{markAsSpam:b.spam,comments:(a.Lang.isArray(b.comments)?b.comments:[b.comments])},success:d,failure:(b.failure?a.bind(b.failure,(c||this)):undefined)},this)
},approve:function(b,c){var d=function(e){b.comments.forEach(function(g){var f=this.getCommentById(g.id);
if(f){f.status=a.Squarespace.CommentStatuses.APPROVED
}},this);
this.totalComments+=1;
(b.success||noop).call((c||this),e)
};
a.Data.post({url:"/api/comment/admin/ApproveComments",secure:true,data:{comments:(a.Lang.isArray(b.comments)?b.comments:[b.comments])},success:d,failure:(b.failure?a.bind(b.failure,(c||this)):undefined)},this)
},unflag:function(c,d){var e=function(f){var g=this.getCommentById(c.id);
if(g){g.flagCount=Math.max(g.flagCount-1,0);
this.reformat()
}(c.success||noop).call((d||this),f)
},b=function(f){(c.failure||noop).call((d||this),f)
};
a.Data.post({url:"/api/comment/UnflagComment",secure:true,data:{commentId:c.id},success:e,failure:b},this)
},post:function(b,c){var e={targetId:this.target,targetType:this.targetType,body:b.body,replyToId:b.replyTo,authorName:(a.Squarespace.Escaping.escapeForHtml(b.name)||""),authorEmail:(b.email||""),authorUrl:(b.authorUrl||"")},d=function(f){if(f.comment.status===a.Squarespace.CommentStatuses.APPROVED){this.addCommentData(f.comment);
this.visibleComments+=1;
this.totalComments+=1;
if(!b.replyTo){this.topLevelComments+=1
}this.reformat()
}(b.success||noop).call((c||this),f)
};
a.Data.post({url:"/api/comment/CreateComment",secure:true,data:e,success:d,failure:(b.failure?a.bind(b.failure,(c||this)):undefined)},this)
},getPage:function(b,d,c){if(d<=this.numPages){this.get({sortBy:b.order,page:d,success:b.success,failure:b.failure},c)
}},getSince:function(b,d,c){this.get({since:d,success:b.success,failure:b.failure},c)
},getThread:function(c,d){var e=function(g){this.currentThreadRoot=c.commentId;
var f=g.comments[0].comment.depth;
g.comments=a.Array.map(g.comments,function(h){return h.comment
});
g.comments.forEach(function(h){h.depth=(h.depth-f)
});
this.formattedThread=this.formatter(g.comments,{},{});
if(a.Lang.isFunction(c.success)){c.success.call((d||this),g)
}},b=function(f){if(a.Lang.isFunction(c.failure)){c.failure.call((d||this),f)
}};
a.Data.get({url:"/api/comment/GetThread",secure:this.useSecure(),data:{sortBy:c.order,commentId:c.commentId},success:e,failure:b},this)
},get:function(b,c){var d=function(e){this.page=b.page;
if(b.page<=1){this.fullBookkeeping(e)
}else{if(b.page>1){this.appendBookkeeping(e)
}}if(b.success){b.success.call((c||this),e)
}};
a.Data.get({url:"/api/comment/GetComments",secure:this.useSecure(),data:{targetId:this.target,targetType:this.targetType,since:(b.since||""),page:b.page,sortBy:b.order},success:d,failure:b.failure},this)
},getLikesAndFlags:function(b,c){var d=a.Array.map(this.comments,function(f){return f.id
}),e;
a.Data.post({url:"/api/comment/GetLikesFlags",secure:this.useSecure(),data:{ids:d},success:function(f){if(b.success&&a.Lang.isFunction(b.success)){b.success.call((c||this),f)
}},failure:function(f){if(b.failure&&a.Lang.isFunction(b.failure)){b.failure.call((c||this),f)
}}})
}})
},"1.0",{requires:["squarespace-util"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
(function(){var b={};
b.converter=function(){var an;
var ae;
var W;
var af=0;
this.makeHtml=function(c){an=new Array();
ae=new Array();
W=new Array();
c=c.replace(/~/g,"~T");
c=c.replace(/\$/g,"~D");
c=c.replace(/\r\n/g,"\n");
c=c.replace(/\r/g,"\n");
c="\n\n"+c+"\n\n";
c=Y(c);
c=c.replace(/^[ \t]+$/mg,"");
c=ab(c);
c=ak(c);
c=L(c);
c=U(c);
c=c.replace(/~D/g,"$$");
c=c.replace(/~T/g,"~");
return c
};
var ak=function(c){var c=c.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|$)/gm,function(d,g,h,e,f){g=g.toLowerCase();
an[g]=ag(h);
if(e){return e+f
}else{if(f){ae[g]=f.replace(/"/g,"&quot;")
}}return""
});
return c
};
var ab=function(c){c=c.replace(/\n/g,"\n\n");
var d="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del";
var e="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math";
c=c.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,I);
c=c.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,I);
c=c.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,I);
c=c.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,I);
c=c.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,I);
c=c.replace(/\n\n/g,"\n");
return c
};
var I=function(e,d){var c=d;
c=c.replace(/\n\n/g,"\n");
c=c.replace(/^\n/,"");
c=c.replace(/\n+$/g,"");
c="\n\n~K"+(W.push(c)-1)+"K\n\n";
return c
};
var L=function(c){c=ai(c);
var d=Z("<hr />");
c=c.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,d);
c=c.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,d);
c=c.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,d);
c=O(c);
c=am(c);
c=M(c);
c=ab(c);
c=ah(c);
return c
};
var T=function(c){c=S(c);
c=ac(c);
c=aj(c);
c=N(c);
c=a(c);
c=aa(c);
c=ag(c);
c=al(c);
c=c.replace(/  +\n/g," <br />\n");
return c
};
var ac=function(c){var d=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;
c=c.replace(d,function(e){var f=e.replace(/(.)<\/?code>(?=.)/g,"$1`");
f=J(f,"\\`*_");
return f
});
return c
};
var a=function(c){c=c.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,R);
c=c.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,R);
c=c.replace(/(\[([^\[\]]+)\])()()()()()/g,R);
return c
};
var R=function(j,d,e,f,g,h,k,l){if(l==undefined){l=""
}var m=d;
var o=e;
var n=f.toLowerCase();
var p=g;
var i=l;
if(p==""){if(n==""){n=o.toLowerCase().replace(/ ?\n/g," ")
}p="#"+n;
if(an[n]!=undefined){p=an[n];
if(ae[n]!=undefined){i=ae[n]
}}else{if(m.search(/\(\s*\)$/m)>-1){p=""
}else{return m
}}}p=J(p,"*_");
var c='<a href="'+p+'"';
if(i!=""){i=i.replace(/"/g,"&quot;");
i=J(i,"*_");
c+=' title="'+i+'"'
}c+=">"+o+"</a>";
return c
};
var N=function(c){c=c.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,P);
c=c.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,P);
return c
};
var P=function(j,d,e,f,g,h,k,l){var m=d;
var n=e;
var o=f.toLowerCase();
var p=g;
var i=l;
if(!i){i=""
}if(p==""){if(o==""){o=n.toLowerCase().replace(/ ?\n/g," ")
}p="#"+o;
if(an[o]!=undefined){p=an[o];
if(ae[o]!=undefined){i=ae[o]
}}else{return m
}}n=n.replace(/"/g,"&quot;");
p=J(p,"*_");
var c='<img src="'+p+'" alt="'+n+'"';
i=i.replace(/"/g,"&quot;");
i=J(i,"*_");
c+=' title="'+i+'"';
c+=" />";
return c
};
var ai=function(c){c=c.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(f,e){return Z('<h1 id="'+d(e)+'">'+T(e)+"</h1>")
});
c=c.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(e,f){return Z('<h2 id="'+d(f)+'">'+T(f)+"</h2>")
});
c=c.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(f,g,h){var e=g.length;
return Z("<h"+e+' id="'+d(h)+'">'+T(h)+"</h"+e+">")
});
function d(e){return e.replace(/[^\w]/g,"").toLowerCase()
}return c
};
var X;
var O=function(c){c+="~0";
var d=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;
if(af){c=c.replace(d,function(e,h,i){var g=h;
var j=(i.search(/[*+-]/g)>-1)?"ul":"ol";
g=g.replace(/\n{2,}/g,"\n\n\n");
var f=X(g);
f=f.replace(/\s+$/,"");
f="<"+j+">"+f+"</"+j+">\n";
return f
})
}else{d=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g;
c=c.replace(d,function(l,h,j,e){var i=h;
var g=j;
var k=(e.search(/[*+-]/g)>-1)?"ul":"ol";
var g=g.replace(/\n{2,}/g,"\n\n\n");
var f=X(g);
f=i+"<"+k+">\n"+f+"</"+k+">\n";
return f
})
}c=c.replace(/~0/,"");
return c
};
X=function(c){af++;
c=c.replace(/\n{2,}$/,"\n");
c+="~0";
c=c.replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(d,j,k,e,f){var h=f;
var i=j;
var g=k;
if(i||(h.search(/\n{2,}/)>-1)){h=L(Q(h))
}else{h=O(Q(h));
h=h.replace(/\n$/,"");
h=T(h)
}return"<li>"+h+"</li>\n"
});
c=c.replace(/~0/g,"");
af--;
return c
};
var am=function(c){c+="~0";
c=c.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(f,d,e){var h=d;
var g=e;
h=K(Q(h));
h=Y(h);
h=h.replace(/^\n+/g,"");
h=h.replace(/\n+$/g,"");
h="<pre><code>"+h+"\n</code></pre>";
return Z(h)+g
});
c=c.replace(/~0/,"");
return c
};
var Z=function(c){c=c.replace(/(^\n+|\n+$)/g,"");
return"\n\n~K"+(W.push(c)-1)+"K\n\n"
};
var S=function(c){c=c.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(d,h,i,e,f){var g=e;
g=g.replace(/^([ \t]*)/g,"");
g=g.replace(/[ \t]*$/g,"");
g=K(g);
return h+"<code>"+g+"</code>"
});
return c
};
var K=function(c){c=c.replace(/&/g,"&amp;");
c=c.replace(/</g,"&lt;");
c=c.replace(/>/g,"&gt;");
c=J(c,"*_{}[]\\",false);
return c
};
var al=function(c){c=c.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>");
c=c.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>");
return c
};
var M=function(c){c=c.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(f,e){var d=e;
d=d.replace(/^[ \t]*>[ \t]?/gm,"~0");
d=d.replace(/~0/g,"");
d=d.replace(/^[ \t]+$/gm,"");
d=L(d);
d=d.replace(/(^|\n)/g,"$1  ");
d=d.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(i,h){var g=h;
g=g.replace(/^  /mg,"~0");
g=g.replace(/~0/g,"");
return g
});
return Z("<blockquote>\n"+d+"\n</blockquote>")
});
return c
};
var ah=function(g){g=g.replace(/^\n+/g,"");
g=g.replace(/\n+$/g,"");
var h=g.split(/\n{2,}/g);
var d=new Array();
var f=h.length;
for(var e=0;
e<f;
e++){var i=h[e];
if(i.search(/~K(\d+)K/g)>=0){d.push(i)
}else{if(i.search(/\S/)>=0){i=T(i);
i=i.replace(/^([ \t]*)/g,"<p>");
i+="</p>";
d.push(i)
}}}f=d.length;
for(var e=0;
e<f;
e++){while(d[e].search(/~K(\d+)K/)>=0){var c=W[RegExp.$1];
c=c.replace(/\$/g,"$$$$");
d[e]=d[e].replace(/~K\d+K/,c)
}}return d.join("\n\n")
};
var ag=function(c){c=c.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");
c=c.replace(/<(?![a-z\/?\$!])/gi,"&lt;");
return c
};
var aj=function(c){c=c.replace(/\\(\\)/g,ad);
c=c.replace(/\\([`*_{}\[\]()>#+-.!])/g,ad);
return c
};
var aa=function(c){c=c.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,'<a href="$1">$1</a>');
c=c.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(e,d){return V(U(d))
});
return c
};
var V=function(c){function d(h){var f="0123456789ABCDEF";
var g=h.charCodeAt(0);
return(f.charAt(g>>4)+f.charAt(g&15))
}var e=[function(f){return"&#"+f.charCodeAt(0)+";"
},function(f){return"&#x"+d(f)+";"
},function(f){return f
}];
c="mailto:"+c;
c=c.replace(/./g,function(f){if(f=="@"){f=e[Math.floor(Math.random()*2)](f)
}else{if(f!=":"){var g=Math.random();
f=(g>0.9?e[2](f):g>0.45?e[1](f):e[0](f))
}}return f
});
c='<a href="'+c+'">'+c+"</a>";
c=c.replace(/">.+:/g,'">');
return c
};
var U=function(c){c=c.replace(/~E(\d+)E/g,function(f,d){var e=parseInt(d);
return String.fromCharCode(e)
});
return c
};
var Q=function(c){c=c.replace(/^(\t|[ ]{1,4})/gm,"~0");
c=c.replace(/~0/g,"");
return c
};
var Y=function(c){c=c.replace(/\t(?=\t)/g,"    ");
c=c.replace(/\t/g,"~A~B");
c=c.replace(/~B(.+?)~A/g,function(f,i,d){var g=i;
var e=4-g.length%4;
for(var h=0;
h<e;
h++){g+=" "
}return g
});
c=c.replace(/~A/g,"    ");
c=c.replace(/~B/g,"");
return c
};
var J=function(g,e,d){var f="(["+e.replace(/([\[\]\\])/g,"\\$1")+"])";
if(d){f="\\\\"+f
}var c=new RegExp(f,"g");
g=g.replace(c,ad);
return g
};
var ad=function(e,c){var d=c.charCodeAt(0);
return"~E"+d+"E"
}
};
YUI.add("squarespace-markdown",function(a){a.namespace("Squarespace");
a.Squarespace.Lang.markdownToHTML=function(h){if(!h){return""
}var f=new b.converter();
var g=f.makeHtml(h);
return g
}
},"1.0",{requires:["squarespace-util"]})
})();/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-dialog-field-legacy-interface",function(b){var a=b.namespace("Squarespace").DialogFieldLegacyInterface=function(c){if(b.Lang.isFunction(this.hideError)){b.Do.after(function(){var d=c.dialog;
if(d){d.clearError(this)
}},this,"hideError",this)
}b.Do.after(function(){this.after(this.get("id")+"|dataChange",function(f){var d=c.dialog;
if(d){d.fire("datachange",this)
}var g=this.get("name");
if(g){this.fire("value-changed",{name:g,value:f.newVal,oldValue:f.prevVal,field:this})
}},this)
},this,"bindUI",this);
b.Do.after(function(){if(c&&c.defaultHidden){this.hide(true)
}},this,"syncUI",this)
};
a.NAME="dialogFieldLegacyInterface";
a.prototype={temporaryHide:function(){this.hide()
},temporaryShow:function(){this.show()
},getName:function(){return this.get("name")
},getType:function(){return this.name
},getValue:function(){return this.get("data")
},getErrors:function(){return this.get("errors")
},getNode:function(){return this.get("boundingBox")
},setValue:function(c){this.set("data",c)
},clearError:function(){this.hideError()
}}
},"1.0");/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-flyout-error-message-template",function(c){var b=c.Handlebars;
(function(){var e=b.template,d=b.templates=b.templates||{};
d["flyout-error-message.html"]=e(function(h,n,g,m,l){g=g||h.helpers;
var k="",f,j,i="function";
k+='<div class="sqs-flyout-error-message">';
j=g.message;
if(j){f=j.call(n,{hash:{}})
}else{f=n.message;
f=typeof f===i?f():f
}if(f||f===0){k+=f
}k+="</div>";
return k
})
})();
var a="flyout-error-message.html";
c.Handlebars.registerPartial(a.replace("/","."),b.templates[a])
},"1.0",{requires:["handlebars-base",]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-dialog-field-2",function(b){var a="error";
b.Squarespace.Widgets.DialogField2=b.Squarespace.DialogField2=b.Base.create("dialogField",b.Squarespace.Widgets.DataWidget,[b.Squarespace.DialogFieldLegacyInterface,b.WidgetParent,b.WidgetChild],{initializer:function(c){this._saveInitialData(c?c.data:null)
},destructor:function(){this._destroyError();
this.unplug(b.Plugin.WidgetAnim)
},_destroyError:function(){if(this._errorNode){this._errorNode.remove(true);
this._errorNode=null
}},_saveInitialData:function(c){c=b.Lang.isUndefined(c)?this.get("data"):c;
if(b.Lang.isArray(c)){this._initialData=c.slice()
}else{if(b.Lang.isObject(c)){this._initialData=b.clone(c,true)
}else{this._initialData=c
}}},setCurrentDataAsInitial:function(){this._saveInitialData()
},renderUI:function(){b.Squarespace.DialogField2.superclass.renderUI.call(this);
var c=this.get("name");
if(c){this.get("boundingBox").addClass("name-"+c)
}},showError:function(g){if(!g||!this.get("rendered")){return
}var e=this.get("boundingBox"),d=this.get("contentBox"),f=this.get("errorFlyoutAnchor")||d;
if(!f.hasPlugin("flyoutPlugin")){f.plug(b.Squarespace.Animations.Flyout,{duration:0.3})
}var c=f.flyoutPlugin;
var h=b.bind(function(){e.addClass(a);
this._destroyError();
this._errorNode=b.Squarespace.UITemplates.renderAsNodeOrDocFrag("flyout-error-message.html",{message:g});
var m=this.get("dialog");
if(m){this._errorNode.setStyle("zIndex",m.zIndex+10)
}this._errorNode.on(this.get("id")+"|click",function(o){o.halt();
this.hideError()
},this);
var l=b.one(window).get("region").right,k=b.Squarespace.Utils.measureNode(this._errorNode).width,j=f.get("region").right+k,i=j>l;
if(i){this._errorNode.addClass("out-from-left")
}c.setAttrs({node:this._errorNode,alignment:i?"lt":"rt"});
this._clearErrorSub=b.on(this.get("id")+"|click",this.hideError,this);
var n=this.get("id");
c.once(n+"|shown",function(o){this.fire("error-shown")
},this);
f.once("shown",function(o){this._errorNode.setStyle("width","100%")
},this);
c.show()
},this);
if(c.get("visible")){if(this._showErrorSub){this._showErrorSub.detach()
}this._showErrorSub=c.once(this.get("id")+"|hidden",function(){this._showErrorSub=null;
h()
},this);
c.hide()
}else{h()
}},hideError:function(){if(!this.get("rendered")){return
}var d=this.get("boundingBox"),e=this.get("errorFlyoutAnchor")||d;
if(!e.hasPlugin("flyoutPlugin")||!e.flyoutPlugin.get("visible")){return
}if(this._clearErrorSub){this._clearErrorSub.detach()
}var c=e.flyoutPlugin;
c.once(this.get("id")+"|hidden",function(f){d.removeClass(a);
this.fire("error-hidden");
this._destroyError()
},this);
c.hide()
},didDataChange:function(){var c=this.get("data");
if(b.Lang.isArray(this._initialData)){return b.JSON.stringify(this._initialData)!==b.JSON.stringify(c)
}if(b.Lang.isObject(this._initialData)){throw"DialogField base class will not compare objects. Define didDataChange for this field."
}return this._initialData!==c
},isEmpty:function(){var c=this.get("data");
return c===""||c===0
},revert:function(){this.set("data",this._initialData,{revert:true})
},_getErrors:function(){return[]
},isValid:function(){return this.get("errors").length>0
}},{CSS_PREFIX:"sqs-dialog-field",ATTRS:{strings:{},name:{value:null},dialog:{value:null,validator:function(c){if(b.Lang.isNull(c)){return true
}if(!(c instanceof b.Squarespace.EditingDialog||c.constructor instanceof b.Squarespace.EditingDialog.constructor)){console.warn(this.name+": Not an EditingDialog");
return false
}else{return true
}}},required:{value:false},errors:{value:[],readOnly:true,getter:"_getErrors"},errorFlyoutAnchor:{value:null,readOnly:true}}})
},"1.0",{requires:["base-build","widget-child","widget-parent","widget-anim","json-stringify","squarespace-util","squarespace-ss-widget","squarespace-dialog-field-legacy-interface","squarespace-animations","squarespace-flyout-error-message-template"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-dialog-hidden",function(b){var a=function(){};
b.namespace("Squarespace.DialogFields").Hidden=b.Base.create("hidden",b.Squarespace.DialogField2,[],{initializer:function(){this.unplug(b.Plugin.WidgetAnim)
},focus:null,enable:null,disable:null,blur:null,renderUI:a,bindUI:a,syncUI:a},{CSS_PREFIX:"sqs-hidden",ATTRS:{visible:{value:false}}});
b.Squarespace.DialogFields.HiddenField=b.Squarespace.DialogFields.Hidden
},"1.0",{requires:["base","base-build","squarespace-dialog-field-2"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-login",function(a){if(!window.SQUARESPACE_LOGIN){window.SQUARESPACE_LOGIN=Singleton.create({ready:function(){if(Static.SQUARESPACE_CONTEXT){this.account=Static.SQUARESPACE_CONTEXT.authenticatedAccount
}this.defaultParams={redirectAfterCancel:true,redirectAfterLogin:true,minimal:false,cancelable:true,overlayOpacity:0.8,disableOverlayCancel:false,forgotPassword:true,disableCreateAccount:true,globalLogin:true,allowSocialLogins:true};
this.params=this.defaultParams;
this.dialogParameters=null
},configure:function(b){this.params=this.defaultParams;
this.params=a.merge(this.params,b)
},reset:function(){this.params=this.defaultParams
},isLoggedIn:function(){return !!this.account
},getAccount:function(){return this.account
},toggle:function(){if(this.loginDialog&&this.loginDialog.isVisible()){this.loginDialog.cancel()
}else{this.show()
}},buildDialog:function(){this.dialogParameters={style:"flyout",discardChangesConfirmation:false,overlay:this.params.overlayOpacity,width:400,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,tabs:[{title:"Squarespace Login",icon:"/universal/images-v6/dialog/login-icon.png?4",fields:[{type:"multi-frame",name:"login-method-frame",initialFrame:"squarespace",frames:{squarespace:{fields:[{type:"text",required:true,name:"email",title:"Login or Email",titleStyle:"inline",submitOnEnter:true,mailcheck:true,style:"major"},{type:"text",required:true,name:"password",password:true,title:"Password",titleStyle:"inline",submitOnEnter:true,style:"major"},{type:"splitter",fields:[{type:"check",width:0.7,required:true,name:"remember",title:"Stay Signed In",padding:[5,0],description:"Will keep you signed in for 2 weeks."},{type:"link",width:0.3,name:"passwordReset",className:"forgotpassword",title:"Forgot Password?",align:"right"}]}]},facebook:{fields:[{type:"description",name:"facebook-login",text:'<div class="facebook-login-button"></div><div class="big-login-caption">Click above to be redirected to Facebook.</div>'}]},twitter:{fields:[{type:"description",name:"twitter-login",text:'<div class="twitter-login-button"></div><div class="big-login-caption">Click above to be redirected to Twitter.</div>'}]},google:{fields:[{type:"description",name:"google-login",text:'<div class="google-login-button"></div><div class="big-login-caption">Click above to be redirected to Google.</div>'}]}}},{type:"hidden",name:"inviteCode"},{type:"hidden",name:"srcUrl"}]}]};
if(this.params.allowSocialLogins){this.dialogParameters.tabs[0].fields.splice(0,0,{type:"multi-option",name:"login-method",linkFrame:"login-method-frame",defaultValue:"squarespace",titleStyle:"top",padding:[0,20],optionPadding:"45px 0 15px 0",iconDropPx:8,options:[{icon:"/universal/images-v6/dialog/login-squarespace.png",title:"Squarespace",value:"squarespace"},{icon:"/universal/images-v6/dialog/login-twitter.png",title:"Twitter",value:"twitter"},{icon:"/universal/images-v6/dialog/login-facebook.png",title:"Facebook",value:"facebook"},{icon:"/universal/images-v6/dialog/login-google.png",title:"Google",value:"google"}]});
this.dialogParameters.width=460
}else{this.dialogParameters.width=400
}if(this.params.minimal){this.dialogParameters.style="transparent";
this.dialogParameters.top=300;
this.dialogParameters.buttons=[(this.params.cancelable?{type:"cancel",title:"Cancel"}:null),(!this.params.disableCreateAccount?{type:"createAccount",title:"Create Squarespace Account"}:null),{type:"saveAndClose",title:"Login"}]
}else{this.dialogParameters.buttons=[(!this.params.disableOverlayCancel?{type:"cancel",title:"Cancel"}:null),(!this.params.disableCreateAccount?{type:"createAccount",title:"Create Squarespace Account"}:null),{type:"saveAndClose",title:"Login"}]
}},buildCommentDialog:function(b,c,d){this.dialogParameters={name:"comment",style:"flyout",discardChangesConfirmation:false,overlay:this.params.overlayOpacity,width:460,height:275,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,tabs:[{title:b,icon:"/universal/images-v6/standard/icon_comments_24_light.png",fields:[{type:"hidden",name:"inviteCode"},{type:"hidden",name:"srcUrl"},{type:"multi-option",name:"login-method",linkFrame:"login-method-frame",defaultValue:"squarespace",titleStyle:"top",padding:[0,20],optionPadding:"45px 0 15px 0",iconDropPx:8,options:[{icon:"/universal/images-v6/dialog/login-squarespace.png",title:"Squarespace",value:"squarespace"},{icon:"/universal/images-v6/dialog/login-twitter.png",title:"Twitter",value:"twitter"},{icon:"/universal/images-v6/dialog/login-facebook.png",title:"Facebook",value:"facebook"},{icon:"/universal/images-v6/dialog/login-google.png",title:"Google",value:"google"}]},{type:"multi-frame",name:"login-method-frame",initialFrame:"squarespace",frames:{squarespace:{fields:[{type:"text",required:true,name:"email",title:"Email Address",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,style:"major"},{type:"text",required:true,name:"password",password:true,title:"Password",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,style:"major"},{type:"splitter",fields:[{type:"check",width:0.7,required:true,name:"remember",title:"Stay Signed In",padding:[5,0],description:"Will keep you signed in for 2 weeks."},{type:"link",width:0.3,name:"passwordReset",className:"forgotpassword",title:"Forgot Password?",align:"right"}]}]},facebook:{fields:[{type:"description",name:"facebook-login",text:'<div class="facebook-login-button"></div><div class="big-login-caption">Click above to be redirected to Facebook.</div>'}]},twitter:{fields:[{type:"description",name:"twitter-login",text:'<div class="twitter-login-button"></div><div class="big-login-caption">Click above to be redirected to Twitter.</div>'}]},google:{fields:[{type:"description",name:"google-login",text:'<div class="google-login-button"></div><div class="big-login-caption">Click above to be redirected to Google.</div>'}]}}}]}]};
if(this.params.minimal){this.dialogParameters.style="transparent";
this.dialogParameters.width=460;
this.dialogParameters.height=275;
this.dialogParameters.top=300;
this.dialogParameters.buttons=[{type:"createAccount",title:"Create Squarespace Account"},{type:"saveAndClose",title:"Login"}]
}else{this.dialogParameters.buttons=[(!this.params.disableOverlayCancel?{type:"cancel",title:"Cancel"}:null),{type:"createAccount",title:"Create Squarespace Account"},{type:"saveAndClose",title:(c||"Login")}]
}if(d){this.dialogParameters.tabs[0].fields.forEach(function(e){if(e.name==="login-method"){e.defaultValue="guest";
e.options.unshift({icon:"/universal/images-v6/dialog/login-guest.png",title:"Guest",value:"guest"})
}if(e.name==="login-method-frame"){e.initialFrame="guest";
e.frames.guest={fields:[{type:"text",name:"displayName",required:true,title:"Your Name",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,style:"major"},{type:"text",name:"anonEmail",title:"Email (Optional)",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,mailcheck:true,style:"major"},{type:"text",required:false,name:"authorUrl",title:"Website URL (Optional)",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,style:"major"}]}
}},this)
}},showCommentLogin:function(b,d,c){this.params.redirectAfterLogin=false;
this.params.redirectAfterCancel=false;
if(this.loginDialog){this.loginDialog=null;
this.dialogParameters=null
}this.buildCommentDialog(b,d,c);
this.show()
},show:function(){a.use("squarespace-dialog","squarespace-external-authentication","squarespace-dialog-hidden",a.bind(function(b){if(this.loginDialog&&this.loginDialog.isVisible()){return
}if(this.loginDialog){this.loginDialog.destroy();
this.loginDialog=null;
this.dialogParameters=null
}if(this.dialogParameters===null){this.buildDialog()
}this.loginDialog=new b.Squarespace.EditingDialog(this.dialogParameters);
this.loginDialog.on(["cancel","overlay-click"],function(){window.SQUARESPACE_LOGIN.fire("cancel");
this.reset()
},this);
this.loginDialog.on("loading",function(){var c=b.Cookie.get("email");
if(window.SQUARESPACE_LOGIN.params.inviteCode){window.SQUARESPACE_LOGIN.showBigText("login");
c=this.params.invitation.email;
this.params.redirectAfterLogin=true
}if(c){this.loginDialog.setInitialData({email:c,inviteCode:window.SQUARESPACE_LOGIN.params.inviteCode,remember:true})
}else{this.loginDialog.setInitialData({inviteCode:window.SQUARESPACE_LOGIN.params.inviteCode,remember:true})
}},this);
this.loginDialog.on("click",function(c){if(!this.externalAuth){this.externalAuth=new b.Squarespace.ExternalAuthentication({loginFlag:true});
this.externalAuth.on("completed",function(){b.Data.post({url:"/api/auth/CheckAuthentication",secure:true,data:{srcUrl:document.location.href},success:function(d){Static.SQUARESPACE_CONTEXT.permissions=d.permissions;
if(d.member){this.close();
Static.SQUARESPACE_CONTEXT.authenticatedAccount=d.member;
window.SQUARESPACE_LOGIN.onLoginComplete(d.member,d.redirectUrl)
}}},this)
},this)
}if(c.target.ancestor(".twitter-login-button",true)){this.externalAuth.openPopupWindow("","","4")
}else{if(c.target.ancestor(".facebook-login-button",true)){this.externalAuth.openPopupWindow("","","2")
}else{if(c.target.ancestor(".google-login-button",true)){this.externalAuth.openPopupWindow("","","5")
}}}});
this.loginDialog.on("button-createAccount",function(){this.loginDialog.temporaryHide();
this.createSquarespaceAccount()
},this);
this.loginDialog.on("link-passwordReset",function(){this.loginDialog.temporaryHide();
var c=this.loginDialog.getData();
this.passwordReset(c.email)
},this);
this.loginDialog.on("datachange",function(){if(!this.getData().remember){b.Cookie.remove("email")
}this.hideErrors()
});
this.loginDialog.on("cancel",function(){if(this.params.redirectAfterCancel&&!SQUARESPACE_LOGIN.params.externalSwitcher){document.location.href="http://"+document.location.host+"/"
}});
this.loginDialog.on("send-requested",function(){var e=this.loginDialog.getData();
if(e["login-method"]==="guest"){var c=new Date();
c.setSeconds(c.getSeconds()+30);
b.Cookie.set("email",e.anonEmail,{path:"/",expires:c});
b.Cookie.set("displayName",e.displayName,{path:"/",expires:c});
b.Cookie.set("websiteUrl",e.authorUrl,{path:"/",expires:c});
this.loginDialog.close();
this.fire("guestLogin")
}else{if(e.email.indexOf("@")===-1){b.use("thirdparty-sha1",b.bind(function(g){var f=b64_sha1(e.password);
g.Data.post({xdr:{credentials:true},url:"http://squarespace5."+Static.SQUARESPACE_CONTEXT.appDomain+"/process/service/CredentialCheck",data:{A:e.email,B:f,from6:true},success:function(h){g.Data.post({xdr:{credentials:true},url:"http://"+e.email+"."+Static.SQUARESPACE_CONTEXT.appDomain+"/process/Login",data:{username:e.email,encryptedPassword:f,from6:true},success:function(i){if(i.result==="success"){this.loginDialog.close();
top.location.replace("http://"+e.email+"."+Static.SQUARESPACE_CONTEXT.appDomain);
return
}},failure:function(i){this.loginDialog.showErrors(i.errors)
}},this)
},failure:function(i){if(i.errors){this.loginDialog.showErrors(i.errors)
}else{var h={password:"There was an unexpected error. Please try again later."};
this.loginDialog.showErrors(h)
}}},this)
},this))
}else{var d=this.loginDialog.getField("srcUrl");
if(d&&this.loginDialog.getName()!=="comment"){d.setValue(document.location.href)
}b.Data.sendForm(this.loginDialog,{url:"/api/auth/Login",secure:true,success:function(f){if(e.remember){b.Cookie.set("email",e.email,{path:"/",expires:new Date("January 1, 2030")})
}b.Cookie.remove("displayName");
Static.SQUARESPACE_CONTEXT.permissions=f.permissions;
Static.SQUARESPACE_CONTEXT.ownedWebsites=f.ownedWebsites;
Static.SQUARESPACE_CONTEXT.authenticatedAccount=f.account;
this.loginDialog.close();
this.onLoginComplete(f.account,f.redirectUrl)
}},this)
}}},this);
this.loginDialog.setInitialData({"login-method":"squarespace",login:Static.SQUARESPACE_CONTEXT.website.identifier,password:"",remember:false,inviteCode:Static.SQUARESPACE_CONTEXT.inviteCode});
if(!this.loginDialog.isVisible()){this.loginDialog.show();
this.loginDialog.once("shown",function(){this.loginDialog.getField("email").focus()
},this)
}},this))
},createSquarespaceAccount:function(){if(!this.createAccountDialog){var d={loadingText:"Loading...",savingText:"Submitting...",closingText:"",style:"flyout",overlay:this.params.overlayOpacity,width:460,top:200,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,title:"Create Squarespace Account",buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Create Login"}],tabs:[{title:"",fields:[{type:"description",text:"<strong>Below you can sign up for a Squarespace account.</strong>  Squarespace accounts let you keep a profile for editing and commenting on Squarespace websites.",padding:[0,15]},{type:"splitter",fields:[{type:"text",width:0.5,required:true,name:"firstName",title:"First Name",style:"title",titleStyle:"inline",submitOnEnter:true},{type:"text",width:0.5,required:true,name:"lastName",title:"Last Name",style:"title",titleStyle:"inline",submitOnEnter:true}]},{type:"text",required:true,name:"email",title:"your@email.com",style:"title",titleStyle:"inline",submitOnEnter:true},{type:"text",required:true,name:"password",password:true,title:"Password",style:"title",titleStyle:"inline",submitOnEnter:true}]}]};
if(this.params.minimal){d.style="transparent";
d.tabs[0].fields[0]=null;
d.top=260
}else{d.style=null;
d.tabs[0].icon="/universal/images-v6/dialog/dialog-icon-member.png"
}this.createAccountDialog=new a.Squarespace.EditingDialog(d);
this.createAccountDialog.on("loading",function(){this.showBigText("create")
},this);
this.createAccountDialog.on("cancel",function(){this.showBigText("login");
this.loginDialog.temporaryShow()
},this);
this.createAccountDialog.on("send-requested",function(){var c=this.createAccountDialog.getData();
a.Data.sendForm(this.createAccountDialog,{url:"/api/auth/CreateSquarespaceAccount",secure:true,success:function(e){this.createAccountDialog.close();
this.loginDialog.temporaryShow();
this.loginDialog.getField("email").setValue(c.email);
this.loginDialog.getField("password").setValue(c.password);
this.loginDialog.getField("login-method").setValue("squarespace");
this.loginDialog.save()
}},this)
},this)
}if(this.params.invitation){var b={email:this.params.invitation.email};
this.createAccountDialog.setInitialData(b)
}this.createAccountDialog.show()
},passwordReset:function(b){if(!this.passwordResetDialog){var d={subtext:"Squarespace",style:"minimal",overlay:this.params.overlayOpacity,width:460,top:280,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Send Email"}],tabs:[{title:"",fields:[{type:"description",text:"Please enter the email address that you used when creating your account.  An email will be sent to that address with further instructions on how to reset your password."},{type:"text",required:true,name:"email",password:false,title:"your@email.com",style:"title",titleStyle:"inline",submitOnEnter:true}]}]};
d.tabs[0].title="Password Reset";
d.tabs[0].icon="/universal/images-v6/dialog/dialog-icon-member.png";
this.passwordResetDialog=new a.Squarespace.EditingDialog(d);
this.passwordResetDialog.on("loading",function(){},this);
this.passwordResetDialog.on("cancel",function(){this.showBigText("login");
this.loginDialog.temporaryShow()
},this);
this.passwordResetDialog.on("send-requested",function(){var c=this.passwordResetDialog.getData();
a.Data.sendForm(this.passwordResetDialog,{url:"/api/auth/PasswordReset",secure:true,success:function(e){this.passwordResetDialog.close();
this.passwordResetDone(e)
},failure:function(e){}},this)
},this)
}this.passwordResetDialog.setInitialData({email:(b?b:"")});
this.passwordResetDialog.show()
},passwordResetDone:function(b){var d={subtext:"Squarespace",style:"minimal",overlay:this.params.overlayOpacity,width:460,top:280,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,buttons:[{type:"done",title:"Back to Login"}],tabs:[{title:"",fields:[{type:"description",text:"You have been sent an email with further instructions on resetting your password."}]}]};
d.tabs[0].title="Password Reset";
d.tabs[0].icon="/universal/images-v6/dialog/dialog-icon-member.png";
this.passwordResetDialogDone=new a.Squarespace.EditingDialog(d);
this.passwordResetDialogDone.on("button-done",function(){this.passwordResetDialogDone.close();
this.showBigText("login");
this.loginDialog.temporaryShow()
},this);
this.passwordResetDialogDone.show()
},getPasswordResetDialogParams:function(b){var d={loadingText:"Loading...",savingText:"",closingText:"",style:"minimal",overlay:this.params.overlayOpacity,width:460,top:280,closeOthers:false,closeable:!this.params.disableOverlayCancel,disableOverlayCancel:this.params.disableOverlayCancel,buttons:[(b.invalidRecoveryId?{type:"login",title:"Back To Login"}:{type:"saveAndClose",title:"Update"})],tabs:[{title:"",fields:[]}]};
if(b.invalidRecoveryId){d.tabs[0].fields=[{type:"description",text:"This URL is no longer valid, please go back to login and start over."}]
}else{d.tabs[0].fields=[{type:"description",text:"Hi, <strong>"+b.displayName+"</strong>"},{type:"description",text:"Please enter your new account password for the account with email: <strong>"+b.email+"</strong>."},{type:"text",required:true,name:"password",password:true,title:"New Password",style:"title",titleStyle:"inline",submitOnEnter:true}]
}d.tabs[0].title="Password Reset";
d.tabs[0].icon="/universal/images-v6/dialog/dialog-icon-member.png";
return d
},bindPasswordResetDialog:function(b,c){b.on("button-login",function(){document.location.replace(document.location.pathname)
});
b.on("send-requested",function(){var d=this.dialog.getData();
d.email=this.params.email;
d.recoveryId=this.params.recoveryId;
a.Data.sendForm(this.dialog,{data:d,url:"/api/auth/PasswordReset",secure:true,success:function(e){this.dialog.close();
document.location.replace(document.location.pathname)
},failure:function(e){}},{that:this.that,dialog:b})
},{dialog:b,params:c})
},passwordResetConfirmation:function(d){var e=this.getPasswordResetDialogParams(d);
var b=new a.Squarespace.EditingDialog(e);
this.bindPasswordResetDialog(b,d);
b.show()
},accountActivationConfirmation:function(d){d.recoveryId=d.activationId;
var e=this.getPasswordResetDialogParams(d);
if(!d.invalidRecoveryId){e.tabs[0].fields=[{type:"description",text:"Welcome, <strong>"+d.displayName+"</strong>"},{type:"description",text:"To Activate your account you need to first set your account password associated with the email: <strong>"+d.email+"</strong>."},{type:"text",required:true,name:"password",password:true,title:"New Password",style:"title",titleStyle:"inline",submitOnEnter:true}];
e.tabs[0].title="Activate Account"
}var b=new a.Squarespace.EditingDialog(e);
this.bindPasswordResetDialog(b,d);
b.show()
},showBigText:function(b){if(b==="login"){if(a.one(".bigtext")){a.one(".bigtext").one(".title").set("innerHTML","Accept Invitation");
a.one(".bigtext").one(".description").set("innerHTML","You have been invited to manage this account by <strong>"+this.params.invitingMember.displayName+"</strong>.  <br/>Sign in or create an account below to get started.")
}}else{if(b==="create"){if(a.one(".bigtext")){a.one(".bigtext").one(".title").set("innerHTML","Create Account");
a.one(".bigtext").one(".description").set("innerHTML","Use this form to create a new Squarespace account for use across our system.")
}}}},onLoginComplete:function(d,c){window.SQUARESPACE_LOGIN.account=d;
var b=a.Squarespace.Utils.userHasAccessPermission(a.Squarespace.AccessPermissions.CONFIG);
if(SQUARESPACE_LOGIN.loginRPCProvider){console.log("interupting login redirect");
window.SQUARESPACE_LOGIN.fire("iframeLogin",c)
}else{if(this.params.redirectAfterLogin||this.params.reloadAfterLogin){if(c){if(c===window.location.href){window.location.reload()
}else{window.location.replace(c)
}return
}else{new a.Squarespace.Alert().show("No Administrative Privileges","Your Squarespace account is not listed as an administrator on any sites.")
}}else{window.SQUARESPACE_LOGIN.fire("login");
if(this.params.globalLogin){a.Global.fire("squarespace:login")
}this.reset()
}}},logout:function(b){if(b){b.halt()
}if(this.loggingOut||!Static.SQUARESPACE_CONTEXT.authenticatedAccount){return
}this.loggingOut=true;
a.Data.post({url:"/api/auth/Logout",secure:true,success:function(c){this.account=null;
delete window.SQUARESPACE_LOGIN.account;
delete Static.SQUARESPACE_CONTEXT.authenticatedAccount;
delete Static.SQUARESPACE_CONTEXT.permissions;
window.SQUARESPACE_LOGIN.fire("logout");
a.Global.fire("squarespace:logout");
if(this.memberAccount&&this.memberAccount.editor){this.memberAccount.editor.close()
}a.all(".sqs-layout[data-type=block-field]").each(function(e){var d=e.getData("layoutengine");
if(d){d.destroy()
}e.removeClass("editing")
});
document.location.href="http://"+document.location.host+"/?logout=true";
this.loggingOut=false
}},this)
},_buildIFrameLoginDialog:function(){this.buildDialog();
this.dialogParameters.overlay=0.8
},_showLoginInIframe:function(b,d,c){SQUARESPACE_LOGIN.params.disableCreateAccount=true;
SQUARESPACE_LOGIN.params.externalSwitcher=true;
SQUARESPACE_LOGIN.params.allowSocialLogins=false;
if(this.loginDialog){this.loginDialog=null;
this.dialogParameters=null
}this._buildIFrameLoginDialog(b,d,c);
this.show();
SQUARESPACE_LOGIN.on("cancel",function(){SQUARESPACE_LOGIN.loginRPCProvider.hide()
});
SQUARESPACE_LOGIN.on("iframeLogin",function(f){f=f+"&redirectUrl=/config/iframelogin";
var e=a.Node.create('<iframe style="position:fixed; top:-2000px;" src="'+f+'"></div>');
e.on("load",function(){var g=f.substring(0,f.indexOf("/",10));
SQUARESPACE_LOGIN.loginRPCProvider.redirect(g+"/config")
});
a.one("body").append(e)
})
},loadRPCProvider:function(){try{this.loginRPCProvider=new easyXDM.Rpc({},{local:{show:function(){SQUARESPACE_LOGIN._showLoginInIframe()
}},remote:{redirect:{},hide:{},remove:{}}})
}catch(b){console.log("failed to load RPC",b)
}},_loadRPCConsumer:function(b){this.loginRPCConsumer=new easyXDM.Rpc({remote:"https://oauth."+Static.SQUARESPACE_CONTEXT.appDomain+"/config/iframeLogin",container:b,props:{style:{width:"100%",height:"100%",top:0,left:0,position:"fixed",zIndex:30040}}},{local:{redirect:function(c){window.location.replace(c)
},hide:function(){SQUARESPACE_LOGIN.iFrameLoginHide()
},remove:function(){SQUARESPACE_LOGIN.iFrameLoginRemove()
}},remote:{show:{}}})
},iFrameLoginLoad:function(){var b=a.Node.create('<div class="login-wrapper hidden" ></div>');
a.one("body").append(b);
this._loadRPCConsumer(b.getDOMNode())
},iFrameLoginShow:function(b){if(b){b.preventDefault()
}if(!this.loginRPCConsumer){SQUARESPACE_LOGIN.iFrameLoginLoad()
}this.loginRPCConsumer.show();
a.one(".login-wrapper").removeClass("hidden")
},iFrameLoginHide:function(){a.one(".login-wrapper").addClass("hidden")
},iFrameLoginRemove:function(){this.loginRPCConsumer.destroy();
delete this.loginRPCConsumer;
a.one(".login-wrapper").remove()
}});
a.augment(window.SQUARESPACE_LOGIN,a.EventTarget)
}},"1.0",{requires:["squarespace-util","squarespace-dialog-hidden","thirdparty-easyxdm","ui-base-css"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-ui-base",function(b){b.mix(b.Node.DOM_EVENTS,{message:true});
b.namespace("Squarespace");
b.Squarespace.DIALOG_ZINDEX_BASE=30000;
b.Anim._intervalTime=10;
b.Squarespace.Debug={dumpDDs:function(){for(var d=0;
d<b.DD.DDM.targets.length;
++d){var c=b.DD.DDM.targets[d];
console.log(d,c.get("node").get("className"))
}}};
var a=function(c){b.Squarespace.DDBehavior.superclass.constructor.apply(this,arguments)
};
a.NAME="DDBehavior";
a.NS="ddb";
a.ATTRS={host:{},validHandleClass:{}};
b.extend(a,b.Plugin.Base,{initializer:function(c){var d=this.get("host");
for(var e in c.behaviors){if(e.indexOf("drop:")!=-1&&d.target){d.target.on(e,c.behaviors[e],c.context)
}else{d.on(e,c.behaviors[e],c.context)
}}}});
b.Squarespace.DDBehavior=a;
b.Squarespace.SimpleFlexibleGrid=b.Base.create("SimpleFlexibleGrid",b.Plugin.Base,[],{initializer:function(){this._stylesheetEl=b.Node.create("<style></style>");
this.get("host").append(this._stylesheetEl);
this._resizeEvent=b.on("resize",this.syncUI,b.config.win,this);
this.syncUI()
},syncUI:function(){var c;
if(this.get("minWidth")){c=Math.floor(this.get("container").get("offsetWidth")/this.get("minWidth"))
}else{c=Math.ceil(this.get("container").get("offsetWidth")/this.get("maxWidth"))
}this._stylesheetEl.set("innerHTML",this.get("selector")+"{width:"+(100/c)+"% !important;}");
this.get("host").fire("simpleFlexibleGridSyncUI")
},destructor:function(){this._stylesheetEl.remove();
this._resizeEvent.detach()
}},{ATTRS:{container:{},selector:{},maxWidth:{},minWidth:{}},NS:"simple-flexible-grid"});
b.Squarespace.Mouse={lastX:100,lastY:100};
b.on(b.UA.mobile?"touchmove":"mousemove",function(c){b.Squarespace.Mouse.lastX=c.pageX;
b.Squarespace.Mouse.lastY=c.pageY
},b.one(document.body));
b.Squarespace.Image={loadAndFit:function(d,e){var c=new Image();
c.src=e;
b.one(c).on("load",function(h,g,f){g.set("src",f.src);
g.resizeToParent({scale:"cover"})
},this,d,c)
},rotate:function(d,c,i){var l=d.get("parentNode").get("offsetWidth");
var n=d.get("parentNode").get("offsetHeight");
var k=d.get("offsetWidth");
var j=d.get("offsetHeight");
var h=b.Squarespace.LoaderUtils.evaluateModeDimensions({mode:"fit",containerWidth:l,containerHeight:n,data:{dimensions:{width:k,height:j}}});
var m=b.Squarespace.LoaderUtils.evaluateModeDimensions({mode:"fit",containerWidth:n,containerHeight:l,data:{dimensions:{width:k,height:j}}});
var f,g;
if(i%180===0){f=h;
g=m
}else{f=m;
g=h
}var e=new b.Anim({node:d,from:{rotate:i,width:f.width,height:f.height,left:(l-f.width)/2,top:(n-f.height)/2},to:{rotate:c,width:g.width,height:g.height,top:(n-g.height)/2,left:(l-g.width)/2},easing:b.Easing.easeBothStrong,duration:0.3});
e.run()
},straighten:function(e,j,g,d){var f=(d<0?360-d:d)%360,c=f;
if(f>=90){c=f%90-90
}if(f>=180){c=-1*f%180-180
}if(f>=270){c=f%270-90
}var i=Math.abs(c)*(Math.PI/180);
var h;
if(g>j){h=(j*Math.cos(i)+g*Math.sin(i))/j
}else{h=(g*Math.cos(i)+j*Math.sin(i))/g
}e.setStyle("transform","rotate("+d+"deg) scale("+Math.abs(h)+")")
}};
b.Squarespace.Position=Class.create({initialize:function(c){this.EDGE_MARGIN=20;
this.avoidElX=c.avoidElX;
this.avoidElY=c.avoidElY;
this.xdir=c.xdir;
this.ydir=c.ydir;
this.x=c.x;
this.y=c.y;
this.xo=(c.xo?c.xo:0);
this.yo=(c.yo?c.yo:0);
this.w=c.w;
this.h=c.h;
this.initialX=this.getX();
this.initialY=this.getY()
},setX:function(c){this.x=c
},setY:function(c){this.y=c
},getX:function(){return this.x+this.getXO()
},getY:function(){return this.y+this.getYO()
},getXAdj:function(){return this.initialX-this.getX()
},getYAdj:function(){return this.initialY-this.getY()
},getXO:function(){return((this.avoidElX&&this.xdir=="right")?this.avoidElX.get("offsetWidth"):0)+this.xo
},getYO:function(){return((this.avoidElY&&this.ydir=="top")?-this.avoidElY.get("offsetHeight"):0)+this.yo
},isRightViolation:function(){return((this.x+this.w-Math.abs(this.getXO())+this.EDGE_MARGIN)>b.one(document.body).get("winWidth"))
},isLeftViolation:function(){return((this.x-Math.abs(this.getXO())-this.EDGE_MARGIN)<0)
},isTopViolation:function(){return((this.y-Math.abs(this.getYO())-this.EDGE_MARGIN)<b.one(document.body).get("docScrollY"))
},isBottomViolation:function(){return((this.y+this.h-Math.abs(this.getYO())+this.EDGE_MARGIN)>(b.one(document.body).get("winHeight")+b.one(document.body).get("docScrollY")))
},reflectFix:function(){if(this.xdir=="right"&&this.isRightViolation()){this.xdir="left";
this.getX=function(){return this.x-this.w-this.getXO()+11
}
}else{if(this.xdir=="left"&&this.isLeftViolation()){this.xdir="right";
this.getX=function(){return this.x+this.w+this.getXO()
}
}}if(this.ydir=="bottom"&&this.isBottomViolation()){this.ydir="top";
this.getY=function(){return this.y-this.h-this.getYO()
};
console.log("bottom violation .. now "+this.getY())
}else{if(this.ydir=="top"&&this.isTopViolation()){this.ydir="bottom";
this.getY=function(){return this.y+this.h+this.getYO()
};
console.log("top violation")
}}if((this.getY()-this.EDGE_MARGIN)<0){this.getY=function(){return b.one(document.body).get("winHeight")-this.h-this.EDGE_MARGIN
};
this.ydir="bottom"
}else{if((this.getY()+this.h+this.EDGE_MARGIN)>(b.one(document.body).get("winHeight")+b.one(document.body).get("docScrollY"))){this.getY=function(){return b.one(document.body).get("winHeight")+b.one(document.body).get("docScrollY")-this.EDGE_MARGIN-this.h
};
this.ydir="top"
}}if((this.getX()-this.EDGE_MARGIN)<0){this.getX=function(){return this.EDGE_MARGIN
};
this.ydir="left"
}else{if((this.getX()+this.w+this.EDGE_MARGIN)>(b.one(document.body).get("winWidth"))){this.getX=function(){return b.one(document.body).get("winWidth")-this.w-this.EDGE_MARGIN
};
this.ydir="right"
}}if(this.getY()<b.one(document.body).get("docScrollY")){console.log("fixing y offscreen issues.");
this.yo=(b.one(document.body).get("docScrollY")+this.EDGE_MARGIN)-this.y
}},nudgeFix:function(){if(this.isRightViolation()){this.getX=function(){return b.one(document.body).get("winWidth")+b.one(document.body).get("docScrollX")-this.w-this.EDGE_MARGIN
}
}else{if(this.isLeftViolation()){this.getX=function(){return this.EDGE_MARGIN
}
}}if(this.isBottomViolation()){this.getY=function(){return b.one(document.body).get("winHeight")+b.one(document.body).get("docScrollY")-this.h-this.EDGE_MARGIN
}
}else{if(this.isTopViolation()){this.getY=function(){return this.EDGE_MARGIN
}
}}},overflowFix:function(){if(this.isRightViolation()){this.x=b.one(document.body).get("winWidth")+b.one(document.body).get("docScrollX")-this.w-this.EDGE_MARGIN
}else{if(this.isLeftViolation()){this.x=this.EDGE_MARGIN
}}if(this.isBottomViolation()){this.y=b.one(document.body).get("winHeight")+b.one(document.body).get("docScrollY")-this.h-this.EDGE_MARGIN
}else{if((this.y-Math.abs(this.getXO())-this.EDGE_MARGIN)<0){this.y=this.EDGE_MARGIN
}}}});
b.Squarespace.ToolTipManager={canShow:true,disableTooltips:function(){this.canShow=false;
if(this.currentTip){this.currentTip.hide();
this.currentTip=null
}},enableTooltips:function(){this.canShow=true
}};
b.Squarespace.ToolTip=Class.create({initialize:function(d){this.params=d;
var c=b.all(this.params.target);
if(c.size()==0){console.warn("Couldn't find ToolTip target: "+this.params.target);
return
}if(this.params.showTimeout===undefined){this.params.showTimeout=1200
}if(this.params.width===undefined){this.params.width=250
}if(this.params.style===undefined){this.params.style="info"
}this.mouseOffset=15;
this.events=[c.on("mousemove",function(f){this.lastX=f.pageX;
this.lastY=f.pageY;
this.move();
if(this.showTimer){return
}this.showTimer=b.later(this.params.showTimeout,this,this.show)
},this),c.on("mouseout",function(f){if(this.showTimer){this.showTimer.cancel();
this.showTimer=null
}this.hide()
},this),c.on("click",function(f){if(!this.params.clickToShow){this.hide()
}else{this.show();
f.halt()
}},this),b.Global.on("manager:change-mode",function(f){this.hide()
},this)]
},destroy:function(){for(var c=0;
c<this.events.length;
++c){this.events[c].detach()
}if(this.el){this.el.remove();
this.el=null
}this.events=[];
this.destroyed=true;
this.shown=false
},move:function(){if(!this.el){return
}this.position.x=this.lastX;
this.position.y=this.lastY;
if(this.a){this.el.setStyles({left:this.position.getX()+"px"})
}else{this.el.setStyles({left:this.position.getX()+"px",top:this.position.getY()+"px"})
}},show:function(){if(this.el||this.destroyed||this.shown){return
}if(!b.Squarespace.ToolTipManager.canShow&&!this.params.dialogTooltip){return
}this.el=b.DB.DIV("sqsp-tooltip "+this.params.style,b.DB.DIV("title",{html:this.params.title}),(this.params.body?b.DB.DIV("description",{html:this.params.body}):null));
b.one(document.body).append(this.el);
this.position=new b.Squarespace.Position({xdir:"right",ydir:"bottom",x:this.lastX,y:this.lastY,xo:this.mouseOffset,yo:this.mouseOffset,w:this.el.get("offsetWidth"),h:this.el.get("offsetHeight")});
this.position.reflectFix();
this.el.setStyles({left:this.position.getX()+"px",top:(this.position.getY()-this.position.yo)+"px",width:(this.params.width)+"px",zIndex:1000000,opacity:0});
if(this.params.icon){this.el.setStyle(backgroundImage,"url("+this.params.icon+")")
}this.shown=true;
this.a=new b.Anim({node:this.el,to:{top:this.position.getY(),opacity:1},duration:0.3,easing:b.Easing.easeOutStrong});
this.a.on("end",function(){this.a=null
},this);
this.a.run();
b.Squarespace.ToolTipManager.currentTip=this
},hide:function(){if(!this.el){return
}var c=new b.Anim({node:this.el,to:{top:(this.position.getY()+15),opacity:0},duration:0.3,easing:b.Easing.easeOutStrong});
c.on("end",function(){this.get("node").remove()
});
c.run();
this.el=null;
this.a=null;
this.shown=false
}});
b.Squarespace.CURRENT_CONFIRMATION_DIALOG=null;
b.Squarespace.ConfirmationDialog=Class.create({defaultOpts:{width:230,className:"question",position:"mouse",extreme:false,escToCancel:true,style:"proceedOrCancel",confirmText:"Confirm",showSaveOverlay:true,screenOverlayOpacity:0.5,showScreenOverlay:true},initialize:function(c){this.params=b.merge(this.defaultOpts,c);
this.finished=false;
this.ignoreBodyClicks=true;
if(!this.params.zIndex){b.Squarespace.DIALOG_ZINDEX_BASE+=10;
this.zIndex=b.Squarespace.DIALOG_ZINDEX_BASE
}else{this.zIndex=this.params.zIndex
}},getFields:function(){if(this.params.fields){return this.params.fields
}else{return[]
}},getButtons:function(){if(this.params.style=="confirmOrReject"){return[b.DB.DIV("cancel",{html:"Cancel"}),b.DB.INPUT("reject",{type:"button",value:this.params.rejectText}),b.DB.INPUT("proceed",{type:"button",value:this.params.confirmText})]
}else{if(this.params.style=="proceedOrCancel"){return[b.DB.DIV("cancel",{html:"Cancel"}),b.DB.INPUT("proceed",{type:"button",value:this.params.confirmText})]
}else{if(this.params.style=="confirmOnly"){return[b.DB.INPUT("proceed",{type:"button",value:this.params.confirmText})]
}}}},showChoice:function(h,e,f,g,d,i,c){this.params.style="confirmOrReject";
this.params.confirmText=f;
this.params.rejectText=d;
this.params.onReject=i;
this.show(h,e,g,c)
},showScreenOverlay:function(){if(this.overlayEl){this.fire("overlay-shown")
}else{var d=b.one(document).get("winWidth");
var e=b.one(document).get("winHeight");
this.overlayEl=b.DB.DIV("dialog-screen-overlay "+(this.params.extreme?"extreme":""));
this.overlayEl.setStyles({height:e+"px",width:d+"px"});
this.overlayEl.setStyle("zIndex",(this.zIndex+10));
b.one(document.body).append(this.overlayEl);
var c=new b.Anim({node:this.overlayEl,to:{opacity:this.params.screenOverlayOpacity},duration:0.1,easing:b.Easing.easeOutStrong});
c.on("end",function(){this.fire("overlay-shown")
},this);
c.run()
}},hideScreenOverlay:function(){if(this.overlayEl){var c=new b.Anim({node:this.overlayEl,to:{opacity:0},duration:0.1,easing:b.Easing.easeOutStrong});
c.on("end",function(){this.fire("overlay-hidden");
if(this.overlayEl){this.overlayEl.remove();
delete this.overlayEl
}},this);
c.run()
}else{this.fire("overlay-hidden")
}},show:function(g,e,f,d){if(this.finished){return
}this._disableDragSelection();
if(!f){f=this.params.onSuccess||function(){}
}if(!d){d=this.params.scope||this
}this.params.confirmText=this.params.confirmText||g;
if(b.Squarespace.CURRENT_CONFIRMATION_DIALOG){b.Squarespace.CURRENT_CONFIRMATION_DIALOG.hide()
}if(this.params.escToCancel){b.Squarespace.CURRENT_CONFIRMATION_DIALOG=this
}if(g){this.params.title=g
}if(e){this.params.message=e
}if(d){this.params.scope=d
}if(f){this.params.onSuccess=f
}if(this.params.showSaveOverlay){if(this.params.scope&&this.params.scope.on&&this.params.scope.showSaveOverlay){this.params.scope.on("close",this.answer,this,null,false);
this.params.scope.on("cancel",this.answer,this,null,false);
this.params.scope.showSaveOverlay(true)
}}var c=b.bind(function(){b.Squarespace.EscManager.addTarget(this);
this.el=b.DB.DIV("sqsp-tooltip clear "+this.params.className,{style:"width: "+this.params.width+"px"},(this.params.spinner!==undefined?b.DB.DIV("spinner"):""),b.DB.DIV("title",{html:this.params.title}),(this.params.message!==undefined?b.DB.DIV("description",{html:this.params.message}):""),(this.getFields()?b.DB.DIV("fields",this.getFields()):null),(this.getButtons()?b.DB.DIV("buttons",this.getButtons()):null));
this.el.on("click",function(m){m.stopPropagation()
},this);
var i=this.el.one(".cancel");
if(i){i.on("click",this.answer,this,false)
}if(this.getButtons()){if(this.el.one(".proceed")){this.el.one(".proceed").on("click",this.answer,this,true,"proceed")
}if(this.el.one(".reject")){this.el.one(".reject").on("click",this.answer,this,true,"reject")
}}if(this.params.clickToClose){this.el.once("click",this.hide,this,true)
}b.one(document.body).append(this.el);
var h,l;
if(this.params.position=="mouse"){h=b.Squarespace.Mouse.lastX;
l=b.Squarespace.Mouse.lastY;
this.position=new b.Squarespace.Position({xdir:"right",ydir:"bottom",x:h,y:l,xo:-150,yo:-80,w:this.el.get("offsetWidth"),h:this.el.get("offsetHeight")});
this.position.nudgeFix();
this.el.setStyles({position:"absolute",left:(this.position.getX())+"px",top:this.position.getY()+"px",zIndex:1000000,opacity:0})
}else{if(this.params.position=="anchor"&&this.params.anchorEl){var k=b.one(this.params.anchorEl);
h=k.getX();
l=k.getY();
this.position=new b.Squarespace.Position({xdir:"right",ydir:"bottom",x:h,y:l,xo:-150,yo:-80,w:this.el.get("offsetWidth"),h:this.el.get("offsetHeight")});
this.position.nudgeFix();
this.el.setStyles({position:"absolute",left:this.position.getX()+"px",top:this.position.getY()+"px",zIndex:1000000,opacity:0})
}else{if(this.params.position=="center"){var l=(b.one(document.body).get("winHeight")/2-this.el.get("offsetHeight")/2),h=(b.one(document.body).get("winWidth")/2-this.el.get("offsetWidth")/2);
this.el.setStyles({position:"fixed",left:h+"px",top:l+"px",zIndex:1000000,opacity:0})
}else{if(this.params.position.indexOf("top")!=-1){l=20
}else{l=(b.one(document.body).get("winHeight")-this.el.get("offsetHeight"))-20
}if(this.params.position.indexOf("right")!=-1){h=(b.one(document.body).get("winWidth")-this.el.get("offsetWidth"))-20
}else{h=20;
b.all(".config-panel").each(function(m){h+=m.get("offsetWidth")
})
}if(this.params.position=="lower-left"){this.el.setStyles({position:"fixed",left:(parseInt(b.one(".config-panel.root").getComputedStyle("width"),10)+10)+"px",bottom:"20px",zIndex:1000000,opacity:0})
}else{if(this.params.position=="top-center"){var h=(b.one(document.body).get("winWidth")/2-this.el.get("offsetWidth")/2);
this.el.setStyles({position:"fixed",left:h+"px",top:"20px",zIndex:1000000,opacity:0})
}else{if(this.params.position.indexOf("bottom")!=-1){this.el.setStyles({position:"fixed",left:h+"px",bottom:"20px",zIndex:1000000,opacity:0})
}else{this.el.setStyles({position:"fixed",left:h+"px",top:l+"px",zIndex:1000000,opacity:0})
}}}}}}var j=b.Squarespace.Transitions.getTransition({el:this.el,name:"scale",direction:"in"});
if(this.el.one(".proceed")){this.el.one(".proceed").focus()
}j.run();
if(this.params.autoHide){this.hideTimer=b.later(this.params.autoHide,this,this.hide)
}},this);
if(this.params.showScreenOverlay){this.showScreenOverlay();
this.once("overlay-shown",c)
}else{c()
}},setCenter:function(c){this.el.setStyles({left:c.left-this.el.get("offsetWidth")/2,top:c.top-this.el.get("offsetHeight")/2})
},answer:function(d,f,c){if(this.finished){return
}if(d){d.halt()
}this.hide(f);
if(f){if(c=="proceed"){if(this.params.scope){this.params.onSuccess.apply(this.params.scope)
}else{this.params.onSuccess()
}}else{if(this.params.scope){this.params.onReject.apply(this.params.scope)
}else{this.params.onReject()
}}}else{if(this.params.onCancel){this.params.onCancel.apply(this.params.scope||this)
}}},close:function(){this.hide(false)
},hide:function(d){this.finished=true;
if(this.pulseAnim){this.pulseAnim.stop()
}if(this.hideTimer){this.hideTimer.cancel();
this.hideTimer=null
}if(this.params.showSaveOverlay){if(this.params.scope&&this.params.scope.on&&this.params.scope.hideSaveOverlay){this.params.scope.hideSaveOverlay(0.3)
}}var c=b.bind(function(){if(b.Squarespace.EscManager){b.Squarespace.EscManager.removeTarget(this)
}var e=b.Squarespace.Transitions.getTransition({el:this.el,name:"scale",direction:"out"});
e.on("end",function(g,f){if(f){f.remove()
}this.fire("hidden")
},this,this.el);
e.run();
this.el=null;
this.a=null;
if(this.params.escToCancel){b.Squarespace.CURRENT_CONFIRMATION_DIALOG=null
}this._revertDragSelection()
},this);
this.once("overlay-hidden",c);
this.hideScreenOverlay()
},_disableDragSelection:function(){if(b.Squarespace.DragSelection){this._lastDragSelectionStatus=b.Squarespace.DragSelection.get("enabled");
b.Squarespace.DragSelection.disable()
}},_revertDragSelection:function(){if(this._lastDragSelectionStatus){if(b.Squarespace.DragSelection){b.Squarespace.DragSelection.set("enabled",this._lastDragSelectionStatus)
}}}});
b.augment(b.Squarespace.ConfirmationDialog,b.EventTarget);
b.Squarespace.Alert=Class.extend(b.Squarespace.ConfirmationDialog,{initialize:function(c){if(!c){c={}
}c.className="alert";
c.showScreenOverlay=false;
b.Squarespace.Alert.prototype.superclass.initialize.call(this,c)
},getButtons:function(){return[b.DB.INPUT("proceed",{type:"button",value:"Ok"})]
}});
b.Squarespace.Notice=Class.extend(b.Squarespace.ConfirmationDialog,{initialize:function(c){if(!c){c={}
}c.className="okay";
c.showScreenOverlay=false;
b.Squarespace.Alert.prototype.superclass.initialize.call(this,c)
},getButtons:function(){return[b.DB.INPUT("proceed",{type:"button",value:"Ok"})]
}});
b.Squarespace.Information=Class.extend(b.Squarespace.ConfirmationDialog,{initialize:function(c){if(!c){c={}
}c=b.merge({className:"okay",autoHide:2000,clickToClose:true,escToCancel:false,showScreenOverlay:false},c);
b.Squarespace.Alert.prototype.superclass.initialize.call(this,c)
},getButtons:function(){return null
}});
b.Squarespace.Loading=Class.extend(b.Squarespace.ConfirmationDialog,{initialize:function(c){if(!c){c={}
}c.className="loading";
c.clickToClose=false;
c.escToCancel=false;
c.spinner=true;
b.Squarespace.Loading.prototype.superclass.initialize.call(this,c)
},show:function(f,d,e,c){this._super(f,d,e,c)
},hide:function(c){if(c===undefined){c=0
}setTimeout(b.bind(this._super,this),c)
},getButtons:function(){return null
}});
b.Squarespace.OptionConfirmationDialog=Class.extend(b.Squarespace.ConfirmationDialog,{initialize:function(c){if(!c){c={}
}c.clickToClose=false;
c.escToCancel=false;
b.Squarespace.Loading.prototype.superclass.initialize.call(this,c)
},getFields:function(){this.active=true;
var c=this.params.optionConfig;
this.checkEl=b.DB.DIV("field-wrapper check-field-wrapper clear thin",(c.padding?{style:"padding-top: "+c.padding[0]+"; padding-bottom: "+c.padding[1]+";"}:null),b.DB.DIV("check-element "+(this.active?"active":""),((c.title)?b.DB.DIV("field-title",{html:c.title}):null),(c.description?b.DB.DIV("field-description-wrapper",b.DB.DIV("field-description",{html:c.description})):null)));
this.checkEl.on("click",this.onClick,this);
return[this.checkEl]
},onClick:function(c){this.setValue(!this.active)
},getValue:function(){return this.active
},setValue:function(c){this.active=c;
if(this.active){this.checkEl.one(".check-element").addClass("active")
}else{this.checkEl.one(".check-element").removeClass("active")
}}});
b.Squarespace.Lightbox=Class.create({defaultOpts:{overlayShowDuration:0.35,contentShowDuration:0.6,margin:0,opacity:1,transition:"fade",clickAnywhereToExit:true,name:null,theme:"black",overlayStyle:"orb"},name:"Lightbox",initialize:function(c){this.enabled=true;
this.params=b.merge(this.defaultOpts,c);
if(!this.params.transition){this.params.transition="fade"
}if(!this.params.zIndex){b.Squarespace.DIALOG_ZINDEX_BASE+=10;
this.params.zIndex=b.Squarespace.DIALOG_ZINDEX_BASE
}this.events=[]
},enable:function(){this.enabled=true;
this.overlayEl.setStyle("display","block")
},disable:function(){this.enabled=false;
this.overlayEl.setStyle("display","none")
},getContentEl:function(){return this.contentEl
},show:function(){var d=b.one(document).get("winWidth");
var f=b.one(document).get("winHeight");
var e="sqs-lightbox"+(this.params.name?" sqs-lightbox-"+this.params.name:"");
this.contentEl=b.DB.DIV(e,(b.Lang.isString(this.params.content)?{html:this.params.content}:this.params.content));
this.contentEl.setStyles({position:"fixed",opacity:"0",overflow:"hidden",zIndex:(this.params.zIndex)});
this.events.push(b.on("resize",this.position,b.one(window),this));
if(!this.params.disableNormalClose){b.Squarespace.EscManager.addTarget(this)
}b.one(document.body).append(this.contentEl);
if(!this.params.contentOnly){var c="sqs-lightbox-overlay"+(this.params.name?" sqs-lightbox-overlay-"+this.params.name:"")+" "+this.params.theme;
if(this.params.name){c+=" sqs-lightbox-overlay-"+this.params.name
}if(this.params.overlayStyle){c+=" sqs-lightbox-overlay-style-"+this.params.overlayStyle
}this.overlayEl=b.DB.DIV(c);
this.overlayEl.setStyles({zIndex:this.params.zIndex-1});
b.one(document.body).append(this.overlayEl);
this.fire("showing");
this.a=b.Squarespace.Transitions.getTransition({el:this.overlayEl,opacity:this.params.opacity,name:"fade",direction:"in",duration:this.params.overlayShowDuration});
this.a.on("end",function(){this.fire("overlay-visible");
this.a=null;
this._showContent()
},this);
this.a.run();
if(!this.params.disableNormalClose){this.events.push(b.on("click",this.close,this.overlayEl,this))
}}else{this._showContent()
}if(this.params.clickAnywhereToExit){this.events.push(b.on("click",this.hide,this.contentEl,this))
}},position:function(){if(!this.enabled){return
}var g=b.one(document).get("winWidth");
var d=b.one(document).get("winHeight");
var f,c;
if(g<this.naturalW+(this.params.margin*2)){f=g-(this.params.margin*2)
}else{f=this.naturalW
}if(d<this.naturalH+(this.params.margin*2)){c=d-(this.params.margin*2)
}else{c=this.naturalH
}var h=(g-f)/2;
var e=(d-c)/2;
if(this.contentAttached){this.contentEl.setStyles({left:h+"px",top:e+"px",width:f+"px"});
if(!this.params.noHeightConstrain){this.contentEl.setStyles({height:c+"px"})
}if(this.resizeTarget){this.resizeTarget.resizeToParent({scale:"contain"})
}}this.fire("position",{width:f,height:c,verticalWidth:g,verticalHeight:d,maxWidth:g-(this.params.margin*2),maxHeight:d-(this.params.margin*2)})
},_showContent:function(){this.contentAttached=true;
this.resizeTarget=this.contentEl.one(".resize-target");
this.naturalW=this.contentEl.get("offsetWidth");
this.naturalH=this.contentEl.get("offsetHeight");
this.position();
this.fire("content-ready");
var c=b.Squarespace.Transitions.getTransition({el:this.contentEl,name:this.params.transition,direction:"in",duration:this.params.contentShowDuration});
c.on("end",function(){this.fire("content-visible")
},this);
c.run()
},close:function(c){if(!this.params.clickAnywhereToExit){if(!c||this.overlayEl.compareTo(c.target)){return
}}this.hide()
},hide:function(){if(!this.enabled){return
}if(this.a){this.a.stop()
}this.a=null;
this.fire("hiding");
b.Squarespace.EscManager.removeTarget(this);
if(this.overlayEl){var c=b.Squarespace.Transitions.getTransition({el:this.overlayEl,name:"fade",direction:"out",duration:this.params.overlayShowDuration});
if(this.params.overlayShowDuration>this.params.contentShowDuration){this.a=c
}c.run()
}var c=b.Squarespace.Transitions.getTransition({el:this.contentEl,name:this.params.transition,direction:"out",duration:this.params.contentShowDuration});
if(!this.a){this.a=c
}c.run();
this.a.on("end",function(){this.destroy();
this.fire("hidden")
},this)
},destroy:function(){for(var c=0;
c<this.events.length;
++c){this.events[c].detach()
}if(this.contentEl){this.contentEl.remove()
}if(this.overlayEl){this.overlayEl.remove()
}this.contentEl=null;
this.overlayEl=null;
this.events=[]
}});
b.augment(b.Squarespace.Lightbox,b.EventTarget);
b.Squarespace.CustomAnim=Class.create({initialize:function(c){this.params=c
},cancel:function(){},stop:function(){}});
b.augment(b.Squarespace.CustomAnim,b.EventTarget);
b.augment(b.Squarespace.CustomAnim,b.Attribute);
b.Squarespace.Transitions={STANDARD_DURATION:0.3,getTransition:function(c){if(!c.el||!c.el._node){console.warn("ui-base: [Transitions] You're trying to animate a non-existent element, returning blank animation");
return new b.Anim()
}if(!c.duration){c.duration=b.Squarespace.Transitions.STANDARD_DURATION
}return b.Squarespace.Transitions.transitionsByName[c.name](c)
},transitionsByName:{fade:function(c){return new b.Anim({node:c.el,to:{opacity:(c.opacity==null?(c.direction=="in"?1:0):c.opacity)},duration:b.Squarespace.Transitions.STANDARD_DURATION,easing:b.Easing.easeOutStrong})
},scale:function(c){return new (Class.extend(b.Squarespace.CustomAnim,{run:function(){if(!c.opacity){c.opacity=1
}if(c.duration==null){c.duration=b.Squarespace.Transitions.STANDARD_DURATION
}var d=this.params.el;
if(this.params.direction=="in"){d.setStyles({transform:"scale(.95)",opacity:0});
b.later(10,d,d.setStyles,{transitionProperty:"transform, opacity",transitionDuration:c.duration+"s",transitionTimingFunction:"ease-out","backface-visibility":"hidden"});
b.later(20,d,d.setStyles,{transform:"scale(1)",opacity:c.opacity})
}else{d.setStyles({transform:"scale(1)",opacity:c.opacity});
b.later(10,d,d.setStyles,{transitionProperty:"transform, opacity",transitionDuration:c.duration+"s",transitionTimingFunction:"ease-out",backfaceVisibility:"hidden"});
b.later(20,d,d.setStyles,{transform:"scale(.95)",opacity:0})
}b.later((c.duration*1000)+100,this,function(){this.fire("end",{_event:true})
})
}}))(c)
},none:function(c){return new (Class.extend(b.Squarespace.CustomAnim,{run:function(){if(this.params.direction=="in"){this.el.setStyle("opacity",1)
}else{this.el.setStyle("opacity",0)
}this.fire("end")
}}))(c)
}}};
b.Squarespace.Effects={bounce:function(c){c.setStyles({transform:"scale(1)"});
b.later(10,c,c.setStyles,{transitionProperty:"transform, opacity",transitionDuration:".2s",transitionTimingFunction:"ease-out",backfaceVisibility:"hidden"});
b.later(20,c,c.setStyles,{transform:"scale(1.3)"});
b.later(200,c,c.setStyles,{transform:"scale(1)"})
},focus:function(d){d.setStyle("outline","4px solid rgba(99, 145, 0, 0.8)");
var c=new b.Anim({node:d,to:{},duration:1.4,easing:b.Easing.easeOutStrong});
c.on("tween",function(g){var f=(1-(this.get("elapsedTime")/(this.get("duration")*1000)));
this.get("node").setStyle("outline","4px solid rgba(99, 145, 0, "+(f)+")")
});
c.on("end",function(){this.get("node").setStyle("outline","")
});
c.run()
},blink:function(d){var c=new b.Anim({node:d,to:{opacity:0},duration:0.6,easing:b.Easing.easeOutStrong});
c.on("end",function(){var e=new b.Anim({node:this.get("node"),to:{opacity:1},duration:0.6,easing:b.Easing.easeOutStrong});
e.on("end",function(){});
e.run()
});
c.run()
}};
b.Squarespace.NodeDestroyNotifier=b.Base.create("NodeDestroyNotifier",b.Plugin.Base,[],{destructor:function(){if(this.get("onDestroy")){this.get("onDestroy").call(this.get("context")||this)
}}},{NS:"nodedestroynotifier",ATTRS:{onDestroy:{},context:{}}});
b.augment(b.Node,Class.create({intersectXY:function(e,d){var c=this.get("region");
return(c.left<e&&e<c.right&&c.top<d&&d<c.bottom)
},forceClass:function(c,d){this[d?"addClass":"removeClass"](c)
},data:function(c){var d=this._node;
if(c){while(d){if(d.data&&d.className.indexOf(c)!=-1){return d.data
}d=d.parentNode
}}else{while(d){if(d.data){return d.data
}d=d.parentNode
}}return(null)
},setNodeData:function(c){this._node.data=c
}}));
b.Squarespace.RelativeTimeDisplay=b.Base.create("RelativeTimeDisplay",b.Plugin.Base,[],{initializer:function(){this.timer=b.later(this.get("interval"),this,this.syncUI,{},true);
this.syncUI()
},syncUI:function(){var c=Math.floor((new Date().getTime()-this.get("date").getTime())/1000);
if(c<60){if(c===0){this.get("host").setContent("just now")
}else{this.get("host").setContent("about "+c+" seconds ago")
}}else{this.get("host").setContent(b.Squarespace.Utils.humanizeDate(this.get("date"),true))
}},destructor:function(){this.timer.cancel()
}},{NS:"RelativeTimeDisplay",CSS_NAMESPACE:"sqs-action-overlay",ATTRS:{date:{valueFn:function(){return new Date()
}},interval:{value:5000}}});
b.Squarespace.PositionAnimator=b.Base.create("PositionAnimator",b.Plugin.Base,[],{initializer:function(){},hold:function(){this.set("originalTop",this.get("host").get("offsetTop"));
this.set("originalLeft",this.get("host").get("offsetLeft"));
this.previousPosition=this.get("host").getStyle("position")
},release:function(){var d=this.get("host").get("offsetTop");
var f=this.get("host").get("offsetLeft");
this.get("host").setStyles({position:"relative",top:this.get("originalTop")-d,left:this.get("originalLeft")-f});
var c=this;
var e=this.get("host").anim({top:0,left:0},{duration:this.get("baseSpeed")+(Math.random()*0.2),end:function(){if(!this.get("node")._node){return
}this.get("node").setStyles({position:this.previousPosition,top:null,left:null});
if(c.get("releasedFn")){c.get("releasedFn")()
}c.fire("released")
}});
setTimeout(function(){e.run()
},200*Math.random())
},destructor:function(){}},{NS:"positionAnimator",ATTRS:{originalTop:{},originalLeft:{},releasedFn:{value:false},baseSpeed:{value:0.2}}})
},"1.0",{requires:["node","base","plugin","event-custom","attribute","squarespace-dombuilder","anim","squarespace-ui-base-css","thirdparty-spinner"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-json-template",function(V){V.namespace("JSONTemplate");
var K="apply ";
function X(a){return a.replace(/([\{\}\(\)\[\]\|\^\$\-\+\?])/g,"\\$1")
}var Z={};
function C(e,c){var a=e+c;
var d=Z[a];
if(d===undefined){var b="("+X(e)+"\\S.*?"+X(c)+"\n?)";
d=new RegExp(b,"g")
}return d
}V.JSONTemplate.DEFAULT_FORMATTERS=V.Squarespace.TEMPLATE_FORMATTERS;
V.JSONTemplate.DEFAULT_PREFIX_FORMATTERS=[{name:"pluralize",func:function(c,e,a){var d,b;
switch(a.length){case 0:d="";
b="s";
break;
case 1:d="";
b=a[0];
break;
case 2:d=a[0];
b=a[1];
break;
default:throw {name:"EvaluationError",message:"pluralize got too many args"}
}return(c==1)?d:b
}},{name:"encode-space",func:function(b,c,a){return b.replace(/\s/g,"&nbsp;")
}},{name:"truncate",func:function(c,d,e){var a=e[0]||100;
var b=e[1]||"...";
if(c&&c.length>a){c=c.substring(0,a);
c=c.replace(/\w+$/,"");
c+=b
}return c
}},{name:"date",func:function(d,f,a){if(!V.Lang.isNumber(d)){return"Invalid date."
}var b=0,e=f.get("website.machineTimeZoneOffset");
if(e&&V.Lang.isNumber(e)){b=parseInt(e)
}var c=a.join(" ");
return V.DataType.Date.format(new Date(d+b),{format:c})
}},{name:"image",func:function(b,c,d){var a;
if(b.mediaFocalPoint){a=b.mediaFocalPoint.x+","+b.mediaFocalPoint.y
}return'<img class="'+(d[0]?d[0]:"thumb-image")+'" '+(b.title?'alt="'+V.Squarespace.Escaping.escapeForHtmlTag(b.title)+'" ':"")+' data-image="'+b.assetUrl+'" data-image-dimensions="'+b.originalSize+'" data-image-focal-point="'+a+'"/>'
}},{name:"timesince",func:function(c,d,a){if(!V.Lang.isNumber(c)){return"Invalid date."
}var b=a.join(" ");
return'<span class="timesince" data-date="'+c+'">'+V.Squarespace.Utils.humanizeDate(c)+"</span>"
}},{name:"resizedHeightForWidth",func:function(f,h,g){var c=f.split("x");
if(c.length!=2){return"Invalid source parameter.  Pass in 'originalSize'."
}var b=parseInt(c[0],10);
var e=parseInt(c[1],10);
var a=parseInt(g[0],10);
var i=a/b;
var d=parseInt(e*i,10);
return d
}},{name:"resizedWidthForHeight",func:function(f,i,g){var d=f.split("x");
if(d.length!=2){return"Invalid source parameter.  Pass in 'originalSize'."
}var c=parseInt(d[0],10);
var e=parseInt(d[1],10);
var a=parseInt(g[0],10);
var b=a/e;
var h=parseInt(c*b,10);
return h
}},{name:"squarespaceThumbnailForWidth",func:function(b,c,a){return V.Squarespace.Rendering.getSquarespaceSizeForWidth(parseInt(a[0],10))
}},{name:"squarespaceThumbnailForHeight",func:function(f,i,g){var d=f.split("x");
if(d.length!=2){return"Invalid source parameter.  Pass in 'originalSize'."
}var c=parseInt(d[0],10);
var e=parseInt(d[1],10);
var a=parseInt(g[0],10);
var b=a/e;
var h=parseInt(c*b,10);
return V.Squarespace.Rendering.getSquarespaceSizeForWidth(h)
}},{name:"cycle",func:function(b,c,a){return a[(b-1)%a.length]
}}];
var H=function(a){return{lookup:function(b){var c=a[b]||null;
return[c,null]
}}
};
var A=function(a){return{lookup:function(b){for(var d=0;
d<a.length;
d++){var e=a[d].name,c=a[d].func;
if(b.slice(0,e.length)==e){var f;
var g=b.charAt(e.length);
if(g===""){f=[]
}else{f=b.split(g).slice(1)
}return[c,f]
}}return[null,null]
}}
};
var S=function(a){return{lookup:function(b){for(var c=0;
c<a.length;
c++){var d=a[c].lookup(b);
if(d[0]){return d
}}return[null,null]
}}
};
function E(b,c){var a=[{context:b,index:-1}];
return{PushSection:function(e){if(e===undefined||e===null){return null
}var d;
if(e=="@"){d=a[a.length-1].context
}else{d=a[a.length-1].context[e]||null
}a.push({context:d,index:-1});
return d
},Pop:function(){a.pop()
},next:function(){var e=a[a.length-1];
if(e.index==-1){e={context:null,index:0};
a.push(e)
}var d=a[a.length-2].context;
if(e.index==d.length){a.pop();
return undefined
}e.context=d[e.index++];
return true
},_Undefined:function(d){if(c===undefined){return null
}else{return c
}},_LookUpStack:function(h){var f=a.length-1;
while(true){var d=a[f];
if(h=="@index"){if(d.index!=-1){return d.index
}}else{var g=d.context;
if(typeof g==="object"){var e=g[h];
if(e!==undefined){return e
}}}f--;
if(f<=-1){return this._Undefined(h)
}}},get:function(g){if(g=="@"){return a[a.length-1].context
}var d=g.split(".");
var e=this._LookUpStack(d[0]);
if(d.length>1){for(var f=1;
f<d.length;
f++){if(e==null){return"[JSONT: Can't resolve '"+g+"'.]"
}e=e[d[f]];
if(e===undefined){return this._Undefined(d[f])
}}}return e
}}
}var T=function(a){var b={};
b.current_clause=[];
b.Append=function(c){b.current_clause.push(c)
};
b.AlternatesWith=function(){throw {name:"TemplateSyntaxError",message:"{.alternates with} can only appear with in {.repeated section ...}"}
};
b.NewOrClause=function(c){throw {name:"NotImplemented"}
};
return b
};
var Q=function(a){var b=T(a);
b.statements={"default":b.current_clause};
b.section_name=a.section_name;
b.Statements=function(c){c=c||"default";
return b.statements[c]||[]
};
b.NewOrClause=function(c){if(c){throw {name:"TemplateSyntaxError",message:"{.or} clause only takes a predicate inside predicate blocks"}
}b.current_clause=[];
b.statements.or=b.current_clause
};
return b
};
var D=function(a){var b=Q(a);
b.AlternatesWith=function(){b.current_clause=[];
b.statements.alternate=b.current_clause
};
return b
};
var R=function(a){var b=T(a);
b.clauses=[];
b.NewOrClause=function(c){c=c||[function(d){return true
},null];
b.current_clause=[];
b.clauses.push([c,b.current_clause])
};
return b
};
function O(a,e,b){for(var f=0;
f<a.length;
f++){var c=a[f];
if(typeof(c)=="string"){b(c)
}else{var d=c[0];
var g=c[1];
d(g,e,b)
}}}function U(e,f,b){var d;
d=f.get(e.name);
for(var g=0;
g<e.formatters.length;
g++){var c=e.formatters[g];
var h=c[0];
var a=c[1];
d=h(d,f,a)
}b(d)
}function L(f,e,b){var c=f;
var d=e.PushSection(c.section_name);
var a=false;
if(d){a=true
}if(d&&d.length===0){a=false
}if(a){O(c.Statements(),e,b);
e.Pop()
}else{e.Pop();
O(c.Statements("or"),e,b)
}}function I(j,d,e){var c=j;
var h=d.get("@");
for(var b=0;
b<c.clauses.length;
b++){var i=c.clauses[b];
var f=i[0][0];
var g=i[0][1];
var k=i[1];
var a=f(h,d,g);
if(a){O(k,d,e);
break
}}}function W(g,d,e){var a=g;
var f=d.PushSection(a.section_name);
var b=true;
if(f&&f.length>0){var i=f.length-1;
var h=a.Statements();
var c=a.Statements("alternate");
for(var j=0;
d.next()!==undefined;
j++){O(h,d,e);
if(j!=i){O(c,d,e)
}}}else{O(a.Statements("or"),d,e)
}d.Pop()
}var F=/(repeated)?\s*(section)\s+(\S+)?/;
var J=/^or(?:[\s\-]+(.+))?/;
var Y=/^if(?:[\s\-]+(.+))?/;
function P(i,k){var e=new S([H(V.JSONTemplate.DEFAULT_FORMATTERS),A(V.JSONTemplate.DEFAULT_PREFIX_FORMATTERS)]);
var n=H(V.JSONTemplate.DEFAULT_PREDICATES);
var am="str";
function q(ab){if(ab.startsWith(K)){var ac=k.partials[ab.substr(K.length)];
if(ac){return[function(ad,ae,af){return V.JSONTemplate.evaluateJsonTemplate(ac,ad)
},null]
}else{throw {name:"BadPartialInclude",message:ab.substr(K)+" is not a valid partial. Remember, loops are not supported (a partial include cannot be included inside itself)."}
}}var aa=e.lookup(ab);
if(!aa[0]){throw {name:"BadFormatter",message:ab+" is not a valid formatter"}
}return aa
}function ap(aa){var ab=n.lookup(aa);
if(!ab[0]){throw {name:"BadPredicate",message:aa+" is not a valid predicate"}
}return ab
}var h=k.format_char||"|";
if(h!=":"&&h!="|"){throw {name:"ConfigurationError",message:"Only format characters : and | are accepted"}
}var aj=k.meta||"{}";
var w=aj.length;
if(w%2==1){throw {name:"ConfigurationError",message:aj+" has an odd number of metacharacters"}
}var y=aj.substring(0,w/2);
var ag=aj.substring(w/2,w);
var ai=C(y,ag);
var an=Q({});
var l=[an];
var ak=y.length;
var b;
var r;
var a=0;
while(true){b=ai.exec(i);
if(b===null){break
}else{var r=b[0]
}if(b.index>a){var x=i.slice(a,b.index);
an.Append(x)
}a=ai.lastIndex;
var d=false;
if(r.slice(-1)=="\n"){r=r.slice(null,-1);
d=true
}r=r.slice(ak,-ak);
if(r.charAt(0)=="#"){continue
}if(r.charAt(0)=="."){r=r.substring(1,r.length);
var z={"meta-left":y,"meta-right":ag,space:" ",tab:"\t",newline:"\n"}[r];
if(z!==undefined){an.Append(z);
continue
}var p,o;
var v=r.match(F);
if(v){var aq=v[1];
var f=v[3];
if(aq){o=W;
p=D({section_name:f})
}else{o=L;
p=Q({section_name:f})
}an.Append([o,p]);
l.push(p);
an=p;
continue
}var m,ao;
var al=r.match(J);
if(al){m=al[1];
ao=m?ap(m):null;
an.NewOrClause(ao);
continue
}var ah=false;
var c=r.match(Y);
if(c){m=c[1];
ah=true;
if(m.indexOf("?")==-1){var g=(function(aa){return function(ab,ac){if(aa.indexOf(" || ")!==-1){var ae=aa.split("||");
for(var ad=0;
ad<ae.length;
ad++){var af=ae[ad].trim();
if(ac.get(af)){return true
}}return false
}else{if(aa.indexOf(" && ")!==-1){var ae=aa.split(" && ");
for(var ad=0;
ad<ae.length;
ad++){var af=ae[ad].trim();
if(!ac.get(af)){return false
}}return true
}else{return(ac.get(aa))
}}}
}(m));
ao=[g,null];
p=R();
p.NewOrClause(ao);
an.Append([I,p]);
l.push(p);
an=p;
continue
}}else{if(r.charAt(r.length-1)=="?"){m=r;
ah=true
}}if(ah){ao=m?ap(m):null;
p=R();
p.NewOrClause(ao);
an.Append([I,p]);
l.push(p);
an=p;
continue
}if(r=="alternates with"){an.AlternatesWith();
continue
}if(r=="end"){l.pop();
if(l.length>0){an=l[l.length-1]
}else{throw {name:"TemplateSyntaxError",message:"Got too many {end} statements"}
}continue
}}var t=r.split(h);
var j;
var s;
if(t.length==1){if(am===null){throw {name:"MissingFormatter",message:"This template requires explicit formatters."}
}j=[q(am)];
s=r
}else{j=[];
for(var u=1;
u<t.length;
u++){j.push(q(t[u]))
}s=t[0]
}an.Append([U,{name:s,formatters:j}]);
if(d){an.Append("\n")
}}an.Append(i.slice(a));
if(l.length!==1){throw {name:"TemplateSyntaxError",message:"Got too few {end} statements."}
}return an
}var G=/^([a-zA-Z\-]+):\s*(.*)/;
var B=["meta","format-char","default-formatter","undefined-str"];
var M=new RegExp(B.join("|"));
function N(g,f){var i={};
var a=0,l=0;
while(true){var d=false;
l=g.indexOf("\n",a);
if(l==-1){break
}var e=g.slice(a,l);
a=l+1;
var k=e.match(G);
if(k!==null){var c=k[1].toLowerCase(),h=k[2];
if(c.match(M)){c=c.replace("-","_");
h=h.replace(/^\s+/,"").replace(/\s+$/,"");
if(c=="default_formatter"&&h.toLowerCase()=="none"){h=null
}i[c]=h;
d=true
}}if(!d){break
}}var j;
if(i!=={}){j=g.slice(a)
}else{j=g
}for(var b in f){i[b]=f[b]
}return V.JSONTemplate.Template(j,i)
}V.JSONTemplate.Template=Class.create({initialize:function(a,c,b){a=this.removeMultilineComments(a);
this._options=c||{};
this._program=P(a,this._options)
},removeMultilineComments:function(b){var c=b.search("{##");
var a;
while(c>=0){a=b.substr(c);
b=b.substr(0,c)+a.substr(a.search("##}")+3);
c=b.search("{##")
}return b
},render:function(a,b){var c=E(a,this._options.undefined_str);
O(this._program.Statements(),c,b)
},expand:function(a){var b=[];
this.render(a,function(c){b.push(c)
});
return b.join("")
}});
V.JSONTemplate.DEFAULT_PREDICATES=V.Squarespace.TEMPLATE_PREDICATES;
V.JSONTemplate.evaluateJsonTemplate=function(c,b,a){if(!c){return"JSON Template Error: Processing failed because no input was provided. (template: "+JSON.stringify(c)+", dictionary: "+JSON.stringify(b)+", partials: "+JSON.stringify(a)+")"
}return new V.JSONTemplate.Template(c,{partials:a}).expand(b)
}
},"1.0",{requires:["datatype-date-format","squarespace-common","squarespace-util","json","squarespace-template-helpers"]});/* Host: nyc-webster1 Request Version: 12232012020414 Local Version: 12232012020414 Served from: LOCAL */ 
YUI.add("squarespace-comments",function(a){a.namespace("Squarespace");
a.Squarespace.Comments=Class.create({initialize:function(b){this.settings={likesAllowed:b.likesAllowed,flagsAllowed:b.flagsAllowed,threaded:b.threaded,approvalRequired:b.approvalRequired,allowAnon:b.allowAnon,avatarsHidden:!b.avatarsOn,readOnly:b.readOnly};
this.commentData=new a.Squarespace.CommentData({target:b.identifier,targetType:b.type,settings:this.settings,formatter:a.bind(this.formatData,this)});
this.targetId=b.identifier;
this.params=(b||{design:{}});
this.replyCompleteEvents={};
this.threadState=false;
this.lastSortTime=new Date();
this.lastHashChangeTime=new Date();
this.PaginationModes={EXTEND:1,PAGE:2};
this.containerEl=a.one(this.params.containerEl);
this.params.paginationMode=this.PaginationModes.EXTEND;
this.type=a.Squarespace.WidgetTypes.COMMENT;
this.currentPage=1;
this.maxComments=50;
this.sortOrderLookup=[null];
this.sortOrderLookup.push("Oldest First","Newest First","Most Liked","Least Liked");
this.sortOrder=this.params.sortType;
this.commentsEl=a.DB.DIV("comments-content",a.DB.DIV("comment-list"));
this.commentsEl.appendTo(this.containerEl);
this.loadMoreNode=a.DB.DIV("load-more",a.DB.DIV("view-more-btn",{html:"Load More Comments"}));
this.fullViewNode=a.DB.DIV("full-view-btn",{html:"View full comment thread"});
this.history=new a.HistoryHash();
this.commentsEl.delegate("click",this.onReplyToggleClick,".reply",this);
this.commentsEl.delegate("click",this.onLikeClick,".comment:not(.liked):not(.read-only) .like",this);
this.commentsEl.delegate("click",this.onUnlikeClick,".comment.liked:not(.read-only) .like",this);
this.commentsEl.delegate("click",this.onFlagClick,".comment:not(.flagged):not(.read-only) .flag",this);
this.commentsEl.delegate("click",this.onUnflagClick,".comment.flagged:not(.read-only) .flag",this);
this.commentsEl.delegate("click",this.onApproveClick,".comment.unmoderated:not(.read-only) .approve",this);
this.commentsEl.delegate("click",this.onDeleteClick,".comment:not(.read-only) .delete",this);
this.commentsEl.delegate("click",this.replyBtnOnClick,".reply-area-wrapper .comment-btn:not(.read-only)",this);
this.commentsEl.delegate("click",this.togglePreview,".reply-area-wrapper .preview-comment",this);
this.commentsEl.delegate("click",this.showSubscribe,".subscribe",this);
this.commentsEl.delegate("click",this.unsubscribe,".unsubscribe",this);
this.history.on("commentIdChange",this.commentIdHashOnChange,this);
this.history.on("commentIdRemove",this.commentIdHashOnRemove,this);
this.containerEl.delegate("click",(function(){var c,e,d;
return function(g){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,allowAnonymous:this.settings.allowAnon,overlayOpacity:0.5});
var f=function(){this.onLoading();
this.commentData.visibleComments=0;
this.retrieveComments({onSuccess:function(h){this.fullDataRender(h)
},page:1,order:this.sortOrder},this);
c.detach();
d.detach()
};
c=SQUARESPACE_LOGIN.once("cancel",function(){e.detach();
d.detach()
},this);
e=SQUARESPACE_LOGIN.once("login",f,this);
d=SQUARESPACE_LOGIN.once("guestLogin",f,this);
SQUARESPACE_LOGIN.show()
}
})(),".squarespace-comment-login",this);
SQUARESPACE_LOGIN.on("login",function(){this.updateLikedFlaggedState();
this.refreshCommentPostButtons();
this.moderationMode=a.Squarespace.Utils.userHasAccessPermission(a.Squarespace.AccessPermissions.CONFIG_ACTIVITY_COMMENTS)
},this);
SQUARESPACE_LOGIN.on("logout",function(){this.updateLikedFlaggedState();
this.refreshCommentPostButtons();
this.refreshSubscribeControl();
this.moderationMode=false
},this);
this.containerEl.delegate("click",function(c){SQUARESPACE_LOGIN.onLogoutClick()
},".squarespace-comment-logout",this);
this.containerEl.delegate("focus",function(){this.set("text","");
this.setAttribute("data-edited",true)
},".comment-input");
this.containerEl.delegate("blur",function(){if(this.get("value")===""){this.setAttribute("data-edited",false)
}},".comment-input");
this.containerEl.delegate("focus",function(c){c.target.setAttribute("data-edited",true)
},".new-comment-area textArea",this);
this.containerEl.delegate("click",this.extendComments,".view-more-btn",this);
this.containerEl.delegate("click",this.fullViewOnClick,".full-view-btn",this);
this.containerEl.delegate("click",this.commentBtnOnClick,".top-level-comment-area .comment-btn:not(.read-only)",this);
this.containerEl.delegate("click",this.togglePreview,".top-level-comment-area .preview-comment",this);
this.containerEl.delegate("change",function(c){this.sort(c.target.get("value"))
},".hidden-ordering",this);
a.Cookie.remove("displayName",{path:"/"});
this.subscribeDialogParams={name:"subscribe",style:"flyout",flyoutPointerDirection:"top",width:320,position:"center",closeable:true,overlay:0.5,top:200,discardChangesConfirmation:false,title:"Subscribe by Email",primaryTabs:[{title:"Subscribe by Email",icon:"/universal/images-v6/standard/icon_invites_24_light.png",fields:[{type:"text",required:true,name:"email",title:"Email",fieldStyle:"normal",titleStyle:"inline",submitOnEnter:true,style:"major"},{type:"description",text:"Subscribe to this comment thread by email.",padding:[0,0]}]}],buttons:[{type:"cancel",title:"Cancel"},{type:"saveAndClose",title:"Submit"}]}
},doAfterLogin:function(c,b,f){var g,e,d;
e=c.once("login",function(){b.call(this);
d.detach();
g.detach()
},f);
d=c.once("guestLogin",function(){e.detach();
g.detach()
});
g=c.once("cancel",function(){e.detach();
d.detach()
})
},doAfterGuestLogin:function(c,b,f){var g,d,e;
d=c.once("guestLogin",function(){b.call(this);
e.detach();
g.detach()
},f);
e=c.once("login",function(){d.detach();
g.detach()
});
g=c.once("cancel",function(){d.detach();
e.detach()
})
},fullViewOnClick:function(){this.history.addValue("commentId",null)
},updateTopLevelButton:function(){var c=a.one(".top-level-comment-area .comment-btn"),d={newCommentAreaTop:{authenticatedAccount:(SQUARESPACE_LOGIN.account===null?undefined:SQUARESPACE_LOGIN.account)},comments:[{}]},b=this.renderToFragment(d),e=b.one(".top-level-comment-area .comment-btn");
if(c){c.ancestor(".comment-btn-wrapper").append(e);
c.remove(true)
}},updateReplyAreaButtons:function(){var c={comments:[{authenticatedAccount:SQUARESPACE_LOGIN.account}]},b=this.renderToFragment(c).one(".reply-area-wrapper .comment-btn");
if(b){this.commentsEl.all(".reply-area-wrapper .comment-btn").each(function(d){d.insert(b.cloneNode(true),"after");
d.remove(true)
})
}},refreshCommentPostButtons:function(){this.updateTopLevelButton();
this.updateReplyAreaButtons()
},refreshSubscribeControl:function(){if(!SQUARESPACE_LOGIN.account){Static.SQUARESPACE_CONTEXT.subscribed=false
}var c={subscribed:Static.SQUARESPACE_CONTEXT.subscribed,comments:[{}]},d,b=this.renderToFragment(this.scatterData(c)).one(".subscribe-control");
if(b){d=a.one(".subscribe-control");
d.insert(b,"after");
d.remove(true)
}},generatePreview:function(b){var g=a.Squarespace.Escaping.escapeForHtml(b.get("value")),j={comments:[{}]},c=null,k=null,f=j.comments[0],e=b.ancestor(".reply-area-wrapper"),i=!b.ancestor(".reply-area-wrapper"),d,h;
if(!i){h=a.one('.comment[data-commentId="'+b.ancestor(".reply-area-wrapper").getAttribute("data-commentId")+'"]');
d=(h.hasAttribute("data-depth")?parseInt(h.getAttribute("data-depth"),10)+1:1)
}else{d=0
}f.body=a.Squarespace.Lang.markdownToHTML(a.Squarespace.Utils.preFormatMarkdown(g));
f.memberAccount=a.clone(SQUARESPACE_LOGIN.account);
f.authorName=((SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName"))||"Not Logged In");
f.addedOn=(new Date()).getTime();
f.depth=d;
k=this.renderToFragment(this.scatterData(j));
c=k.one(".comment");
c.addClass("comment-preview");
if(i){c.addClass("top-level")
}else{c.setAttribute("data-previewId",h.getAttribute("data-commentId"));
c.setAttribute("data-replyTo",h.getAttribute("data-commentId"))
}return k
},replyBtnOnClick:function(g){var j=g.target.ancestor(".reply-area-wrapper"),b=j.getAttribute("data-commentId"),i=a.one('.comment[data-commentId="'+b+'"]'),h=j.one("textArea"),f=h.get("value"),d,c=function(){var e=this.injectReply(f,i);
this.replyTo(j.getAttribute("data-commentId"),f,e,h)
};
if(f.trim()===""){this.showEmptyText()
}else{if(SQUARESPACE_LOGIN.account){d=new a.Squarespace.ConfirmationDialog({style:"proceedOrCancel",showScreenOverlay:false,confirmText:"Post Comment",width:214,onSuccess:c,scope:this});
d.show("Post Comment","Are you sure you want to post this comment?")
}else{c.call(this)
}}g.stopImmediatePropagation()
},subscribe:function(b){a.Data.post({url:"/api/comment/Subscribe",secure:true,data:{targetId:this.targetId},success:function(){Static.SQUARESPACE_CONTEXT.subscribed=true;
this.refreshSubscribeControl();
(new a.Squarespace.Information()).show("Subscribed","Successfully subscribed")
},failure:function(){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.subscribe(b)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Subscribe","Subscribe",false)
}},this)
},unsubscribe:function(b){a.Data.post({url:"/api/comment/Unsubscribe",secure:true,data:{targetId:this.targetId},success:function(){Static.SQUARESPACE_CONTEXT.subscribed=false;
this.refreshSubscribeControl();
(new a.Squarespace.Information()).show("Unsubscribed","Successfully unsubscribed")
},failure:function(c){if(c.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.unsubscribe(b)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Unsubscribe","Unsubscribe",false)
}}},this)
},showSubscribe:function(c){var b=new a.Squarespace.ConfirmationDialog({style:"proceedOrCancel",showScreenOverlay:false,confirmText:"Subscribe",width:344,onSuccess:this.subscribe,scope:this});
b.show("Subscribe to Thread","Are you sure you wish to subscribe to this comment thread? You will receive updates via the email on file in your profile.")
},togglePreview:function(b){var d=b.target.ancestor(".reply-area-wrapper"),c;
if(d){c=d.one("textArea")
}else{c=b.target.ancestor(".top-level-comment-area").one("textArea")
}if(c.get("value")!==""){if(b.target.getAttribute("data-state")==="open"){b.target.setAttribute("data-state","closed");
this.hidePreview(c)
}else{b.target.setAttribute("data-state","open");
this.showPreview(c)
}}},showPreview:function(c){if(c){var f=this.generatePreview(c),e=f.one(".comment"),d=c.ancestor(".reply-area-wrapper"),j=c.ancestor(".input"),h=!d,g,i,b;
e.wrap('<div class="new comment-preview-wrapper closed"></div>');
b=e.ancestor(".comment-preview-wrapper");
if(!h){d.insert(b,"after");
b.setAttribute("data-commentId",d.getAttribute("data-commentId"))
}else{b.addClass("top-level");
a.one(".comment-list").prepend(b)
}c.ancestor(".new-comment-area").one(".preview-comment").set("innerHTML","Edit");
j.setStyle("height",j.get("offsetHeight"));
g=new a.Anim({node:j,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});
g.on("start",function(){this._node.setStyle("overflow","hidden")
});
g.run();
i=new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:e.get("offsetHeight")+parseInt(e.getComputedStyle("paddingBottom"),10)+parseInt(e.getComputedStyle("marginBottom"),10)}});
i.on("end",function(){this._node.addClass("open")
});
i.run()
}},hideAllPreviews:function(){a.all(".comment-preview-wrapper:not(.top-level)").each(function(c){var b=new a.Anim({node:c,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});
b.on("end",function(){this._node.remove(true)
});
b.run()
},this);
a.all('.preview-comment[data-state="open"]:not(.top-level-preview-btn)').each(function(b){b.setAttribute("data-state","closed");
b.set("innerHTML","Preview")
},this)
},hidePreview:function(f){if(f){var c=f.ancestor(".reply-area-wrapper"),e,d,b,g;
if(c){b=a.one('.comment-preview[data-previewId="'+c.getAttribute("data-commentId")+'"]')
}else{b=a.one(".comment-preview.top-level")
}f.ancestor(".new-comment-area").one(".preview-comment").set("innerHTML","Preview");
e=new a.Anim({node:f.ancestor(".input"),duration:0.3,easing:a.Easing.easeOutStrong,to:{height:f.get("offsetHeight")}});
e.on("end",function(){this._node.setStyle("overflow","visible")
});
e.run();
if(b){g=b.ancestor(".comment-preview-wrapper");
d=new a.Anim({node:g,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});
d.on("start",function(){this._node.removeClass("open");
this._node.addClass("closed")
});
d.on("end",function(){this._node.remove(true)
});
d.run()
}}},getTemplateData:function(c,b){a.Data.get({url:"/api/template/GetTemplateSchema",data:{type:a.Squarespace.WidgetTypes.COMMENTS,componentType:"widget"},success:function(d){this._template=new a.JSONTemplate.Template(d.html);
c.call(this)
},failure:b},this)
},updateLikedFlaggedState:function(){if(this.settings.flagsAllowed||this.settings.likesAllowed){this.commentData.getLikesAndFlags({success:function(c){var b=a.one(".comment-list");
b.all(".comment").each(function(e){var d=e.getAttribute("data-commentId");
if(this.settings.flagsAllowed){if(c.flagMap[d]){e.addClass("flagged")
}else{e.removeClass("flagged")
}}if(this.settings.likesAllowed){if(c.likeMap[d]){e.addClass("liked")
}else{e.removeClass("liked")
}}},this)
}},this)
}},create:function(){if(a.Squarespace.Utils.userHasAccessPermission(a.Squarespace.AccessPermissions.CONFIG_ACTIVITY_COMMENTS)){this.moderationMode=true
}this.getTemplateData(function(){var b=this.history.get("commentId");
if(!a.Lang.isUndefined(b)){this.onLoading();
this.retrieveThread({onSuccess:this.threadRender,onFailure:function(c){this.onLoading();
this.retrieveComments({onSuccess:function(d){this.fullDataRender(d)
},page:1,order:this.sortOrder})
},order:this.sortOrder,commentId:b})
}else{this.onLoading();
this.retrieveComments({onSuccess:function(c){this.fullDataRender(c)
},page:1,order:this.sortOrder})
}},function(){})
},updateCommentCounts:function(){var b=this.renderToFragment({visibleComments:this.commentData.visibleComments,totalComments:this.commentData.totalComments,comments:[]});
if(this.commentData.visibleComments===0){this.containerEl.addClass("empty")
}else{this.containerEl.removeClass("empty")
}a.one(".comment-count").set("innerHTML",b.one(".comment-count").get("innerHTML"))
},buildInfoPane:function(g){var c=(a.DB.DIV("squarespace-user-info",a.DB.DIV("user-info-header",a.DB.DIV("avatar",a.DB.IMG("",{src:(g.avatarId?"http://"+Static.SQUARESPACE_CONTEXT.website.identifier+"."+Static.SQUARESPACE_CONTEXT.appDomain+"/global/"+g.avatarId:"/universal/images-v6/default-avatar.png")+"?format=50w"})),a.DB.DIV("info",a.DB.DIV("name",{html:g.displayName}),a.DB.A("website",{href:(g.websiteUrl?"http://"+a.Squarespace.Escaping.escapeForHtml(g.websiteUrl):""),html:(g.websiteUrl||"")}))),a.DB.DIV("user-info-body",{html:"<p>"+a.Squarespace.Utils.truncateAt(a.Squarespace.Escaping.escapeForHtml(g.bio,60))+"</p>"}),a.DB.DIV("user-social-opts",a.DB.DIV("social-leftcol"),a.DB.DIV("social-rightcol"),a.DB.DIV("clearfix"))));
var b=c.one(".social-leftcol"),e=c.one(".social-rightcol");
var h=(function(){var i=function(k,j){return function(l){return"http://"+k+"."+("com"||j)+"/"+l
}
};
return{foursquare:function(j){if(/[a-zA-Z]/.exec(j)===null){return"http://www.foursquare.com/user/"+j
}else{return"http://www.foursquare.com/"+j
}},facebook:i("facebook"),twitter:i("twitter")}
})();
if(g.socialOptions){for(var d=0;
d<g.socialOptions.length;
d++){var f=a.DB.DIV("social-widget",a.DB.A("",{href:h[g.socialOptions[d].type](g.socialOptions[d].username)},a.DB.IMG("social-icon",{src:(g.socialOptions[d].type==="foursquare"?"/universal/images-v6/member/icon-foursquare-small.png":"/universal/images-v6/social/"+g.socialOptions[d].type+"_16.png")})),a.DB.A("social-name",{html:g.socialOptions[d].type,href:h[g.socialOptions[d].type](g.socialOptions[d].username)}));
if((d%2)===0){b.append(f)
}else{e.append(f)
}}}return c
},showClickOverlay:function(){var d=a.one(document),c=d.get("winHeight"),b=d.get("winWidth");
this.overlayEl=a.DB.DIV("user-profile-overlay");
this.overlayEl.setStyles({position:"fixed",background:"#000",height:c+"px",width:b+"px",opacity:"0",top:"0px",left:"0px",zIndex:999});
a.one("body").append(this.overlayEl);
a.on("click",this.hideUserProfileFlyout,this.overlayEl,this)
},showUserProfileFlyout:function(g){if(!g.target.hasClass("squarespace-comment-user-flyout")&&!g.target.ancestor(".squaresapce-comment-user-flyout")&&!this.flyoutOpen){var f=g.target.ancestor(".comment").getAttribute("data-commentid"),h=this.commentData.getCommentById(f);
var c=h.memberAccount;
if(!c){return
}var d=a.DB.DIV("squarespace-comment-user-flyout",this.buildInfoPane(c),a.DB.DIV("squarespace-user-activity",a.DB.DIV("squarespace-activity-header",a.DB.DIV("title",{html:"Activity"}),a.DB.DIV("description",{html:"Comments and likes across the Squarespace platform"})),a.DB.DIV("feed")),a.DB.DIV("squarespace-comment-user-clearfix"));
var b=a.one(document.body);
b.append(d);
d.setStyles({position:"fixed",left:"50%",top:"50%",opacity:0,zIndex:1000,transform:"scale(.95)"});
d.setStyles({marginTop:-(parseInt(d.get("offsetHeight"),10)/2),marginLeft:-(parseInt(d.get("offsetWidth"),10)/2)});
d.transition({WebkitTransform:{duration:0.3,easing:"ease-out",value:"scale(1)"},opacity:{duration:0.3,easing:"ease-out",value:1}});
a.Data.get({url:"/api/comment/GetRecentActivity",data:{user:c.id},success:function(l){for(var j=0;
j<l.authored.length;
j++){l.authored[j].type="authored"
}for(j=0;
j<l.liked.length;
j++){l.liked[j].type="liked"
}var e=l.authored.concat(l.liked);
for(j=0;
j<e.length;
j++){this.escapeComment(e[j])
}e.sort(function(m,i){return m.actionTime<i.actionTime
});
var k=d.one(".feed");
for(j=0;
j<3;
j++){k.append(a.DB.DIV("feed-item",a.DB.DIV("type-icon",a.DB.IMG("",{src:(e[j].type==="authored"?"/universal/images-v6/comments/icon-mail-16x16-wht.png":"/universal/images-v6/comments/icon-like-16x16-wht.png")})),a.DB.DIV("content",a.DB.DIV("header",{html:(e[j].type==="authored"?"Commented on ":"Liked a comment by "+e[j].comment.authorName+" on ")+'"'+e[j].targetName+'" '},a.DB.SPAN("time",{html:a.Squarespace.Utils.humanizeDate(parseInt(e[j].actionTime,10))})),a.DB.DIV("body",{html:a.Squarespace.Utils.truncateAtCharacters(e[j].comment.body,82)}))))
}},failure:function(e){d.one(".feed").append(a.DB.DIV("no-feed",{html:"This user's activity feed is unavailable."}))
}},this)
}this.flyoutOpen=true;
this.showClickOverlay();
g.stopImmediatePropagation()
},hideUserProfileFlyout:function(c){if(this.flyoutOpen){var b=a.one(".squarespace-comment-user-flyout");
if(b){b.transition({WebkitTransform:{duration:0.3,easing:"ease-out",value:"scale(1.08)"},opacity:{duration:0.4,easing:"ease-out",value:0},on:{end:a.bind(function(){b.remove(true);
c.target.remove(true);
this.flyoutOpen=false
},this)}})
}}},getThreadNodes:function(b,c){var d=b.getAttribute("data-commentId");
c.push(b);
a.all('.comment[data-replyTo="'+d+'"]').each(function(e){this.getThreadNodes(e,c)
},this)
},actualDelete:function(i,l,j){var h=i.target.ancestor(".comment"),b=h.getAttribute("data-commentId"),g,c,m=this.lastSortTime,f=this.lastHashChangeTime,k=function(e){if(m===this.lastSortTime&&f===this.lastHashChangeTime){g=a.DB.DIV("delete-anim-wrapper");
h.insert(g,"after");
j.forEach(function(p){g.append(p);
var o=a.one('.reply-area-wrapper[data-commentId="'+p.getAttribute("data-commentId")+'"]');
if(o){o.remove(true)
}});
c=new a.Anim({node:g,duration:0.5,easing:a.Easing.easeOutStrong,to:{height:0}});
c.on("end",function(){g.remove(true);
if(j.length>1){this.commentData.removeCommentsByIds(j.map(function(n){return n.getAttribute("data-commentId")
}).filter(function(n){return n!==b
}))
}this.updateCommentCounts()
},this);
c.run()
}},d=function(e){if(e.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.actaulDelete(i,l,j)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Delete Comments","Delete Comments",false)
}else{if(e.authorizationFail){(new a.Squarespace.Alert("Authorization Failure","You are not allowed to perform that action.")).show()
}}};
this.commentData._delete({comments:[b],spam:l,success:k,failure:d},this)
},onDeleteClick:function(d){var k,c=d.target.ancestor(".comment"),f=function(){var e=[];
this.getThreadNodes(c,e);
return e
},h=f.call(this),b=function(){h.forEach(function(l){if(!l.hasClass("unmoderated")){var e=new a.Anim({node:l,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:1}});
e.on("end",function(){this._node.removeClass("pending-delete")
});
e.run()
}else{l.removeClass("pending-delete")
}})
},g=function(){b();
this.actualDelete(d,true,h)
},j=function(){b();
this.actualDelete(d,false,h)
},i=function(){b()
};
h.forEach(function(l){if(!l.hasClass("unmoderated")){var e=new a.Anim({node:l,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:0.5}});
e.on("end",function(){this._node.addClass("pending-delete")
});
e.run()
}else{l.addClass("pending-delete")
}});
k=new a.Squarespace.ConfirmationDialog({style:"confirmOrReject",rejectText:"Delete",showScreenOverlay:false,confirmText:"Delete & Report Spam",width:344,onCancel:i,onReject:j,onSuccess:g,scope:this});
k.show((h.length===1?"Delete Comment":"Delete "+h.length+" Comments"),(h.length>1?"Are you sure you wish to delete these comments?":"Are you sure you wish to delete this comment?"))
},onApproveClick:function(b){var c=b.target.ancestor(".comment");
this.approve(c.getAttribute("data-commentId"),c);
b.stopImmediatePropagation()
},approve:function(e,c){var d=function(f){this.updateCommentCounts()
},b=function(f){if(f.loginRequired){c.addClass("unmoderated");
SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.approve(e,c)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Approve Comments","Approve Comments",false)
}};
c.removeClass("unmoderated");
this.commentData.approve({comments:[e],success:d,failure:b},this)
},onUnlikeClick:function(b){var c=b.target.ancestor(".comment");
this.unlike(c.getAttribute("data-commentId"),c);
b.stopImmediatePropagation()
},unlike:function(f,d){var c=d.one(".likes"),e=function(){if(c){var h={comments:[{likesAllowed:{likeCount:this.commentData.getCommentById(f).likeCount}}]},g=this.renderToFragment(this.scatterData(h)).one(".likes");
c.replace(g)
}},b=function(g){d.addClass("liked");
if(g.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.unlike(f,d)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Dislike Comment","Dislike Comment",false)
}};
d.removeClass("liked");
this.commentData.unlike({id:f,success:e,failure:b},this)
},onFlagClick:function(c){var b=function(){var d=c.target.ancestor(".comment");
this.flag(d.getAttribute("data-commentId"),d)
};
(new a.Squarespace.ConfirmationDialog()).show("Flag Comment","Are you sure you wish to flag this comment as inappropriate?",b,this);
c.stopImmediatePropagation()
},flag:function(e,c){var d=function(){},b=function(g){c.removeClass("flagged");
if(g.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
var f;
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.flag(e,c);
f.detach()
},this);
f=SQUARESPACE_LOGIN.once("cancel",function(){c.removeClass("flagged")
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Flag Comment","Flag Comment",false)
}};
c.addClass("flagged");
this.commentData.flag({id:e,success:d,failure:b},this)
},onUnflagClick:function(b){var c=b.target.ancestor(".comment");
this.unflag(c.getAttribute("data-commentId"),c);
b.stopImmediatePropagation()
},unflag:function(e,c){var d=function(){},b=function(f){c.addClass("flagged");
if(f.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,opacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.unflag(e,c)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Unflag Comment","Unflag Comment",false)
}};
c.removeClass("flagged");
this.commentData.unflag({id:e,success:d,failure:b},this)
},onLikeClick:function(b){var c=b.target.ancestor(".comment");
this.like(c.getAttribute("data-commentId"),c);
b.stopImmediatePropagation()
},like:function(h,e){var c=e.one(".likes"),d=e.getAttribute("data-commentid"),g,f=function(){if(c&&!a.Lang.isNull(e._node)){var j={comments:[{likesAllowed:{likeCount:this.commentData.getCommentById(d).likeCount}}]},i=this.renderToFragment(this.scatterData(j)).one(".likes");
c.replace(i)
}},b=function(i){e.removeClass("liked");
if(i.loginRequired){SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,function(){this.like(h,e)
},this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Like Comment","Like Comment",false)
}};
e.addClass("liked");
this.commentData.like({id:h,success:f,failure:b},this)
},addLoadMoreControls:function(c){var b=a.one(".load-more");
if(b){b.remove(true)
}if(!this.threadState&&this.commentData.page<this.commentData.numPages){this.containerEl.append(this.loadMoreNode.cloneNode(true))
}},addFullViewControls:function(c){var b=a.one(".full-view-btn");
if(b){b.remove(true)
}if(this.threadState){this.containerEl.one(".comment-list").insert(this.fullViewNode.cloneNode(true),"before")
}},onReplyToggleClick:function(l){var j=l.target.ancestor(".comment"),d=j.getAttribute("data-commentid"),b=a.one('.reply-area-wrapper[data-commentid="'+d+'"]'),k=a.one("body"),g,f,m=a.bind(function(n,e){if(n){n.setStyles({overflow:"hidden",height:n.get("offsetHeight")});
n.one(".input").setStyle("height","auto");
a.one('.comment[data-commentid="'+n.getAttribute("data-commentId")+'"]').fire("reply-close");
g=new a.Anim({node:n,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});
g.on("end",function(){},this);
g.run()
}},this),i=a.bind(function(o){if(o){var n,e;
e=o.one(".new-comment-area").cloneNode(true);
e.setStyles({visibility:"hidden",display:"block",position:"absolute"});
j.append(e);
n=e.get("offsetHeight");
e.remove(true);
a.one('.comment[data-commentid="'+o.getAttribute("data-commentId")+'"]').fire("reply-open");
this.hideAllPreviews();
f=new a.Anim({node:o,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:Math.max(n,190)+15}});
f.on("end",function(){this._node.setStyle("height","auto");
var q=(this._node.getY()+this._node.get("offsetHeight"))-(k.get("docScrollY")+k.get("winHeight")),r=k.get("scrollTop"),p;
if(q>=0){p=new a.Anim({node:k,duration:0.3,easing:a.Easing.easeOutStrong,to:{scrollTop:r+q}});
p.run()
}});
f.run()
}},this),h=function(e){return e.hasClass("reply-open")
};
if(h(j)){j.removeClass("reply-open");
this.hideAllPreviews();
m(b)
}else{b.one(".reply-area").setAttribute("replyid",d);
a.all(".comment.reply-open").each(function(o){o.removeClass("reply-open");
var e=a.one('.reply-area-wrapper[data-commentid="'+o.getAttribute("data-commentid")+'"]');
m(e)
});
var c=b.one("textArea");
if(!this.replyCompleteEvents[j.getAttribute("data-commentId")]){this.replyCompleteEvents[j.getAttribute("data-commentId")]=this.once("reply-complete",function(e){m(b,function(){this.one(".input").setStyle("height","auto")
});
this.replyCompleteEvents[j.getAttribute("data-commentId")]=null
},this)
}c.on("focus",function(){this.setAttribute("data-edited",true)
});
c.on("blur",function(){if(this.get("value")===""){this.setAttribute("data-edited",false)
}});
j.addClass("reply-open");
i(b)
}l.stopImmediatePropagation()
},escapeComment:function(b){b.authorName=a.Squarespace.Escaping.escapeForHtml(b.authorName);
if(b.memberAccount){b.memberAccount.displayName=a.Squarespace.Escaping.escapeForHtml(b.memberAccount.displayName);
b.memberAccount.bio=a.Squarespace.Escaping.escapeForHtml(b.memberAccount.bio)
}},addReplyArea:function(c){var e=a.one(".reply-area-wrapper"),g,d,b,f;
if(e){e.one(".preview-comment").setAttribute("data-state","closed").set("innerHTML","Preview");
g=e.cloneNode(true);
g.setAttribute("data-commentId",c.getAttribute("data-commentId"));
g.setAttribute("data-depth",c.getAttribute("data-depth"));
f=g
}else{d={comments:[{id:c.getAttribute("data-commentId"),depth:c.getAttribute("data-depth")}]};
b=this.renderToFragment(d);
f=b.one(".reply-area-wrapper").cloneNode(true)
}f.setStyle("height",null);
c.insert(f,"after")
},prependComment:function(h){var b=((SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName"))||"Not Logged In"),c=a.one(".top-level-comment-area .comment-input"),d=a.one(".top-level.comment-preview"),e=false,g,f;
if(!d){d=this.generatePreview(c).one(".comment-preview");
e=true;
d.wrap('<div class="comment-preview-wrapper"></div>');
f=d.ancestor(".comment-preview-wrapper");
a.one(".comment-list").prepend(f)
}else{d.one(".author").set("innerHTML",b);
f=d.ancestor(".comment-preview-wrapper")
}d.removeClass("comment-preview");
d.addClass("pending");
a.one(".top-level-comment-area .preview-comment").setAttribute("data-state","closed");
this.hidePreview(c);
if(e){g=new a.Anim({node:f,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:d.get("offsetHeight")+parseInt(d.getComputedStyle("marginBottom"),10)}});
g.on("end",function(){d.unwrap()
});
g.run()
}else{d.unwrap()
}this.containerEl.removeClass("empty");
this.makeMostRecent(d);
return d
},injectReply:function(h,j){var b=j.getAttribute("data-commentId"),i=a.one('.comment-preview-wrapper[data-commentId="'+b+'"]'),e=a.one('.reply-area-wrapper[data-commentId="'+b+'"]').one("textArea"),g=((SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName"))||"Not Logged In"),f=false,d;
if(!i){d=this.generatePreview(e).one(".comment-preview");
f=true;
d.wrap('<div class="comment-preview-wrapper"></div>');
i=d.ancestor(".comment-preivew-wrapper")
}else{d=i.one(".comment-preview");
d.one(".author").set("innerHTML",g)
}if(j.hasAttribute("data-depth")){d.setAttribute("data-depth",parseInt(j.getAttribute("data-depth"),10)+1)
}d.unwrap();
d.removeClass("comment-preview");
d.addClass("pending");
j.removeClass("reply-open");
j.fire("reply-complete");
if(f){var c=e.ancestor(".reply-area-wrapper").cloneNode(true);
e.ancestor(".reply-area-wrapper").insert(d,"after")
}this.makeMostRecent(d);
this.fire("reply-complete",{node:d});
return d
},makeMostRecent:function(b){if(b.hasClass("comment")){a.all(".comment.pending.most-recent").each(function(c){if(!c.ancestor(".most-recent-anim-wrapper")){c.removeClass("most-recent")
}});
b.addClass("most-recent")
}},fullDataRender:function(){this.render(this.commentData.formatted);
this.commentList=a.one(".comment-list")
},threadRender:function(){this.render(this.commentData.formattedThread);
this.commentList=a.one(".comment-list");
this.commentList.one('.comment[data-commentId="'+this.commentData.currentThreadRoot+'"]').addClass("target")
},showEmptyText:function(){new a.Squarespace.Alert().show("Enter Comment Text","Enter text in the field above to post a comment.")
},showModerationNotification:function(){new a.Squarespace.Notice().show("Comment Awaiting Moderation","Your comment has been successfully posted and is awaiting moderation.")
},showCommentSuccessNotification:function(){new a.Squarespace.Notice().show("Comment Posted","Your comment has been successfully posted.")
},showPostCommentNotification:function(){if(!this.settings.approvalRequired||a.Squarespace.Utils.userHasAccessPermission(a.Squarespace.AccessPermissions.CONFIG_TRUSTED_COMMENTER)){this.showCommentSuccessNotification()
}else{this.showModerationNotification()
}},squarespaceAdminOnly:function(){return(Static.SQUARESPACE_CONTEXT.website.cloneable&&!a.Squarespace.Utils.isSquarespaceAdmin())
},commentBtnOnClick:function(g){var b=a.one(".top-level-comment-area .comment-input"),f=b.get("value"),d,c=function(){var e=this.prependComment(f);
this.submitTopLevel(f,e,b)
};
if(f.trim()===""){this.showEmptyText()
}else{if(SQUARESPACE_LOGIN.account){d=new a.Squarespace.ConfirmationDialog({style:"proceedOrCancel",showScreenOverlay:false,confirmText:"Post Comment",width:214,onSuccess:c,scope:this});
d.show("Post Comment","Are you sure you want to post this comment?")
}else{c.call(this)
}}g.stopImmediatePropagation()
},updateWithMemberAccount:function(c,e){if(e&&!SQUARESPACE_LOGIN.account){var d=c.one(".author");
if(d){d.setContent(e.displayName)
}var b=c.one(".avatar img");
if(b){if(e.avatarUrl){b.setAttribute("src",e.avatarUrl)
}else{if(e.avatarId){b.setAttribute("src","/global/"+e.avatarId+"?format=36w")
}}}}},submitTopLevel:function(d,e,c){this.setPosting(e,(!this.approvalRequired||!this.moderationMode));
var b=c.get("value");
c.set("value","");
this.addComment({onSuccess:function(f){this.updateCommentCounts();
if(!a.Lang.isNull(e._node)){this.setPosted(e);
e.setAttribute("data-commentId",f.comment.id);
if(f.comment.status===a.Squarespace.CommentStatuses.APPROVED){e.removeClass("pending")
}this.addReplyArea(e);
this.updateWithMemberAccount(e,f.comment.memberAccount)
}},onFailure:function(k){c.set("value",b);
if(k.errors){if(k.errors.anonEmail||k.errors.authorEmail||k.errors.authorName){var i=e.one(".author");
if(k.errors.anonEmail){new a.Squarespace.Notice().show("Comment Failed",k.errors.anonEmail)
}var h=function(){this.submitTopLevel(d,e,c);
if(!a.Lang.isNull(i)||a.Lang.isNull(i._node)){i.set("innerHTML",SQUARESPACE_LOGIN.account.displayName)
}if(SQUARESPACE_LOGIN.account.avatarId){var l=e.one(".avatar");
l.one("img").setAttribute("src","/global/"+SQUARESPACE_LOGIN.account.avatarId+"?format=36w")
}f.detach()
};
var g=function(){this.submitTopLevel(d,e,c);
var l=a.Cookie.get("displayName");
if(!(a.Lang.isNull(i)||a.Lang.isNull(i._node)||a.Lang.isNull(l))){i.set("innerHTML",l)
}f.detach()
};
var j=function(){this.removeMostRecentPending()
};
SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,h,this);
this.doAfterGuestLogin(SQUARESPACE_LOGIN,g,this);
var f=SQUARESPACE_LOGIN.once("cancel",j,this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Post Comment","Post Comment",this.settings.allowAnon)
}else{this.showPostCommentNotification()
}}},body:d},this)
},removeMostRecentPending:function(){var d=a.one(".comment.most-recent"),c,b;
if(d.ancestor(".comment-preview-wrapper")){d.unwrap()
}d.wrap('<div class="most-recent-anim-wrapper"></div>');
b=d.ancestor(".most-recent-anim-wrapper");
b.setStyles({overflow:"hidden",height:d.get("offsetHeight")});
c=new a.Anim({node:b,duration:0.3,easing:a.Easing.easeOutStrong,to:{height:0}});
c.on("end",function(){this._node.remove(true)
});
c.run()
},onLoading:function(){var d=a.one(".comments-content"),b=a.DB.DIV("comment-event-capture"),c;
b.setStyles({position:"absolute",top:d.getY(),left:d.getX(),width:d.get("offsetWidth"),height:d.get("offsetHeight"),zIndex:1000});
b.on("hover",function(f){f.stopImmediatePropagation()
});
b.on("click",function(f){f.stopImmediatePropagation()
});
a.one("body").append(b);
c=new a.Anim({node:d,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:0.3}});
c.run()
},commentIdHashOnChange:function(b){if(!(a.Lang.isNull(b.newVal)||a.Lang.isUndefined(b.newVal))){this.threadState=true;
this.lastHashChangeTime=new Date();
this.onLoading();
this.retrieveThread({commentId:b.newVal,order:this.sortOrder,onSuccess:function(){this.threadRender()
}})
}},commentIdHashOnRemove:function(){this.threadState=false;
this.lastHashChangeTime=new Date();
this.onLoading();
this.retrieveComments({onSuccess:function(b){this.fullDataRender(b)
},page:1,order:this.sortOrder},this)
},retrieveThread:function(b,c){this.threadState=true;
var d=function(e){this.threadState=false;
b.onFailure.call((c||this),e)
};
this.commentData.getThread({order:b.order,commentId:b.commentId,success:b.onSuccess,failure:d},(c||this))
},retrieveComments:function(d,e){var c=this.params.identifier,f=this.params.type;
var g={targetId:c,targetType:f,since:(d.since||""),page:d.page,sortBy:d.order};
var b=a.bind(function(h){this.lastPollTime=new Date();
d.onSuccess.call((e||this),h);
this.updateLikedFlaggedState()
},this);
this.commentData.get({order:d.order,page:d.page,since:(d.since||""),success:b,failure:d.onFailure},this)
},addComment:function(c,d){var b=a.bind(function(e){if(a.Lang.isFunction(c.onSuccess)){(c||noop).onSuccess.call((d||this),e)
}a.Cookie.remove("displayName",{path:"/"})
},this);
this.commentData.post({body:c.body,replyTo:c.replyTo,name:(SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.displayName:a.Cookie.get("displayName")),email:(SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.email:a.Cookie.get("email")),authorUrl:(SQUARESPACE_LOGIN.account?SQUARESPACE_LOGIN.account.websiteUrl:a.Cookie.get("websiteUrl")),success:b,failure:c.onFailure},(d||this))
},setPosting:function(d,c){d.all(".posting-text").each(function(e){e.removeClass("visible")
});
var b=d.one(".posting-text"+(c?".moderated":""));
if(b){b.addClass("visible")
}},setPosted:function(c){var b=c.all(".posting-text");
if(b){b.each(function(d){d.removeClass("visible")
})
}},replyTo:function(f,d,e,b){this.setPosting(e,(!this.approvalRequired||!this.moderationMode));
var c=b.get("value");
b.set("value","");
this.addComment({body:d,replyTo:f,onSuccess:function(g){this.updateCommentCounts();
if(!a.Lang.isNull(b._node)){this.setPosted(e);
e.setAttribute("data-commentId",g.comment.id);
if(g.comment.status===a.Squarespace.CommentStatuses.APPROVED){e.removeClass("pending")
}this.addReplyArea(e);
this.updateWithMemberAccount(e,g.comment.memberAccount)
}},onFailure:function(k){b.set("value",c);
if(k.errors){if(k.errors.anonEmail||k.errors.authorEmail||k.errors.authorName){var j,i,h;
if(k.errors.anonEmail){new a.Squarespace.Notice().show("Comment Failed",k.errors.anonEmail)
}j=function(){this.removeMostRecentPending()
};
i=function(){this.replyTo(f,d,e,b);
a.one('.comment[data-replyTo="'+f+'"] .author').set("innerHTML",SQUARESPACE_LOGIN.account.displayName);
e.one(".author").set("innerHTML",SQUARESPACE_LOGIN.account.displayName);
if(SQUARESPACE_LOGIN.account.avatarId){var l=e.one(".avatar");
l.one("img").setAttribute("src","/global/"+SQUARESPACE_LOGIN.account.avatarId+"?format=36w")
}g.detach()
};
h=function(){this.replyTo(f,d,e,b);
var l=a.Cookie.get("displayName");
if(!a.Lang.isNull(l)){a.one('.comment[data-replyTo="'+f+'"] .author').set("innerHTML",l)
}g.detach()
};
SQUARESPACE_LOGIN.configure({redirectAfterLogin:false,reloadAfterLogin:false,overlayOpacity:0.5});
this.doAfterLogin(SQUARESPACE_LOGIN,i,this);
this.doAfterGuestLogin(SQUARESPACE_LOGIN,h,this);
var g=SQUARESPACE_LOGIN.once("cancel",j,this);
SQUARESPACE_LOGIN.showCommentLogin("Log In to Post Reply","Post Reply",this.settings.allowAnon)
}}}},this)
},extendComments:function(){this.currentPage=this.currentPage+1;
var b=this.lastSortTime,c=this.lastHashChangeTime;
this.retrieveComments({order:this.sortOrder,onSuccess:function(){if(b===this.lastSortTime&&c===this.lastHashChangeTime){this.attachComments.call(this)
}},page:this.currentPage},this)
},attachComments:function(){var d=this.commentData.formatted;
d.comments=this.commentData.getFormattedPage(this.currentPage);
var b=this.renderToFragment(d);
this.updateCommentCounts();
var c=a.one(".comment-list");
b.all(".comment, .reply-area-wrapper").each(function(e){c.append(e)
});
this.containerEl.one(".load-more").remove(true);
this.addLoadMoreControls()
},sort:function(d){var c=this.sortOrderLookup[d];
a.Cookie.set("commentSortOrder",d);
this.sortOrder=d;
this.currentPage=1;
var b=function(e){this.lastSortTime=new Date();
this.fullDataRender(e);
var f=a.one(".comment-sort");
f.one("span").set("innerHTML",c);
f.one("select").set("value",this.sortOrder)
};
this.onLoading();
this.retrieveComments({order:this.sortOrder,onSuccess:b,page:this.currentPage})
},formatData:function(h,e,d){var c,k={comments:[]},g,b;
e=(e||{});
d=(d||{});
var j=(this.squarespaceAdminOnly()||this.settings.readOnly);
k.noAvatars=this.settings.avatarsHidden;
k.likesAllowed=this.settings.likesAllowed;
k.newCommentAreaTop={authenticatedAccount:SQUARESPACE_LOGIN.account,readOnly:j};
k.commentSortTitle=this.sortOrderLookup[this.sortOrder];
k.sortOldestFirst=this.sortOrder===a.Squarespace.CommentSortTypes.OLDEST_FIRST;
k.sortNewestFirst=this.sortOrder===a.Squarespace.CommentSortTypes.NEWEST_FIRST;
k.sortMostLiked=this.sortOrder===a.Squarespace.CommentSortTypes.MOST_LIKED;
k.sortLeastLiked=this.sortOrder===a.Squarespace.CommentSortTypes.LEAST_LIKED;
k.totalComments=this.commentData.totalComments;
k.visibleComments=this.commentData.visibleComments;
k.subscribed=Static.SQUARESPACE_CONTEXT.subscribed;
for(var f=0;
f<h.length;
f++){g=h[f];
g.unmoderated=(g.status===a.Squarespace.CommentStatuses.AWAITING_MODERATION);
g.moderationMode=this.moderationMode;
g.readOnly=j;
g.flagsAllowed=this.settings.flagsAllowed;
if(g.memberAccount){g.authorName=g.memberAccount.displayName;
g.authorUrl=g.memberAccount.websiteUrl
}if(g.authorUrl){if(!(g.authorUrl.startsWith("http://")||g.authorUrl.startsWith("https://"))){g.authorUrl="http://"+g.authorUrl
}}c=g.id;
if(this.settings.likesAllowed){g.likesAllowed={likeCount:g.likeCount};
if(e[c]){g.likesAllowed.liked=true
}}if(d[c]){g.flagged=true
}g.threaded=this.settings.threaded;
k.comments.push(g)
}return k
},scatterData:function(c){var d=(this.squarespaceAdminOnly()||this.settings.readOnly);
c.noAvatars=this.settings.avatarsHidden;
c.likesAllowed=this.settings.likesAllowed;
c.newCommentAreaTop={};
c.newCommentAreaTop.readOnly=d;
c.newCommentAreaTop.authenticatedAccount=SQUARESPACE_LOGIN.account;
c.commentSortTitle=this.sortOrderLookup[this.sortOrder];
c.subscribed=Static.SQUARESPACE_CONTEXT.subscribed;
if(this.commentData.totalComments===0){c.noComments=true
}var e={};
for(var b=0;
b<c.comments.length;
b++){e=c.comments[b];
e.flagsAllowed=this.settings.flagsAllowed;
e.moderationMode=this.moderationMode;
if(e.memberAccount){e.authorName=e.memberAccount.displayName;
e.authorUrl=e.memberAccount.websiteUrl
}if(e.authorUrl){if(!(e.authorUrl.startsWith("http://")||e.authorUrl.startsWith("https://"))){e.authorUrl="http://"+e.authorUrl
}}e.readOnly=d;
if(this.settings.likesAllowed){if(!e.likesAllowed){e.likesAllowed={likeCount:0}
}e.likesAllowed.likeCount=(e.likesAllowed.likeCount===0?undefined:e.likesAllowed.likeCount)
}e.threaded=this.settings.threaded;
if(c.likeMap&&c.likeMap[e.id]&&(e.likesAllowed!==undefined)){e.likesAllowed.liked=true
}if(c.flagMap&&c.flagMap[e.id]){e.flagged=true
}c.comments[b]=e
}return c
},render:function(d){var c=this.renderToFragment(d),f=this.commentsEl,e,b=a.one(".comment-event-capture");
if(!d.comments.length){this.containerEl.addClass("empty")
}else{this.containerEl.removeClass("empty")
}f.empty();
f.append(c);
e=new a.Anim({node:f,duration:0.3,easing:a.Easing.easeOutStrong,to:{opacity:1}});
e.on("end",function(){b.remove(true)
});
e.run();
this.addFullViewControls();
switch(this.params.paginationMode){case this.PaginationModes.PAGE:break;
case this.PaginationModes.EXTEND:this.addLoadMoreControls();
break;
default:break
}this.fire("render")
},renderToFragment:function(e){for(var d=0;
d<e.comments.length;
d++){this.escapeComment(e.comments[d]);
var b=e.comments[d].body;
b=a.Squarespace.Utils.preFormatMarkdown(b);
e.comments[d].body=b
}var c=a.Node.create(this._template.expand(e)),f=c.all(".comment");
f.each(function(h,g){h.setAttribute("data-commentId",e.comments[g].id)
});
return c
}});
a.augment(a.Squarespace.Comments,a.EventTarget);
a.on("domready",function(){var g=a.one(".squarespace-comments"),h,c,d=Static.SQUARESPACE_CONTEXT.websiteSettings;
if(g&&!d.disqusShortname){h=(Static.SQUARESPACE_CONTEXT.itemId||Static.SQUARESPACE_CONTEXT.collectionId);
if(h){c=(Static.SQUARESPACE_CONTEXT.itemId?a.Squarespace.CommentTargetTypes.ITEM:a.Squarespace.CommentTargetTypes.COLLECTION);
var e=false,j=false;
if(c===a.Squarespace.CommentTargetTypes.ITEM){var k=Static.SQUARESPACE_CONTEXT.item;
if(k){if(k.commentState===a.Squarespace.CommentStates.DISABLED){if(k.publicCommentCount===0){e=true
}else{j=true
}}}}else{var f=Static.SQUARESPACE_CONTEXT.collectionsById[h];
if(f){if(!f.configuration.commentsOn){if(f.publicCommentCount===0){e=true
}else{j=true
}}}}if(!e){var i=function(){a.use("squarespace-comments","cookie",function(l){if(Static.SQUARESPACE_CONTEXT.authenticatedAccount&&!Static.SQUARESPACE_CONTEXT.website.cloneable){l.use("squarespace-management",function(m){m.Squarespace.Management.showChrome()
})
}(new l.Squarespace.Comments({containerEl:g,identifier:h,type:c,likesAllowed:d.commentLikesAllowed,flagsAllowed:d.commentFlagsAllowed,threaded:d.commentThreaded,approvalRequired:d.commentApprovalRequired,allowAnon:d.commentAnonAllowed,avatarsOn:d.commentAvatarsOn,readOnly:j,sortType:(l.Cookie.get("commentSortOrder")||d.commentSortType)})).create()
})
};
var b=function(){a.use("squarespace-comments","cookie",function(m){var l=function(){m.Data.get({url:"/api/auth/CheckAuthentication",secure:true,success:function(n){if(n.member!==null){m.use("squarespace-management",function(o){Static.SQUARESPACE_CONTEXT.authenticatedAccount=n.member;
SQUARESPACE_LOGIN.params=o.merge(SQUARESPACE_LOGIN.params,{redirectAfterCancel:false,redirectAfterLogin:false});
SQUARESPACE_LOGIN.onLoginComplete(n.member)
})
}i()
},failure:i})
};
if(m.Data.TRANSPORT_READY){l()
}else{console.warn("Flash cross-domain transport not initialized yet. Delaying comment initialization until flash is ready.");
m.once("io:xdrReady",l)
}})
};
if(Static.SQUARESPACE_CONTEXT.authenticatedAccount||Static.SQUARESPACE_CONTEXT.website.cloneable){i()
}else{b()
}}}}})
},"1.0",{requires:["history","squarespace-comment-data","squarespace-util","squarespace-markdown","squarespace-login","squarespace-ui-base","node","event","selector-css3","squarespace-json-template","anim","transition"]});